<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-05-23 Sa 12:00 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>tf1</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="sx" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">tf1</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org254f344">Tensorflow</a>
<ul>
<li><a href="#org2b1d657">Constand additional und multiply</a>
<ul>
<li><a href="#org6fccd19">addition</a></li>
<li><a href="#org2c3480a">multiply</a></li>
</ul>
</li>
<li><a href="#org9aec7b1">Variable</a>
<ul>
<li><a href="#org02e9117">the first using of variable &amp; subtract add</a></li>
<li><a href="#orgb299d30">assign a value for variable and update &amp; assign</a></li>
<li><a href="#org3652c47">fetch and Feed &amp;placeholder</a></li>
</ul>
</li>
<li><a href="#orgff7a89b">Tuning</a>
<ul>
<li><a href="#org5b99ae5">change learing rate</a></li>
<li><a href="#org21033a1">learing rate for loss</a></li>
</ul>
</li>
<li><a href="#orgf20f9ce">train examples</a>
<ul>
<li><a href="#org0b9e66d">the first train case</a></li>
<li><a href="#orgf16303f">non linear regression case</a></li>
<li><a href="#orgbcb708a">the first train with data for accuary</a></li>
<li><a href="#org4b61725">a simple CNN case</a></li>
<li><a href="#orge0972bc">CNN train</a></li>
<li><a href="#org0ae002d">classification</a></li>
<li><a href="#orgee472ed">optimizer varialbe (with error)</a></li>
<li><a href="#orgd5428f5">dropout</a></li>
<li><a href="#org12aed59">number identification</a></li>
<li><a href="#orgd4abd3c">with Lã€€regularizer</a></li>
<li><a href="#org5c5674c">without L regularizer</a></li>
<li><a href="#orgbdb3068">exponen decay with L regularizer(this has error)</a></li>
<li><a href="#org82981ca">read date for variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1061e3d">keras</a>
<ul>
<li>
<ul>
<li><a href="#org6231cca">classification</a></li>
<li><a href="#org249ba7b">regression</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8496276">sklearn</a>
<ul>
<li>
<ul>
<li><a href="#orgf0a0fc8">decisiontree</a></li>
<li><a href="#org0e51e60">cross validation 1</a></li>
<li><a href="#org9b03926">cross validation 2</a></li>
<li><a href="#org5fe5278">corss validation 3</a></li>
<li><a href="#orge67b345">data application</a></li>
<li><a href="#orgd80d682">eigenschaft function</a></li>
<li><a href="#orge1f17b0">iris</a></li>
<li><a href="#org6be5985">normnalization</a></li>
<li><a href="#orgf700e77">save load</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9c62a5e">theano</a>
<ul>
<li>
<ul>
<li><a href="#orgdac2a39">basic</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgad42593">Backlinks</a></li>
<li><a href="#org901d760">1 Backlinks</a>
<ul>
<li><a href="#org9b1896a">AI</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org254f344" class="outline-2">
<h2 id="org254f344">Tensorflow</h2>
<div class="outline-text-2" id="text-org254f344">
</div>
<div id="outline-container-org2b1d657" class="outline-3">
<h3 id="org2b1d657">Constand additional und multiply</h3>
<div class="outline-text-3" id="text-org2b1d657">
</div>
<div id="outline-container-org6fccd19" class="outline-4">
<h4 id="org6fccd19">addition</h4>
<div class="outline-text-4" id="text-org6fccd19">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #7590db;">a</span> = tf.constant([1.0, 2.0])
<span style="color: #7590db;">b</span> = tf.constant([3.0, 4.0])

<span style="color: #7590db;">a_m</span> = tf.constant([[1.0, 2.0]])
<span style="color: #7590db;">b_m</span> = tf.constant([[3.0], [4.0]])

<span style="color: #7590db;">result_add</span> = a + b
<span style="color: #7590db;">result_multpl</span> = tf.matmul(a_m, b_m)

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #4f97d7; font-weight: bold;">print</span> (sess.run(result_add))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (sess.run(result_multpl))

<span style="color: #4f97d7; font-weight: bold;">print</span> (result_add)
<span style="color: #4f97d7; font-weight: bold;">print</span> (result_multpl)
</pre>
</div>
</div>
</div>


<div id="outline-container-org2c3480a" class="outline-4">
<h4 id="org2c3480a">multiply</h4>
<div class="outline-text-4" id="text-org2c3480a">
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21019;&#24314;&#24120;&#37327;</span>
<span style="color: #7590db;">m1</span>= tf.constant([[3,3]])
<span style="color: #7590db;">m2</span>=tf.constant([[1],[2]])
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#30456;&#20056;</span>
<span style="color: #7590db;">product</span> = tf.matmul(m1,m2)
<span style="color: #4f97d7; font-weight: bold;">print</span>(product)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#19968;&#20010;&#20250;&#35805;&#65292;&#21551;&#21160;&#40664;&#35748;&#22270;</span>
<span style="color: #7590db;">sess</span> = tf.Session()
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35843;&#29992;sess&#65292;&#25191;&#34892;&#20056;&#27861;&#36816;&#31639;</span>
<span style="color: #7590db;">result</span> = sess.run(product)
<span style="color: #4f97d7; font-weight: bold;">print</span>(result)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#19981;&#35201;&#24536;&#20102;&#20851;&#38381;sess</span>
sess.close()

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">result</span> = sess.run(product)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(result)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;with&#19981;&#38656;&#35201;&#19987;&#38376;&#20851;&#38381;sess</span>


</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9aec7b1" class="outline-3">
<h3 id="org9aec7b1">Variable</h3>
<div class="outline-text-3" id="text-org9aec7b1">
</div>
<div id="outline-container-org02e9117" class="outline-4">
<h4 id="org02e9117">the first using of variable &amp; subtract add</h4>
<div class="outline-text-4" id="text-org02e9117">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
  <span style="color: #7590db;">x</span> = tf.Variable([1,2])
  <span style="color: #7590db;">a</span> = tf.constant([3,3])
  <span style="color: #7590db;">sub</span> = tf.subtract(x,a)
  <span style="color: #7590db;">add</span> = tf.add(x,sub)
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23545;&#20110;&#21464;&#37327;&#65292;&#35201;&#21021;&#22987;&#21270;init</span>
  <span style="color: #7590db;">init</span> = tf.global_variables_initializer()
  <span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
      sess.run(init)
      <span style="color: #4f97d7; font-weight: bold;">print</span>(sess.run(sub))
      <span style="color: #4f97d7; font-weight: bold;">print</span>(sess.run(add))


</pre>
</div>
</div>
</div>

<div id="outline-container-orgb299d30" class="outline-4">
<h4 id="orgb299d30">assign a value for variable and update &amp; assign</h4>
<div class="outline-text-4" id="text-orgb299d30">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">............................&#65294;&#65294;&#65294;&#65294;&#65294;&#65294;&#21464;&#37327;&#35745;&#31639;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21464;&#37327;&#21487;&#20197;&#34987;&#36215;&#21517;&#65292;&#21021;&#22987;&#21270;&#20026;&#65296;</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #7590db;">state</span> = tf.Variable(0, name = <span style="color: #2d9574;">'counter'</span>)
<span style="color: #7590db;">new_value</span> = tf.add(state,1)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36171;&#20540;&#21151;&#33021;assign</span>
<span style="color: #7590db;">update</span> = tf.assign(state,new_value)
<span style="color: #7590db;">init</span> = tf.global_variables_initializer()
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    sess.run(init)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(state)
    <span style="color: #4f97d7; font-weight: bold;">for</span> _ <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(5):
        sess.run(update)
        <span style="color: #4f97d7; font-weight: bold;">print</span>(sess.run(state))
        <span style="color: #4f97d7; font-weight: bold;">print</span>(sess.run(update))


</pre>
</div>
</div>
</div>

<div id="outline-container-org3652c47" class="outline-4">
<h4 id="org3652c47">fetch and Feed &amp;placeholder</h4>
<div class="outline-text-4" id="text-org3652c47">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Fetch &#22312;&#19968;&#20010;&#20250;&#35805;&#37324;&#25191;&#34892;&#22810;&#20010;op</span>
<span style="color: #7590db;">input1</span> = tf.constant(3.0)
<span style="color: #7590db;">input2</span> = tf.constant(2.0)
<span style="color: #7590db;">input3</span> = tf.constant(5.0)

<span style="color: #7590db;">add</span> = tf.add(input2,input3)
<span style="color: #7590db;">mul</span> = tf.multiply(input1,add)

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">result</span> = sess.run([add,mul])  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26377;[]</span>
    <span style="color: #4f97d7; font-weight: bold;">print</span>(result)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">------------------Feed</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21019;&#24314;&#21344;&#20301;&#31526;</span>
<span style="color: #7590db;">input4</span>= tf.placeholder(tf.float32)
<span style="color: #7590db;">input5</span> = tf.placeholder(tf.float32)
<span style="color: #7590db;">output</span> = tf.multiply(input4, input5)
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(sess.run(output,feed_dict = {input4:[7.0],input5:[2.0]}))  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#38543;&#21518;&#36171;&#20540;&#26159;&#29992;&#23383;&#20856;&#30340;&#26041;&#24335;&#36827;&#34892;&#30340;feed_dict = {input4:[7.0],input5:[2.0]}, &#25968;&#23383;&#36824;&#21152;&#20102;&#26041;&#25324;&#21495;&#65294;</span>


</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgff7a89b" class="outline-3">
<h3 id="orgff7a89b">Tuning</h3>
<div class="outline-text-3" id="text-orgff7a89b">
</div>
<div id="outline-container-org5b99ae5" class="outline-4">
<h4 id="org5b99ae5">change learing rate</h4>
<div class="outline-text-4" id="text-org5b99ae5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">coding:utf-8</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #7590db;">LEARING_RATE_BASE</span> = 0.1
<span style="color: #7590db;">LEARING_RATE_DECAY</span> = 0.99
<span style="color: #7590db;">LEARING_RATE_STEP</span>= 1

<span style="color: #7590db;">global_step</span> = tf.Variable(0,trainable = <span style="color: #a45bad;">False</span>)
<span style="color: #7590db;">learning_rate</span> = tf.train.exponential_decay(LEARING_RATE_BASE, global_step,
LEARING_RATE_STEP, LEARING_RATE_DECAY, staircase = <span style="color: #a45bad;">True</span>)

<span style="color: #7590db;">w</span> = tf.Variable(tf.constant(5, dtype = tf.float32))
<span style="color: #7590db;">loss</span> = tf.square(w+1)

<span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(learning_rate).minimize(loss,global_step = global_step)

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">init_op</span> = tf.global_variables_initializer()
    sess.run(init_op)
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(40):
        sess.run(train_step)
        <span style="color: #7590db;">learnin_rate_val</span> = sess.run(learning_rate)
        <span style="color: #7590db;">global_step_val</span> = sess.run(global_step)
        <span style="color: #7590db;">w_val</span> = sess.run(w)
        <span style="color: #7590db;">loss_val</span> = sess.run(loss)
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">" After {} steps: global_step is {}, w is {}, learnin_rate is {}, loss is {}"</span>
.<span style="color: #4f97d7;">format</span>(i, global_step_val, w_val, learnin_rate_val, loss_val))


</pre>
</div>
</div>
</div>
<div id="outline-container-org21033a1" class="outline-4">
<h4 id="org21033a1">learing rate for loss</h4>
<div class="outline-text-4" id="text-org21033a1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #7590db;">w</span> = tf.Variable(tf.constant(5,dtype=tf.float32))
<span style="color: #7590db;">loss</span> = tf.square(w+1)
<span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.2).minimize(loss)

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">init_op</span>=tf.global_variables_initializer()
    sess.run(init_op)
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(50):
        sess.run(train_step)
        <span style="color: #7590db;">w_var</span> = sess.run(w)
        <span style="color: #7590db;">loss_val</span> = sess.run(loss)
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"After {} steps: w is {}, loss is {}"</span>.<span style="color: #4f97d7;">format</span>(i,w_var,loss_val))
        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">print("After %s steps: w is %f, loss is %f." %(i,w_var, loss_val))</span>


</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf20f9ce" class="outline-3">
<h3 id="orgf20f9ce">train examples</h3>
<div class="outline-text-3" id="text-orgf20f9ce">
</div>
<div id="outline-container-org0b9e66d" class="outline-4">
<h4 id="org0b9e66d">the first train case</h4>
<div class="outline-text-4" id="text-org0b9e66d">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#29983;&#25104;&#38543;&#26426;&#25968;&#25454;</span>
<span style="color: #7590db;">x_date</span> = np.random.rand(100)
<span style="color: #7590db;">y_date</span> = x_date*0.4 + 2

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#36896;&#32447;&#24615;&#27169;&#22411;</span>
<span style="color: #7590db;">b</span> = tf.Variable(0.)
<span style="color: #7590db;">k</span> = tf.Variable(0.)
<span style="color: #7590db;">y</span> = k*x_date + b

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#36896;&#20108;&#27425;&#20195;&#20215;&#20989;&#25968;</span>
<span style="color: #7590db;">loss</span> = tf.reduce_mean(tf.square(y_date-y))
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#26799;&#24230;&#19979;&#38477;&#30340;&#20248;&#21270;&#22120;</span>
<span style="color: #7590db;">optimizer</span> = tf.train.GradientDescentOptimizer(0.2)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#19968;&#20010;&#26368;&#23567;&#21270;&#20195;&#20215;&#20989;&#25968;</span>
<span style="color: #7590db;">train</span> = optimizer.minimize(loss)
<span style="color: #7590db;">init</span> = tf.global_variables_initializer()
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    sess.run(init)
    <span style="color: #4f97d7; font-weight: bold;">for</span> steps <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(201):
        sess.run(train)
        <span style="color: #4f97d7; font-weight: bold;">if</span> steps%20 == 0:
            <span style="color: #4f97d7; font-weight: bold;">print</span>(steps, sess.run([k,b]))
    <span style="color: #7590db;">prediction_value</span> = sess.run(y)
    plt.figure()
    plt.scatter(x_date, y_date)
    plt.plot(x_date,prediction_value,<span style="color: #2d9574;">'r-'</span>,lw=5)
    plt.show()



</pre>
</div>
</div>
</div>

<div id="outline-container-orgf16303f" class="outline-4">
<h4 id="orgf16303f">non linear regression case</h4>
<div class="outline-text-4" id="text-orgf16303f">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">----------------------------&#38750;&#32447;&#24615;&#22238;&#24402;</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#36896;&#25968;&#25454;</span>
<span style="color: #7590db;">x_date</span> = np.linspace (-0.5,0.5,100)[:,np.newaxis] <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">np.newaxis &#21151;&#33021;&#21516;None&#65292;&#23558;&#34892;&#21464;&#21015;</span>
<span style="color: #7590db;">noise</span> = np.random.normal(0,0.02,x_date.shape)
<span style="color: #7590db;">y_date</span> = np.square(x_date)+noise

<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,1])
<span style="color: #7590db;">y</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,1])

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#24314;&#31070;&#32463;&#32593;&#32476;</span>
<span style="color: #7590db;">Weight_L1</span> = tf.Variable(tf.random_normal([1,10]))
<span style="color: #7590db;">Biase_L1</span> = tf.Variable(tf.zeros([1,10]))
<span style="color: #7590db;">Wx_plus_b_L1</span> = tf.matmul(x,Weight_L1)+Biase_L1
<span style="color: #7590db;">L1</span> = tf.nn.tanh(Wx_plus_b_L1)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#36755;&#20986;&#23618;</span>
<span style="color: #7590db;">Weight_L2</span> = tf.Variable(tf.random_normal([10,1]))
<span style="color: #7590db;">Biase_L2</span> = tf.Variable(tf.zeros([1,1]))
<span style="color: #7590db;">Wx_plus_b_L2</span> = tf.matmul(L1,Weight_L2)+ Biase_L2
<span style="color: #7590db;">prediction</span> = tf.nn.tanh(Wx_plus_b_L2)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20108;&#27425;&#20195;&#20215;&#20989;&#25968;</span>
<span style="color: #7590db;">loss</span> = tf.reduce_mean(tf.square(y-prediction))
<span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.1).minimize(loss)
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    sess.run(tf.global_variables_initializer())
    <span style="color: #4f97d7; font-weight: bold;">for</span> _ <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(2000):
        sess.run(train_step,feed_dict={x:x_date,y:y_date})

    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35757;&#32451;&#22909;&#21518;&#65292;&#29992;&#26469;&#20570;&#39044;&#27979;</span>
    <span style="color: #7590db;">prediction_value</span> = sess.run(prediction,feed_dict={x:x_date})
    plt.figure()
    plt.scatter(x_date, y_date)
    plt.plot(x_date,prediction_value,<span style="color: #2d9574;">'r-'</span>,lw=5)
    plt.show()


</pre>
</div>
</div>
</div>

<div id="outline-container-orgbcb708a" class="outline-4">
<h4 id="orgbcb708a">the first train with data for accuary</h4>
<div class="outline-text-4" id="text-orgbcb708a">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">from</span> tensorflow.examples.tutorials.mnist <span style="color: #4f97d7; font-weight: bold;">import</span> input_data
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36733;&#20837;&#25968;&#25454;&#38598;</span>
<span style="color: #7590db;">mnist</span>= input_data.read_data_sets(<span style="color: #2d9574;">'MNIST_data'</span>, one_hot = <span style="color: #a45bad;">True</span>)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#23450;&#27599;&#20010;&#25209;&#27425;&#30340;&#22823;&#23567;</span>
<span style="color: #7590db;">batch_size</span> = 100
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35745;&#31639;&#24635;&#20849;&#30340;&#25209;&#27425;</span>
<span style="color: #7590db;">n_batch</span> = mnist.train.num_examples // batch_size

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21442;&#25968;&#32479;&#35745;</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">variable_summries</span>(var):
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'summaries'</span>):
        <span style="color: #7590db;">mean</span> = tf.reduce_mean(var)
        tf.summary.scalar(<span style="color: #2d9574;">'mean'</span>,mean)
        <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'stddev'</span>):
            <span style="color: #7590db;">stddev</span> = tf.sqrt(tf.reduce_mean(tf.square(var-mean)))
        tf.summary.scalar(<span style="color: #2d9574;">'stddev'</span>,stddev)
        tf.summary.scalar(<span style="color: #2d9574;">'max'</span>,tf.reduce_max(var))
        tf.summary.scalar(<span style="color: #2d9574;">'min'</span>,tf.reduce_min(var))
        tf.summary.histogram(<span style="color: #2d9574;">'histogram'</span>,var)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21629;&#21517;&#31354;&#38388;</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'input'</span>):
    <span style="color: #7590db;">x</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,784])
    <span style="color: #7590db;">y</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,10])

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'layers'</span>):
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'wight'</span>):
        <span style="color: #7590db;">W</span> = tf.Variable(tf.truncated_normal([784,10]))
        variable_summries(W)
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'biases'</span>):
        <span style="color: #7590db;">B</span> = tf.Variable(tf.zeros([10])+0.1)
        variable_summries(B)
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'wx_plus_b'</span>):
        <span style="color: #7590db;">wx_plus_b</span>=tf.matmul(x,W)+B
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'softmax'</span>):    
        <span style="color: #7590db;">prediction</span> = tf.nn.tanh(wx_plus_b)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#20108;&#27425;&#20195;&#20215;&#20989;&#25968;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">loss = tf.reduce_mean(tf.square(y-prediction))</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#37325;&#26032;&#23450;&#20041;&#23545;&#25968;(&#20132;&#21449;&#29109;)</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'loss'</span>):
    <span style="color: #7590db;">loss</span> =tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=y,logits=prediction))
    tf.summary.scalar(<span style="color: #2d9574;">'loss'</span>,loss)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#26799;&#24230;&#19979;&#38477;&#27861;</span>

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'train'</span>):
    <span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.2).minimize(loss)
<span style="color: #2aa1ae; background-color: #292e34;">#    </span><span style="color: #2aa1ae; background-color: #292e34;">train_step = tf.train.AdamOptimizer(0.05).minimize(loss)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;</span>
<span style="color: #7590db;">init</span> = tf.global_variables_initializer()

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27979;&#35797;&#20934;&#30830;&#29575;</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'accuracy'</span>):
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'correct_prediction'</span>):
        <span style="color: #7590db;">correct_prediction</span> = tf.equal(tf.argmax(y,1), tf.argmax(prediction,1))
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'accuracy'</span>):
        <span style="color: #7590db;">accuracy</span> = tf.reduce_mean(tf.cast(correct_prediction,tf.float32))
        tf.summary.scalar(<span style="color: #2d9574;">'accuracy'</span>,accuracy)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21512;&#24182;summary</span>
<span style="color: #7590db;">merged</span> = tf.summary.merge_all()
        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35757;&#32451;&#24320;&#22987;</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">writer</span> = tf.summary.FileWriter(<span style="color: #2d9574;">'pics/'</span>,sess.graph)
    sess.run(init)
    <span style="color: #4f97d7; font-weight: bold;">for</span> epoch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(51):
        <span style="color: #4f97d7; font-weight: bold;">for</span> batch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(n_batch):
            <span style="color: #7590db;">batch_xs</span>, <span style="color: #7590db;">batch_ys</span> = mnist.train.next_batch(batch_size)
            <span style="color: #7590db;">summary</span>,<span style="color: #7590db;">_</span> = sess.run([merged,train_step], feed_dict={x:batch_xs, y:batch_ys})
<span style="color: #2aa1ae; background-color: #292e34;">#            </span><span style="color: #2aa1ae; background-color: #292e34;">writer.add_summary(summary,batch)</span>
        writer.add_summary(summary,epoch)
        <span style="color: #7590db;">acc</span> = sess.run(accuracy,feed_dict={x:mnist.test.images, y:mnist.test.labels})
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"&#20934;&#30830;&#29575;&#20026;:&#12288;&#22312;"</span>+<span style="color: #4f97d7;">str</span>(epoch)+<span style="color: #2d9574;">"&#22238;,"</span>+<span style="color: #4f97d7;">str</span>(acc))



</pre>
</div>
</div>
</div>

<div id="outline-container-org4b61725" class="outline-4">
<h4 id="org4b61725">a simple CNN case</h4>
<div class="outline-text-4" id="text-org4b61725">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #7590db;">BATCH_SIZE</span> = 8
<span style="color: #7590db;">seed</span> = 23455

<span style="color: #7590db;">rng</span> = np.random.RandomState(seed)
<span style="color: #7590db;">X</span> = rng.rand(32, 2)
<span style="color: #7590db;">Y</span> = [[<span style="color: #4f97d7;">int</span>(X0+X1 &lt; 1)] <span style="color: #4f97d7; font-weight: bold;">for</span> (X0, X1) <span style="color: #4f97d7; font-weight: bold;">in</span> X]
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">print ("X is :", X)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">print ("Y is :", Y)</span>

<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32, shape = (<span style="color: #a45bad;">None</span>, 2))
<span style="color: #7590db;">y_</span> = tf.placeholder(tf.float32, shape = (<span style="color: #a45bad;">None</span>, 1))

<span style="color: #7590db;">w1</span> = tf.Variable(tf.random_normal([2,3], stddev=1, seed=1))
<span style="color: #7590db;">w</span> = tf.Variable(tf.random_normal([3,3], stddev=1, seed=1))
<span style="color: #7590db;">w2</span> = tf.Variable(tf.random_normal([3,1], stddev=1, seed=1))

<span style="color: #7590db;">a</span> = tf.matmul(x,w1)
<span style="color: #7590db;">b</span> = tf.matmul(a,w)
<span style="color: #7590db;">y</span> = tf.matmul(b,w2)

<span style="color: #7590db;">loss</span> = tf.reduce_mean(tf.square(y-y_))
<span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.001).minimize(loss)

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">init_op</span> = tf.global_variables_initializer()
    sess.run(init_op)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"w1 is :"</span>, sess.run(w1))
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"w is :"</span>, sess.run(w))
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"w2 is :"</span>, sess.run(w2))

    <span style="color: #7590db;">steps</span>= 30000
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(steps):
        <span style="color: #7590db;">start</span> = (i*BATCH_SIZE) % 32
        <span style="color: #7590db;">end</span> = start + BATCH_SIZE
        sess.run(train_step, feed_dict={x:X[start:end], y_:Y[start:end]})
        <span style="color: #4f97d7; font-weight: bold;">if</span> i % 5000 == 0:
            <span style="color: #7590db;">total_loss</span> = sess.run(loss, feed_dict={x:X, y_:Y})
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"After %d training steps, loss on all data is %g"</span> %(i,total_loss))
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"\n"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"w1 is :"</span>, sess.run(w1))
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"w is :"</span>, sess.run(w))
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"w2 is :"</span>, sess.run(w2))

</pre>
</div>
</div>
</div>

<div id="outline-container-orge0972bc" class="outline-4">
<h4 id="orge0972bc">CNN train</h4>
<div class="outline-text-4" id="text-orge0972bc">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">from</span> tensorflow.examples.tutorials.mnist <span style="color: #4f97d7; font-weight: bold;">import</span> input_data

<span style="color: #7590db;">mnist</span>=input_data.read_data_sets(<span style="color: #2d9574;">"MNIST_data"</span>,one_hot = <span style="color: #a45bad;">True</span>)

<span style="color: #7590db;">batch_size</span> = 100
<span style="color: #7590db;">n_batch</span> = mnist.train.num_examples // batch_size

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;&#26435;&#20540;</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">weight_variable</span>(shape):
    <span style="color: #4f97d7; font-weight: bold;">return</span> tf.Variable(tf.truncated_normal(shape,stddev =0.01))

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;&#20559;&#32622;</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">bias_variable</span>(shape):
    <span style="color: #4f97d7; font-weight: bold;">return</span> tf.Variable(tf.constant(0.1,shape= shape))

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#21367;&#31215;&#23618;</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">conv2d</span>(x,W):
    <span style="color: #4f97d7; font-weight: bold;">return</span> tf.nn.conv2d(x,W,strides=[1,1,1,1],padding=<span style="color: #2d9574;">"SAME"</span>) 

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27744;&#21270;&#23618;&#23450;&#20041;</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">max_pool_2x2</span>(x):
    <span style="color: #4f97d7; font-weight: bold;">return</span> tf.nn.max_pool(x,ksize =[1,2,2,1],strides=[1,2,2,1], padding = <span style="color: #2d9574;">"SAME"</span>)

<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>, 784])
<span style="color: #7590db;">y</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,10])

<span style="color: #7590db;">x_image</span> = tf.reshape(x,[-1,28,28,1])

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;&#31532;&#19968;&#20010;&#21367;&#31215;&#23618;&#30340;&#26435;&#20540;&#21644;&#20559;&#32622;&#65292;&#36755;&#20837;&#20854;&#35201;&#27714;&#30340;&#24418;&#29366;</span>
<span style="color: #7590db;">W_convl</span> = weight_variable([5,5,1,32]) <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">5x5&#30340;&#37319;&#26679;&#31383;&#21475;&#22823;&#23567;&#65292;&#65297;&#36890;&#36947;&#23545;&#40657;&#30333;&#65292;&#65299;&#36890;&#36947;&#23545;&#24425;&#33394;</span>
<span style="color: #7590db;">b_convl</span> = bias_variable([32])

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#29616;&#22312;&#21367;&#31215;</span>
<span style="color: #7590db;">h_conv1</span> = tf.nn.relu(conv2d(x_image,W_convl) +b_convl)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#29616;&#22312;&#27744;&#21270;</span>
<span style="color: #7590db;">h_pool1</span> = max_pool_2x2(h_conv1) 

<span style="color: #2aa1ae; background-color: #292e34;">###</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#31532;&#20108;&#20010;&#21367;&#31215;&#23618;</span>
<span style="color: #7590db;">W_convl2</span> = weight_variable([5,5,32,64]) <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">5x5&#30340;&#37319;&#26679;&#31383;&#21475;&#22823;&#23567;&#65292;&#65297;&#36890;&#36947;&#23545;&#40657;&#30333;&#65292;&#65299;&#36890;&#36947;&#23545;&#24425;&#33394;</span>
<span style="color: #7590db;">b_convl2</span> = bias_variable([64])

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#29616;&#22312;&#21367;&#31215;</span>
<span style="color: #7590db;">h_conv2</span> = tf.nn.relu(conv2d(h_pool1 ,W_convl2) +b_convl2)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#29616;&#22312;&#27744;&#21270;</span>
<span style="color: #7590db;">h_pool2</span> = max_pool_2x2(h_conv2)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27744;&#21270;&#21518;&#23558;&#32467;&#26524;&#25153;&#24179;&#21270;&#22788;&#29702;&#65292;&#20197;&#20415;&#36755;&#20837;&#32593;&#32476;</span>
<span style="color: #7590db;">h_pool2_flat</span> = tf.reshape(h_pool2, [-1,7*7*64])

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#24314;&#31435;&#31532;&#19968;&#20010;&#31070;&#32463;&#32593;&#32476;&#30340;&#20840;&#36830;&#25509;&#23618;&#65292;&#21021;&#22987;&#21270;&#20854;&#26435;&#37325;&#21644;&#20559;&#32622;</span>
<span style="color: #7590db;">W_fcl</span> = weight_variable([7*7*64, 100])
<span style="color: #7590db;">b_fcl</span> = bias_variable([100])

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#23618;&#30340;&#35745;&#31639;</span>
<span style="color: #7590db;">h_fcl</span> = tf.nn.relu(tf.matmul(h_pool2_flat, W_fcl) + b_fcl)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">dropout</span>
<span style="color: #7590db;">keep_prob</span> = tf.placeholder(tf.float32)
<span style="color: #7590db;">h_fcl_drop</span> = tf.nn.dropout(h_fcl, keep_prob)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#24314;&#31435;&#31532;&#20108;&#20010;&#31070;&#32463;&#23618;</span>
<span style="color: #7590db;">W_fc2</span> = weight_variable([100,10])
<span style="color: #7590db;">b_fc2</span> = bias_variable([10])
<span style="color: #7590db;">prediction</span> = tf.nn.softmax(tf.matmul(h_fcl_drop, W_fc2)+b_fc2)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20132;&#21449;&#29109;</span>
<span style="color: #7590db;">cross_entropy</span> = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels = y, logits=prediction))
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20248;&#21270;</span>
<span style="color: #7590db;">train_step</span> = tf.train.AdamOptimizer(1e-4).minimize(cross_entropy)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#32467;&#26524;</span>
<span style="color: #7590db;">correct_prediction</span> = tf.equal(tf.argmax(prediction,1),tf.argmax(y,1))
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20934;&#30830;&#29575;</span>
<span style="color: #7590db;">accuracy</span> = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    sess.run(tf.global_variables_initializer())
    <span style="color: #4f97d7; font-weight: bold;">for</span> epoch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(21):
        <span style="color: #4f97d7; font-weight: bold;">for</span> batch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(n_batch):
            <span style="color: #7590db;">batch_xs</span>, <span style="color: #7590db;">batch_ys</span> = mnist.train.next_batch(batch_size)
            sess.run(train_step, feed_dict={x:batch_xs, y:batch_ys, keep_prob:0.7})
        <span style="color: #7590db;">acc</span>= sess.run(accuracy, feed_dict={x:mnist.test.images,y:mnist.test.labels, keep_prob:1.0})
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"&#22312;&#31532;"</span>+<span style="color: #4f97d7;">str</span>(epoch)+<span style="color: #2d9574;">"&#36718;&#65292;&#20934;&#30830;&#29575;&#20026;"</span>+<span style="color: #4f97d7;">str</span>(acc))

</pre>
</div>
</div>
</div>
<div id="outline-container-org0ae002d" class="outline-4">
<h4 id="org0ae002d">classification</h4>
<div class="outline-text-4" id="text-org0ae002d">
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">from</span> tensorflow.examples.tutorials.mnist <span style="color: #4f97d7; font-weight: bold;">import</span> input_data
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">number 1 to 10 data</span>
<span style="color: #7590db;">mnist</span> = input_data.read_data_sets(<span style="color: #2d9574;">'MNIST_data'</span>, one_hot=<span style="color: #a45bad;">True</span>)

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">add_layer</span>(inputs, in_size, out_size, activation_function=<span style="color: #a45bad;">None</span>,):
    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">add one more layer and return the output of this layer</span>
    <span style="color: #7590db;">Weights</span> = tf.Variable(tf.random_normal([in_size, out_size]))
    <span style="color: #7590db;">biases</span> = tf.Variable(tf.zeros([1, out_size]) + 0.1,)
    <span style="color: #7590db;">Wx_plus_b</span> = tf.matmul(inputs, Weights) + biases
    <span style="color: #4f97d7; font-weight: bold;">if</span> activation_function <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #a45bad;">None</span>:
        <span style="color: #7590db;">outputs</span> = Wx_plus_b
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        <span style="color: #7590db;">outputs</span> = activation_function(Wx_plus_b,)
    <span style="color: #4f97d7; font-weight: bold;">return</span> outputs

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">compute_accuracy</span>(v_xs, v_ys):
    <span style="color: #4f97d7; font-weight: bold;">global</span> prediction
    <span style="color: #7590db;">y_pre</span> = sess.run(prediction, feed_dict={xs: v_xs})
    <span style="color: #7590db;">correct_prediction</span> = tf.equal(tf.argmax(y_pre,1), tf.argmax(v_ys,1))
    <span style="color: #7590db;">accuracy</span> = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))
    <span style="color: #7590db;">result</span> = sess.run(accuracy, feed_dict={xs: v_xs, ys: v_ys})
    <span style="color: #4f97d7; font-weight: bold;">return</span> result

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">define placeholder for inputs to network</span>
<span style="color: #7590db;">xs</span> = tf.placeholder(tf.float32, [<span style="color: #a45bad;">None</span>, 784]) <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">28x28</span>
<span style="color: #7590db;">ys</span> = tf.placeholder(tf.float32, [<span style="color: #a45bad;">None</span>, 10])

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">add output layer</span>
<span style="color: #7590db;">prediction</span> = add_layer(xs, 784, 10,  activation_function=tf.nn.softmax)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the error between prediction and real data</span>
<span style="color: #7590db;">cross_entropy</span> = tf.reduce_mean(-tf.reduce_sum(ys * tf.log(prediction),
                                              reduction_indices=[1]))       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">loss</span>
<span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.5).minimize(cross_entropy)

<span style="color: #7590db;">sess</span> = tf.Session()
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">important step</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">tf.initialize_all_variables() no long valid from</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2017-03-02 if using tensorflow &gt;= 0.12</span>
<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">int</span>((tf.__version__).split(<span style="color: #2d9574;">'.'</span>)[1]) &lt; 12 <span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #4f97d7;">int</span>((tf.__version__).split(<span style="color: #2d9574;">'.'</span>)[0]) &lt; 1:
    <span style="color: #7590db;">init</span> = tf.initialize_all_variables()
<span style="color: #4f97d7; font-weight: bold;">else</span>:
    <span style="color: #7590db;">init</span> = tf.global_variables_initializer()
sess.run(init)

<span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(1000):
    <span style="color: #7590db;">batch_xs</span>, <span style="color: #7590db;">batch_ys</span> = mnist.train.next_batch(100)
    sess.run(train_step, feed_dict={xs: batch_xs, ys: batch_ys})
    <span style="color: #4f97d7; font-weight: bold;">if</span> i % 50 == 0:
        <span style="color: #4f97d7; font-weight: bold;">print</span>(compute_accuracy(
            mnist.test.images, mnist.test.labels))


</pre>
</div>
</div>
</div>
<div id="outline-container-orgee472ed" class="outline-4">
<h4 id="orgee472ed">optimizer varialbe (with error)</h4>
<div class="outline-text-4" id="text-orgee472ed">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np


<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">add_layer</span>(inputs, in_size, out_size, n_layer, activation_function=<span style="color: #a45bad;">None</span>):
    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">add one more layer and return the output of this layer</span>
    <span style="color: #7590db;">layer_name</span> = <span style="color: #2d9574;">'layer%s'</span> % n_layer
    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(layer_name):
        <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'weights'</span>):
            <span style="color: #7590db;">Weights</span> = tf.Variable(tf.random_normal([in_size, out_size]), name=<span style="color: #2d9574;">'W'</span>)
            tf.summary.histogram(layer_name + <span style="color: #2d9574;">'/weights'</span>, Weights)
        <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'biases'</span>):
            <span style="color: #7590db;">biases</span> = tf.Variable(tf.zeros([1, out_size]) + 0.1, name=<span style="color: #2d9574;">'b'</span>)
            tf.summary.histogram(layer_name + <span style="color: #2d9574;">'/biases'</span>, biases)
        <span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'Wx_plus_b'</span>):
            <span style="color: #7590db;">Wx_plus_b</span> = tf.add(tf.matmul(inputs, Weights), biases)
        <span style="color: #4f97d7; font-weight: bold;">if</span> activation_function <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #a45bad;">None</span>:
            <span style="color: #7590db;">outputs</span> = Wx_plus_b
        <span style="color: #4f97d7; font-weight: bold;">else</span>:
            <span style="color: #7590db;">outputs</span> = activation_function(Wx_plus_b, )
        tf.summary.histogram(layer_name + <span style="color: #2d9574;">'/outputs'</span>, outputs)
    <span style="color: #4f97d7; font-weight: bold;">return</span> outputs


<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Make up some real data</span>
<span style="color: #7590db;">x_data</span> = np.linspace(-1, 1, 300)[:, np.newaxis]
<span style="color: #7590db;">noise</span> = np.random.normal(0, 0.05, x_data.shape)
<span style="color: #7590db;">y_data</span> = np.square(x_data) - 0.5 + noise

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">define placeholder for inputs to network</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'inputs'</span>):
    <span style="color: #7590db;">xs</span> = tf.placeholder(tf.float32, [<span style="color: #a45bad;">None</span>, 1], name=<span style="color: #2d9574;">'x_input'</span>)
    <span style="color: #7590db;">ys</span> = tf.placeholder(tf.float32, [<span style="color: #a45bad;">None</span>, 1], name=<span style="color: #2d9574;">'y_input'</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">add hidden layer</span>
<span style="color: #7590db;">l1</span> = add_layer(xs, 1, 10, n_layer=1, activation_function=tf.nn.relu)
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">add output layer</span>
<span style="color: #7590db;">prediction</span> = add_layer(l1, 10, 1, n_layer=2, activation_function=<span style="color: #a45bad;">None</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the error between prediciton and real data</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'loss'</span>):
    <span style="color: #7590db;">loss</span> = tf.reduce_mean(tf.reduce_sum(tf.square(ys - prediction),
                                        reduction_indices=[1]))
    tf.summary.scalar(<span style="color: #2d9574;">'loss'</span>, loss)

<span style="color: #4f97d7; font-weight: bold;">with</span> tf.name_scope(<span style="color: #2d9574;">'train'</span>):
    <span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.1).minimize(loss)

<span style="color: #7590db;">sess</span> = tf.Session()
<span style="color: #7590db;">merged</span> = tf.summary.merge_all()

<span style="color: #7590db;">writer</span> = tf.summary.FileWriter(<span style="color: #2d9574;">"logs/"</span>, sess.graph)

<span style="color: #7590db;">init</span> = tf.global_variables_initializer()
sess.run(init)

<span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(1000):
    sess.run(train_step, feed_dict={xs: x_data, ys: y_data})
    <span style="color: #4f97d7; font-weight: bold;">if</span> i % 50 == 0:
        <span style="color: #7590db;">result</span> = sess.run(merged,
                          feed_dict={xs: x_data, ys: y_data})
        writer.add_summary(result, i)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">direct to the local dir and run this in terminal:</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">$ tensorboard --logdir logs</span>


</pre>
</div>
</div>
</div>
<div id="outline-container-orgd5428f5" class="outline-4">
<h4 id="orgd5428f5">dropout</h4>
<div class="outline-text-4" id="text-orgd5428f5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">from</span> tensorflow.examples.tutorials.mnist <span style="color: #4f97d7; font-weight: bold;">import</span> input_data
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36733;&#20837;&#25968;&#25454;&#38598;</span>
<span style="color: #7590db;">mnist</span>= input_data.read_data_sets(<span style="color: #2d9574;">'MNIST_data'</span>, one_hot = <span style="color: #a45bad;">True</span>)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#23450;&#27599;&#20010;&#25209;&#27425;&#30340;&#22823;&#23567;</span>
<span style="color: #7590db;">batch_size</span> = 100
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35745;&#31639;&#24635;&#20849;&#30340;&#25209;&#27425;</span>
<span style="color: #7590db;">n_batch</span> = mnist.train.num_examples//batch_size

<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,784])
<span style="color: #7590db;">y</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,10])
<span style="color: #7590db;">keep_prob</span> = tf.placeholder(tf.float32)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#24314;&#31070;&#32463;&#32593;&#32476;</span>
<span style="color: #7590db;">W</span> = tf.Variable(tf.truncated_normal([784,2000], stddev = 0.1))
<span style="color: #7590db;">B</span> = tf.Variable(tf.zeros([2000])+0.1)
<span style="color: #7590db;">p1</span> = tf.nn.softmax(tf.matmul(x,W)+B)
<span style="color: #7590db;">p1_dropout</span> = tf.nn.dropout(p1,keep_prob)

<span style="color: #7590db;">W1</span> = tf.Variable(tf.truncated_normal([2000,2000]))
<span style="color: #7590db;">B1</span> = tf.Variable(tf.zeros([2000])+0.1)
<span style="color: #7590db;">p2</span> = tf.nn.softmax(tf.matmul(p1_dropout,W1)+B1)
<span style="color: #7590db;">p2_dropout</span> = tf.nn.dropout(p2,keep_prob)

<span style="color: #7590db;">W2</span> = tf.Variable(tf.truncated_normal([2000,10]))
<span style="color: #7590db;">B2</span> = tf.Variable(tf.zeros([10])+0.1)
<span style="color: #7590db;">prediction</span> = tf.nn.softmax(tf.matmul(p2_dropout,W2)+B2)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#20108;&#27425;&#20195;&#20215;&#20989;&#25968;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">loss = tf.reduce_mean(tf.square(y-prediction))</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#37325;&#26032;&#23450;&#20041;&#23545;&#25968;(&#20132;&#21449;&#29109;)</span>
<span style="color: #7590db;">loss</span> =tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=y, logits=prediction))
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#26799;&#24230;&#19979;&#38477;&#27861;</span>
<span style="color: #7590db;">train_step</span> = tf.train.GradientDescentOptimizer(0.2).minimize(loss)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;</span>
<span style="color: #7590db;">init</span> = tf.global_variables_initializer()

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27979;&#35797;&#20934;&#30830;&#29575;</span>
<span style="color: #7590db;">correct_prediction</span> = tf.equal(tf.argmax(y,1), tf.argmax(prediction,1))
<span style="color: #7590db;">accuracy</span> = tf.reduce_mean(tf.cast(correct_prediction,tf.float32))

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35757;&#32451;&#24320;&#22987;</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    sess.run(init)
    <span style="color: #4f97d7; font-weight: bold;">for</span> epoch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(21):
        <span style="color: #4f97d7; font-weight: bold;">for</span> batch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(n_batch):
            <span style="color: #7590db;">batch_xs</span>, <span style="color: #7590db;">batch_ys</span> = mnist.train.next_batch(batch_size)
            sess.run(train_step, feed_dict={x:batch_xs, y:batch_ys,keep_prob:1.0})

        <span style="color: #7590db;">test_acc</span> = sess.run(accuracy,feed_dict={x:mnist.test.images, y:mnist.test.labels, keep_prob:1.0})
        <span style="color: #7590db;">train_acc</span> = sess.run(accuracy,feed_dict={x:mnist.train.images, y:mnist.train.labels, keep_prob:1.0})
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"&#20934;&#30830;&#29575;&#20026;:&#12288;&#22312;"</span>+<span style="color: #4f97d7;">str</span>(epoch)+<span style="color: #2d9574;">"&#22238;,"</span>+<span style="color: #4f97d7;">str</span>(test_acc)+<span style="color: #2d9574;">", &#20294;&#26159;&#22312;&#35757;&#32451;&#38598;&#20013;&#20026;"</span>+<span style="color: #4f97d7;">str</span>(train_acc))


</pre>
</div>
</div>
</div>
<div id="outline-container-org12aed59" class="outline-4">
<h4 id="org12aed59">number identification</h4>
<div class="outline-text-4" id="text-org12aed59">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">from</span> tensorflow.examples.tutorials.mnist <span style="color: #4f97d7; font-weight: bold;">import</span> input_data
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36733;&#20837;&#25968;&#25454;&#38598;</span>
<span style="color: #7590db;">mnist</span>= input_data.read_data_sets(<span style="color: #2d9574;">'MNIST_data'</span>, one_hot = <span style="color: #a45bad;">True</span>)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#23450;&#27599;&#20010;&#25209;&#27425;&#30340;&#22823;&#23567;</span>
<span style="color: #7590db;">batch_size</span> = 100
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35745;&#31639;&#24635;&#20849;&#30340;&#25209;&#27425;</span>
<span style="color: #7590db;">n_batch</span> = mnist.train.num_examples // batch_size

<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,784])
<span style="color: #7590db;">y</span> = tf.placeholder(tf.float32,[<span style="color: #a45bad;">None</span>,10])
<span style="color: #7590db;">keep_prob</span> = tf.placeholder(tf.float32)
<span style="color: #7590db;">lr</span>= tf.Variable(0.001,dtype=tf.float32)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#24314;&#31070;&#32463;&#32593;&#32476;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">W = tf.Variable(tf.truncated_normal([784,10]))</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">B = tf.Variable(tf.zeros([10])+0.1)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">prediction = tf.nn.softmax(tf.matmul(x,W)+B)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">W = tf.Variable(tf.zeros([784,10]))</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">B = tf.Variable(tf.zeros([10]))</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">prediction = tf.nn.softmax(tf.matmul(x,W)+B)</span>

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#26500;&#24314;&#31070;&#32463;&#32593;&#32476;</span>
<span style="color: #7590db;">W</span> = tf.Variable(tf.truncated_normal([784,500],stddev =0.1))
<span style="color: #7590db;">B</span> = tf.Variable(tf.zeros([500])+0.1)
<span style="color: #7590db;">p1</span> = tf.nn.tanh(tf.matmul(x,W)+B)
<span style="color: #7590db;">p1_dropout</span> = tf.nn.dropout(p1,keep_prob)

<span style="color: #7590db;">W1</span> = tf.Variable(tf.truncated_normal([500,200],stddev=0.1))
<span style="color: #7590db;">B1</span> = tf.Variable(tf.zeros([200])+0.1)
<span style="color: #7590db;">p2</span> = tf.nn.tanh(tf.matmul(p1_dropout,W1)+B1)
<span style="color: #7590db;">p2_dropout</span> = tf.nn.dropout(p2,keep_prob)

<span style="color: #7590db;">W2</span> = tf.Variable(tf.truncated_normal([200,10],stddev = 0.1))
<span style="color: #7590db;">B2</span> = tf.Variable(tf.zeros([10])+0.1)
<span style="color: #7590db;">prediction</span> = tf.nn.softmax(tf.matmul(p2_dropout,W2)+B2)



<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#20108;&#27425;&#20195;&#20215;&#20989;&#25968;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">loss = tf.reduce_mean(tf.square(y-prediction))</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#37325;&#26032;&#23450;&#20041;&#23545;&#25968;(&#20132;&#21449;&#29109;)</span>
<span style="color: #7590db;">loss</span> =tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=y,logits=prediction))
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#26799;&#24230;&#19979;&#38477;&#27861;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">train_step = tf.train.GradientDescentOptimizer(0.2).minimize(loss)</span>
<span style="color: #7590db;">train_step</span> = tf.train.AdamOptimizer(lr).minimize(loss)
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;</span>
<span style="color: #7590db;">init</span> = tf.global_variables_initializer()

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27979;&#35797;&#20934;&#30830;&#29575;</span>
<span style="color: #7590db;">correct_prediction</span> = tf.equal(tf.argmax(y,1), tf.argmax(prediction,1))
<span style="color: #7590db;">accuracy</span> = tf.reduce_mean(tf.cast(correct_prediction,tf.float32))

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">#&#35757;&#32451;&#24320;&#22987;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">with tf.Session() as sess:</span>
<span style="color: #2aa1ae; background-color: #292e34;">#     </span><span style="color: #2aa1ae; background-color: #292e34;">sess.run(init)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#     </span><span style="color: #2aa1ae; background-color: #292e34;">for epoch in range(20):</span>
<span style="color: #2aa1ae; background-color: #292e34;">#         </span><span style="color: #2aa1ae; background-color: #292e34;">for batch in range(n_batch):</span>
<span style="color: #2aa1ae; background-color: #292e34;">#             </span><span style="color: #2aa1ae; background-color: #292e34;">batch_xs, batch_ys = mnist.train.next_batch(batch_size)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#             </span><span style="color: #2aa1ae; background-color: #292e34;">sess.run(train_step, feed_dict={x:batch_xs, y:batch_ys})</span>
<span style="color: #2aa1ae; background-color: #292e34;">#         </span><span style="color: #2aa1ae; background-color: #292e34;">acc = sess.run(accuracy,feed_dict={x:mnist.test.images, y:mnist.test.labels})</span>
<span style="color: #2aa1ae; background-color: #292e34;">#         </span><span style="color: #2aa1ae; background-color: #292e34;">print("&#20934;&#30830;&#29575;&#20026;:&#12288;&#22312;"+str(epoch)+"&#22238;,"+str(acc))</span>


<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35757;&#32451;&#24320;&#22987;</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    sess.run(init)
    <span style="color: #4f97d7; font-weight: bold;">for</span> epoch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(41):
        sess.run(tf.assign(lr,0.001*(0.95**epoch)))
        <span style="color: #4f97d7; font-weight: bold;">for</span> batch <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(n_batch):
            <span style="color: #7590db;">batch_xs</span>, <span style="color: #7590db;">batch_ys</span> = mnist.train.next_batch(batch_size)
            sess.run(train_step, feed_dict={x:batch_xs, y:batch_ys,keep_prob:1.0})
        <span style="color: #7590db;">learing_rate</span> = sess.run(lr)
        <span style="color: #7590db;">test_acc</span> = sess.run(accuracy,feed_dict={x:mnist.test.images,
y:mnist.test.labels, keep_prob:1.0})
        <span style="color: #7590db;">train_acc</span> = sess.run(accuracy,feed_dict={x:mnist.train.images,
y:mnist.train.labels, keep_prob:1.0})
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"&#20934;&#30830;&#29575;&#20026;:&#12288;&#22312;"</span>+<span style="color: #4f97d7;">str</span>(epoch)+<span style="color: #2d9574;">"&#22238;,"</span>+<span style="color: #4f97d7;">str</span>(test_acc)+<span style="color: #2d9574;">",&#20294;&#26159;&#22312;&#35757;&#32451;&#38598;&#20013;&#20026;"</span>+<span style="color: #4f97d7;">str</span>(train_acc)+<span style="color: #2d9574;">"&#21516;&#26102;&#23398;&#20064;&#29575;&#20026;"</span>+<span style="color: #4f97d7;">str</span>(learing_rate))


</pre>
</div>
</div>
</div>
<div id="outline-container-orgd4abd3c" class="outline-4">
<h4 id="orgd4abd3c">with Lã€€regularizer</h4>
<div class="outline-text-4" id="text-orgd4abd3c">
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #7590db;">BATCH_SIZE</span> = 30
<span style="color: #7590db;">seed</span> = 2
<span style="color: #7590db;">rdm</span> = np.random.RandomState(seed)
<span style="color: #7590db;">X</span> = rdm.randn(300,2)
<span style="color: #7590db;">Y_</span> = [<span style="color: #4f97d7;">int</span>(x0*x0 + x1*x1 &lt; 2) <span style="color: #4f97d7; font-weight: bold;">for</span> (x0,x1) <span style="color: #4f97d7; font-weight: bold;">in</span> X]
<span style="color: #7590db;">Y_c</span> = [[<span style="color: #2d9574;">'red'</span> <span style="color: #4f97d7; font-weight: bold;">if</span> y <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #2d9574;">'blue'</span>] <span style="color: #4f97d7; font-weight: bold;">for</span> y <span style="color: #4f97d7; font-weight: bold;">in</span> Y_]
<span style="color: #7590db;">X</span> = np.vstack(X).reshape(-1,2)
<span style="color: #7590db;">Y_</span> = np.vstack(Y_).reshape(-1,1)
<span style="color: #4f97d7; font-weight: bold;">print</span>(X)
<span style="color: #4f97d7; font-weight: bold;">print</span>(Y_)
<span style="color: #4f97d7; font-weight: bold;">print</span>(Y_c)
plt.scatter(X[:,0],X[:,1], c = np.squeeze(Y_c))
plt.show()

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_weight</span>(shape, regularizer):
    <span style="color: #7590db;">w</span> = tf.Variable(tf.random_normal(shape), dtype = tf.float32)
    tf.add_to_collection(<span style="color: #2d9574;">'losses'</span>, tf.contrib.layers.l2_regularizer(regularizer)(w))
    <span style="color: #4f97d7; font-weight: bold;">return</span> w
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_bias</span>(shape):
    <span style="color: #7590db;">b</span> = tf.Variable(tf.constant(0.01, shape=shape))
    <span style="color: #4f97d7; font-weight: bold;">return</span> b
<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32, shape=(<span style="color: #a45bad;">None</span>, 2))
<span style="color: #7590db;">y_</span> = tf.placeholder(tf.float32, shape = (<span style="color: #a45bad;">None</span> , 1))
<span style="color: #7590db;">w1</span> = get_weight([2,11], 0.01)
<span style="color: #7590db;">b1</span> = get_bias([11])
<span style="color: #7590db;">y1</span> = tf.nn.relu(tf.matmul(x,w1)+b1)
<span style="color: #7590db;">w2</span> = get_weight([11,1],0.01)
<span style="color: #7590db;">b2</span> = get_bias([1])
<span style="color: #7590db;">y</span> = tf.matmul(y1,w2)+b2

<span style="color: #7590db;">loss_mse</span> = tf.reduce_mean(tf.square(y-y_))
<span style="color: #7590db;">loss_total</span> = loss_mse + tf.add_n(tf.get_collection(<span style="color: #2d9574;">'losses'</span>))

<span style="color: #2aa1ae; background-color: #292e34;">#########</span><span style="color: #2aa1ae; background-color: #292e34;">with Regularizer#########</span>
<span style="color: #7590db;">train_step_l</span> = tf.train.AdamOptimizer(0.0001).minimize(loss_total)
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">init_op</span> = tf.global_variables_initializer()
    sess.run(init_op)
    <span style="color: #7590db;">STEPS</span> = 40000
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(STEPS):
        <span style="color: #7590db;">start</span> = (i*BATCH_SIZE) % 300
        <span style="color: #7590db;">end</span> = start + BATCH_SIZE
        sess.run(train_step_l, feed_dict = {x:X[start:end], y_:Y_[start:end]})
        <span style="color: #4f97d7; font-weight: bold;">if</span> i % 2000 == 0:
            <span style="color: #7590db;">loss_total_v</span> = sess.run(loss_total, feed_dict={x:X,y_:Y_})
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'After %d steps, loss is: %f'</span> %(i, loss_total_v))
    <span style="color: #7590db;">xx</span>, <span style="color: #7590db;">yy</span> = np.mgrid[-3:3:0.01, -3:3:0.01]
    <span style="color: #7590db;">grid</span> = np.c_[xx.ravel(), yy.ravel()]
    <span style="color: #7590db;">probs</span> = sess.run(y, feed_dict={x:grid})
    <span style="color: #7590db;">probs</span> = probs.reshape(xx.shape)
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'w1 is \n:'</span>, sess.run(w1))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'b1 is \n:'</span>, sess.run(b1))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'w2 is \n:'</span>, sess.run(w2))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'b2 is \n:'</span>, sess.run(b2))
plt.scatter(X[:,0], X[:,1], c = np.squeeze(Y_c))
plt.contour(xx, yy, probs, levels = [.5])
plt.show()


<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'loss_mse_v * loss_total_v is :'</span>, loss_mse_v*loss_total_v)


</pre>
</div>
</div>
</div>
<div id="outline-container-org5c5674c" class="outline-4">
<h4 id="org5c5674c">without L regularizer</h4>
<div class="outline-text-4" id="text-org5c5674c">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> tensorflow <span style="color: #4f97d7; font-weight: bold;">as</span> tf
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #7590db;">BATCH_SIZE</span> = 30
<span style="color: #7590db;">seed</span> = 2
<span style="color: #7590db;">rdm</span> = np.random.RandomState(seed)
<span style="color: #7590db;">X</span> = rdm.randn(300,2)
<span style="color: #7590db;">Y_</span> = [<span style="color: #4f97d7;">int</span>(x0*x0 + x1*x1 &lt; 2) <span style="color: #4f97d7; font-weight: bold;">for</span> (x0,x1) <span style="color: #4f97d7; font-weight: bold;">in</span> X]
<span style="color: #7590db;">Y_c</span> = [[<span style="color: #2d9574;">'red'</span> <span style="color: #4f97d7; font-weight: bold;">if</span> y <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #2d9574;">'blue'</span>] <span style="color: #4f97d7; font-weight: bold;">for</span> y <span style="color: #4f97d7; font-weight: bold;">in</span> Y_]
<span style="color: #7590db;">X</span> = np.vstack(X).reshape(-1,2)
<span style="color: #7590db;">Y_</span> = np.vstack(Y_).reshape(-1,1)
<span style="color: #4f97d7; font-weight: bold;">print</span>(X)
<span style="color: #4f97d7; font-weight: bold;">print</span>(Y_)
<span style="color: #4f97d7; font-weight: bold;">print</span>(Y_c)
plt.scatter(X[:,0],X[:,1], c = np.squeeze(Y_c))
plt.show()

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_weight</span>(shape, regularizer):
    <span style="color: #7590db;">w</span> = tf.Variable(tf.random_normal(shape), dtype = tf.float32)
    tf.add_to_collection(<span style="color: #2d9574;">'losses'</span>, tf.contrib.layers.l2_regularizer(regularizer)(w))
    <span style="color: #4f97d7; font-weight: bold;">return</span> w
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_bias</span>(shape):
    <span style="color: #7590db;">b</span> = tf.Variable(tf.constant(0.01, shape=shape))
    <span style="color: #4f97d7; font-weight: bold;">return</span> b
<span style="color: #7590db;">x</span> = tf.placeholder(tf.float32, shape=(<span style="color: #a45bad;">None</span>, 2))
<span style="color: #7590db;">y_</span> = tf.placeholder(tf.float32, shape = (<span style="color: #a45bad;">None</span> , 1))
<span style="color: #7590db;">w1</span> = get_weight([2,11], 0.01)
<span style="color: #7590db;">b1</span> = get_bias([11])
<span style="color: #7590db;">y1</span> = tf.nn.relu(tf.matmul(x,w1)+b1)
<span style="color: #7590db;">w2</span> = get_weight([11,1],0.01)
<span style="color: #7590db;">b2</span> = get_bias([1])
<span style="color: #7590db;">y</span> = tf.matmul(y1,w2)+b2

<span style="color: #7590db;">loss_mse</span> = tf.reduce_mean(tf.square(y-y_))
<span style="color: #7590db;">loss_total</span> = loss_mse + tf.add_n(tf.get_collection(<span style="color: #2d9574;">'losses'</span>))
<span style="color: #2aa1ae; background-color: #292e34;">#########</span><span style="color: #2aa1ae; background-color: #292e34;">without Regularizer#########</span>
<span style="color: #7590db;">train_step</span> = tf.train.AdamOptimizer(0.0001).minimize(loss_mse)
<span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
    <span style="color: #7590db;">init_op</span> = tf.global_variables_initializer()
    sess.run(init_op)
    <span style="color: #7590db;">STEPS</span> = 40000
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(STEPS):
        <span style="color: #7590db;">start</span> = (i*BATCH_SIZE) % 300
        <span style="color: #7590db;">end</span> = start + BATCH_SIZE
        sess.run(train_step, feed_dict = {x:X[start:end], y_:Y_[start:end]})
        <span style="color: #4f97d7; font-weight: bold;">if</span> i % 2000 == 0:
            <span style="color: #7590db;">loss_mse_v</span> = sess.run(loss_mse, feed_dict={x:X,y_:Y_})
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'After %d steps, loss is: %f'</span> %(i, loss_mse_v))
    <span style="color: #7590db;">xx</span>, <span style="color: #7590db;">yy</span> = np.mgrid[-3:3:0.01, -3:3:0.01]
    <span style="color: #7590db;">grid</span> = np.c_[xx.ravel(), yy.ravel()]
    <span style="color: #7590db;">probs</span> = sess.run(y, feed_dict={x:grid})
    <span style="color: #7590db;">probs</span> = probs.reshape(xx.shape)
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'w1 is \n:'</span>, sess.run(w1))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'b1 is \n:'</span>, sess.run(b1))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'w2 is \n:'</span>, sess.run(w2))
    <span style="color: #4f97d7; font-weight: bold;">print</span> (<span style="color: #2d9574;">'b2 is \n:'</span>, sess.run(b2))
plt.scatter(X[:,0], X[:,1], c = np.squeeze(Y_c))
plt.contour(xx, yy, probs, levels = [.5])
plt.show()


</pre>
</div>
</div>
</div>
<div id="outline-container-orgbdb3068" class="outline-4">
<h4 id="orgbdb3068">exponen decay with L regularizer(this has error)</h4>
<div class="outline-text-4" id="text-orgbdb3068">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #2aa1ae; background-color: #292e34;">######### </span><span style="color: #2aa1ae; background-color: #292e34;">import opt4_8_generateds</span>
<span style="color: #2aa1ae; background-color: #292e34;">######### </span><span style="color: #2aa1ae; background-color: #292e34;">import opt4_8_forward</span>


<span style="color: #4f97d7; font-weight: bold;">try</span>:
    <span style="color: #4f97d7; font-weight: bold;">import</span> opt4_8_generateds
    <span style="color: #4f97d7; font-weight: bold;">import</span> opt4_8_forward
<span style="color: #4f97d7; font-weight: bold;">except</span>:
    <span style="color: #4f97d7; font-weight: bold;">import</span> pip 
    pip.main([<span style="color: #2d9574;">'install'</span>,<span style="color: #2d9574;">'opt4_8_forward'</span>])
    pip.main([<span style="color: #2d9574;">'install'</span>,<span style="color: #2d9574;">'opt4_8_generateds'</span>])
    <span style="color: #4f97d7; font-weight: bold;">import</span> opt4_8_generateds
    <span style="color: #4f97d7; font-weight: bold;">import</span> opt4_8_forward



<span style="color: #7590db;">STEPS</span> = 40000
<span style="color: #7590db;">BATCH_SIZE</span> = 30
<span style="color: #7590db;">LEARNING_RATE_BASE</span> = 0.001
<span style="color: #7590db;">LEARNING_RATE_DECAY</span> = 0.999
<span style="color: #7590db;">REGULARIZER</span> = 0.01

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">backward</span>():
    <span style="color: #7590db;">x</span> = tf.placeholder(tf.float32, shape = (<span style="color: #a45bad;">None</span>,2))
    <span style="color: #7590db;">y_</span> = tf.placeholder(tf.float32, shape = (<span style="color: #a45bad;">None</span>,1))

    <span style="color: #7590db;">x</span> , <span style="color: #7590db;">Y_</span>, <span style="color: #7590db;">Y_c</span> = opt4_8_generateds.generateds()
    <span style="color: #7590db;">y</span> = opt4_8_forward.forward(x,REGULARIZER)

    <span style="color: #7590db;">global_steps</span> = tf.Variable(0, trainable= <span style="color: #a45bad;">False</span>)
    <span style="color: #7590db;">learning_rate</span> = tf.train.exponential_decay(
        LEARNING_RATE_BASE,
        global_steps,
        300/BATCH_SIZE,
        LEARNING_RATE_DECAY,
        staircase = <span style="color: #a45bad;">True</span>)
    <span style="color: #7590db;">loss_mse</span> = tf.reduce_mean(tf.square(y-y_))
    <span style="color: #7590db;">loss_total</span> = loss_mse + tf.add_n(tf.get_collection(<span style="color: #2d9574;">'losses'</span>))

    <span style="color: #7590db;">train_step</span> = tf.train.AdamOptimizer(learning_rate).minimizer(loss_total)

    <span style="color: #4f97d7; font-weight: bold;">with</span> tf.Session() <span style="color: #4f97d7; font-weight: bold;">as</span> sess:
        <span style="color: #7590db;">init_op</span> = tf.global_variables_initializer()
        sess.run(init_op)
        <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(STEPS):
            <span style="color: #7590db;">start</span> = (i*BATCH_SIZE) % 300
            <span style="color: #7590db;">end</span> = start + BATCH_SIZE
            sess.run(train_step, feed_dict = {x:X[start:end], y_:Y_[start:end]})
            <span style="color: #4f97d7; font-weight: bold;">if</span> i % 2000 == 0:
                <span style="color: #7590db;">loss_v</span> = sess.run(loss_total, feed_dict={x:X,y_:Y_})
                <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'After %d steps, loss is: %f'</span> %(i, loss_v))
        <span style="color: #7590db;">xx</span>, <span style="color: #7590db;">yy</span> = np.mgrid[-3:3:0.01, -3:3:0.01]
        <span style="color: #7590db;">grid</span> = np.c_[xx.ravel(), yy.ravel()]
        <span style="color: #7590db;">probs</span> = sess.run(y, feed_dict={x:grid})
        <span style="color: #7590db;">probs</span> = probs.reshape(xx.shape)

    plt.scatter(X[:,0], X[:,1], c = np.squeeze(Y_c))
    plt.contour(xx, yy, probs, levels = [.5])
    plt.show()

<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">__name__</span> == <span style="color: #2d9574;">'__main__'</span>:
    backward()


</pre>
</div>
</div>
</div>
<div id="outline-container-org82981ca" class="outline-4">
<h4 id="org82981ca">read date for variables</h4>
<div class="outline-text-4" id="text-org82981ca">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">from</span> tensorflow.examples.tutorials.mnist <span style="color: #4f97d7; font-weight: bold;">import</span> input_data
<span style="color: #7590db;">mnist</span> = input_data.read_data_sets(<span style="color: #2d9574;">'./data'</span>, one_hot = <span style="color: #a45bad;">True</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">print(mnist.train.labels[0])</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">print(mnist.train.images[0])</span>

<span style="color: #7590db;">BATCH_SIZE</span> = 200
<span style="color: #7590db;">xs</span>, <span style="color: #7590db;">ys</span> = mnist.train.next_batch(BATCH_SIZE)
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"xs shape :"</span>, xs.shape)
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"ys shape :"</span>, ys.shape)


</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org1061e3d" class="outline-2">
<h2 id="org1061e3d">keras</h2>
<div class="outline-text-2" id="text-org1061e3d">
</div>
<div id="outline-container-org6231cca" class="outline-4">
<h4 id="org6231cca">classification</h4>
<div class="outline-text-4" id="text-org6231cca">
<div class="org-src-container">
<pre class="src src-python">

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">please note, all tutorial code are running under python3.5.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If you use the version like python2.7, please modify the code accordingly</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">5 - Classifier example</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
np.random.seed(1337)  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">for reproducibility</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.datasets <span style="color: #4f97d7; font-weight: bold;">import</span> mnist
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.utils <span style="color: #4f97d7; font-weight: bold;">import</span> np_utils
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.models <span style="color: #4f97d7; font-weight: bold;">import</span> Sequential
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.layers <span style="color: #4f97d7; font-weight: bold;">import</span> Dense, Activation
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.optimizers <span style="color: #4f97d7; font-weight: bold;">import</span> RMSprop

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">download the mnist to the path '~/.keras/datasets/' if it is the first time to be called</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">X shape (60,000 28x28), y shape (10,000, )</span>
(X_train, y_train), (X_test, y_test) = mnist.load_data()

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">data pre-processing</span>
<span style="color: #7590db;">X_train</span> = X_train.reshape(X_train.shape[0], -1) / 255.   <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">normalize</span>
<span style="color: #7590db;">X_test</span> = X_test.reshape(X_test.shape[0], -1) / 255.      <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">normalize</span>
<span style="color: #7590db;">y_train</span> = np_utils.to_categorical(y_train, num_classes=10)
<span style="color: #7590db;">y_test</span> = np_utils.to_categorical(y_test, num_classes=10)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Another way to build your neural net</span>
<span style="color: #7590db;">model</span> = Sequential([
    Dense(32, input_dim=784),
    Activation(<span style="color: #2d9574;">'relu'</span>),
    Dense(10),
    Activation(<span style="color: #2d9574;">'softmax'</span>),
])

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Another way to define your optimizer</span>
<span style="color: #7590db;">rmsprop</span> = RMSprop(lr=0.001, rho=0.9, epsilon=1e-08, decay=0.0)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">We add metrics to get more results you want to see</span>
model.<span style="color: #4f97d7;">compile</span>(optimizer=rmsprop,
              loss=<span style="color: #2d9574;">'categorical_crossentropy'</span>,
              metrics=[<span style="color: #2d9574;">'accuracy'</span>])

<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'Training ------------'</span>)
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Another way to train the model</span>
model.fit(X_train, y_train, epochs=2, batch_size=32)

<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'\nTesting ------------'</span>)
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Evaluate the model with the metrics we defined earlier</span>
<span style="color: #7590db;">loss</span>, <span style="color: #7590db;">accuracy</span> = model.evaluate(X_test, y_test)

<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'test loss: '</span>, loss)
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'test accuracy: '</span>, accuracy)

</pre>
</div>
</div>
</div>
<div id="outline-container-org249ba7b" class="outline-4">
<h4 id="org249ba7b">regression</h4>
<div class="outline-text-4" id="text-org249ba7b">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># please note, all tutorial code are running under python3.5.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># If you use the version like python2.7, please modify the code accordingly</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># 4 - Regressor example</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
np.random.seed(1337)  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">for reproducibility</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.models <span style="color: #4f97d7; font-weight: bold;">import</span> Sequential
<span style="color: #4f97d7; font-weight: bold;">from</span> keras.layers <span style="color: #4f97d7; font-weight: bold;">import</span> Dense
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">create some data</span>
<span style="color: #7590db;">X</span> = np.linspace(-1, 1, 200)
np.random.shuffle(X)    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">randomize the data</span>
<span style="color: #7590db;">Y</span> = 0.5 * X + 2 + np.random.normal(0, 0.05, (200 ))
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">plot data</span>
plt.scatter(X, Y)
plt.show()

<span style="color: #7590db;">X_train</span>, <span style="color: #7590db;">Y_train</span> = X[:160], Y[:160]     <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">first 160 data points</span>
<span style="color: #7590db;">X_test</span>, <span style="color: #7590db;">Y_test</span> = X[160:], Y[160:]       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">last 40 data points</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">build a neural network from the 1st layer to the last layer</span>
<span style="color: #7590db;">model</span> = Sequential()

model.add(Dense(units=1, input_dim=1)) 

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">choose loss function and optimizing method</span>
model.<span style="color: #4f97d7;">compile</span>(loss=<span style="color: #2d9574;">'mse'</span>, optimizer=<span style="color: #2d9574;">'sgd'</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">training</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'Training -----------'</span>)
<span style="color: #4f97d7; font-weight: bold;">for</span> step <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(301):
    <span style="color: #7590db;">cost</span> = model.train_on_batch(X_train, Y_train)
    <span style="color: #4f97d7; font-weight: bold;">if</span> step % 100 == 0:
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'train cost: '</span>, cost)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">test</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'\nTesting ------------'</span>)
<span style="color: #7590db;">cost</span> = model.evaluate(X_test, Y_test, batch_size=40)
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'test cost:'</span>, cost)
<span style="color: #7590db;">W</span>, <span style="color: #7590db;">b</span> = model.layers[0].get_weights()
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">'Weights='</span>, W, <span style="color: #2d9574;">'\nbiases='</span>, b)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">plotting the prediction</span>
<span style="color: #7590db;">Y_pred</span> = model.predict(X_test)
plt.scatter(X_test, Y_test)
plt.plot(X_test, Y_pred)
plt.show()
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8496276" class="outline-2">
<h2 id="org8496276">sklearn</h2>
<div class="outline-text-2" id="text-org8496276">
</div>
<div id="outline-container-orgf0a0fc8" class="outline-4">
<h4 id="orgf0a0fc8">decisiontree</h4>
<div class="outline-text-4" id="text-orgf0a0fc8">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.feature_extraction <span style="color: #4f97d7; font-weight: bold;">import</span> DictVectorizer
<span style="color: #4f97d7; font-weight: bold;">import</span> csv
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> preprocessing
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> tree
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.externals.six <span style="color: #4f97d7; font-weight: bold;">import</span> StringIO
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> pandas <span style="color: #4f97d7; font-weight: bold;">as</span> pd
<span style="color: #4f97d7; font-weight: bold;">from</span> pylab <span style="color: #4f97d7; font-weight: bold;">import</span> *

<span style="color: #7590db;">allElectronicsData</span> = <span style="color: #4f97d7;">open</span>(<span style="color: #2d9574;">"computer.csv"</span>)
<span style="color: #7590db;">reader</span> = csv.reader(allElectronicsData)
<span style="color: #7590db;">headers</span> = <span style="color: #4f97d7;">next</span>(reader)
<span style="color: #4f97d7; font-weight: bold;">print</span>(headers)
<span style="color: #4f97d7; font-weight: bold;">print</span>(reader)

<span style="color: #7590db;">featureList</span> = []
<span style="color: #7590db;">labelList</span> = []
<span style="color: #4f97d7; font-weight: bold;">for</span> row <span style="color: #4f97d7; font-weight: bold;">in</span> reader:
    labelList.append(row[<span style="color: #4f97d7;">len</span>(row)-1])
    <span style="color: #7590db;">rowDict</span> = {}
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(1,<span style="color: #4f97d7;">len</span>(row)-1):
        rowDict[headers[i]] = row[i]
    featureList.append(rowDict)
<span style="color: #4f97d7; font-weight: bold;">print</span>(featureList)

<span style="color: #7590db;">vec</span> = DictVectorizer()
<span style="color: #7590db;">dummyX</span> = vec.fit_transform(featureList).toarray()
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"dummyX: "</span> + <span style="color: #4f97d7;">str</span>(dummyX))
<span style="color: #4f97d7; font-weight: bold;">print</span>(vec.get_feature_names())

<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"labeList"</span> + <span style="color: #4f97d7;">str</span>(labelList))
<span style="color: #7590db;">lb</span> = preprocessing.LabelBinarizer()
<span style="color: #7590db;">dummyY</span> = lb.fit_transform(labelList)
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"dummyY:"</span> + <span style="color: #4f97d7;">str</span>(dummyY))

<span style="color: #7590db;">clf</span> = tree.DecisionTreeClassifier(criterion= <span style="color: #2d9574;">'entropy'</span>)
<span style="color: #7590db;">clf</span> = clf.fit(dummyX,dummyY)
<span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"clf :"</span> + <span style="color: #4f97d7;">str</span>(clf))

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">save as dot</span>
<span style="color: #4f97d7; font-weight: bold;">with</span> <span style="color: #4f97d7;">open</span>(<span style="color: #2d9574;">"output.dot"</span>,<span style="color: #2d9574;">"w"</span>) <span style="color: #4f97d7; font-weight: bold;">as</span> f:
    <span style="color: #7590db;">f</span> = tree.export_graphviz(clf, feature_names= vec.get_feature_names(), out_file = f)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">in terminnal gives the flowwing comands</span>

<span style="color: #2aa1ae; background-color: #292e34;">#    </span><span style="color: #2aa1ae; background-color: #292e34;">dot -Tpdf -O output.dot</span>
<span style="color: #2aa1ae; background-color: #292e34;">#    </span><span style="color: #2aa1ae; background-color: #292e34;">xdg-open output.pdf</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org0e51e60" class="outline-4">
<h4 id="org0e51e60">cross validation 1</h4>
<div class="outline-text-4" id="text-org0e51e60">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.datasets <span style="color: #4f97d7; font-weight: bold;">import</span> load_iris
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.cross_validation <span style="color: #4f97d7; font-weight: bold;">import</span> train_test_split
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.neighbors <span style="color: #4f97d7; font-weight: bold;">import</span> KNeighborsClassifier

<span style="color: #7590db;">iris</span> = load_iris()
<span style="color: #7590db;">X</span> = iris.data
<span style="color: #7590db;">y</span> = iris.target

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">test train split #</span>
<span style="color: #7590db;">X_train</span>, <span style="color: #7590db;">X_test</span>, <span style="color: #7590db;">y_train</span>, <span style="color: #7590db;">y_test</span> = train_test_split(X, y, random_state=4)
<span style="color: #7590db;">knn</span> = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)
<span style="color: #7590db;">y_pred</span> = knn.predict(X_test)
<span style="color: #4f97d7; font-weight: bold;">print</span>(knn.score(X_test, y_test))

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">this is cross_val_score #</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.cross_validation <span style="color: #4f97d7; font-weight: bold;">import</span> cross_val_score
<span style="color: #7590db;">knn</span> = KNeighborsClassifier(n_neighbors=5)
<span style="color: #7590db;">scores</span> = cross_val_score(knn, X, y, cv=5, scoring=<span style="color: #2d9574;">'accuracy'</span>)
<span style="color: #4f97d7; font-weight: bold;">print</span>(scores)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">this is how to use cross_val_score to choose model and configs #</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.cross_validation <span style="color: #4f97d7; font-weight: bold;">import</span> cross_val_score
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #7590db;">k_range</span> = <span style="color: #4f97d7;">range</span>(1, 31)
<span style="color: #7590db;">k_scores</span> = []
<span style="color: #4f97d7; font-weight: bold;">for</span> k <span style="color: #4f97d7; font-weight: bold;">in</span> k_range:
    <span style="color: #7590db;">knn</span> = KNeighborsClassifier(n_neighbors=k)
    <span style="color: #7590db;">loss</span> = -cross_val_score(knn, X, y, cv=10, scoring=<span style="color: #2d9574;">'mean_squared_error'</span>) <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">for regression</span>
<span style="color: #2aa1ae; background-color: #292e34;">##    </span><span style="color: #2aa1ae; background-color: #292e34;">scores = cross_val_score(knn, X, y, cv=10, scoring='accuracy') # for classification</span>
    k_scores.append(loss.mean())

plt.plot(k_range, k_scores)
plt.xlabel(<span style="color: #2d9574;">'Value of K for KNN'</span>)
plt.ylabel(<span style="color: #2d9574;">'Cross-Validated Accuracy'</span>)
plt.show()


</pre>
</div>
</div>
</div>

<div id="outline-container-org9b03926" class="outline-4">
<h4 id="org9b03926">cross validation 2</h4>
<div class="outline-text-4" id="text-org9b03926">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.learning_curve <span style="color: #4f97d7; font-weight: bold;">import</span>  learning_curve
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.datasets <span style="color: #4f97d7; font-weight: bold;">import</span> load_digits
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.svm <span style="color: #4f97d7; font-weight: bold;">import</span> SVC
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np

<span style="color: #7590db;">digits</span> = load_digits()
<span style="color: #7590db;">X</span> = digits.data
<span style="color: #7590db;">y</span> = digits.target
<span style="color: #7590db;">train_sizes</span>, <span style="color: #7590db;">train_loss</span>, <span style="color: #7590db;">test_loss</span>= learning_curve(
        SVC(gamma=0.01), X, y, cv=10, scoring=<span style="color: #2d9574;">'mean_squared_error'</span>,
        train_sizes=[0.1, 0.25, 0.5, 0.75, 1])
<span style="color: #7590db;">train_loss_mean</span> = -np.mean(train_loss, axis=1)
<span style="color: #7590db;">test_loss_mean</span> = -np.mean(test_loss, axis=1)

plt.plot(train_sizes, train_loss_mean, <span style="color: #2d9574;">'o-'</span>, color=<span style="color: #2d9574;">"r"</span>,
             label=<span style="color: #2d9574;">"Training"</span>)
plt.plot(train_sizes, test_loss_mean, <span style="color: #2d9574;">'o-'</span>, color=<span style="color: #2d9574;">"g"</span>,
             label=<span style="color: #2d9574;">"Cross-validation"</span>)

plt.xlabel(<span style="color: #2d9574;">"Training examples"</span>)
plt.ylabel(<span style="color: #2d9574;">"Loss"</span>)
plt.legend(loc=<span style="color: #2d9574;">"best"</span>)
plt.show()


</pre>
</div>
</div>
</div>

<div id="outline-container-org5fe5278" class="outline-4">
<h4 id="org5fe5278">corss validation 3</h4>
<div class="outline-text-4" id="text-org5fe5278">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.learning_curve <span style="color: #4f97d7; font-weight: bold;">import</span>  validation_curve
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.datasets <span style="color: #4f97d7; font-weight: bold;">import</span> load_digits
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.svm <span style="color: #4f97d7; font-weight: bold;">import</span> SVC
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np

<span style="color: #7590db;">digits</span> = load_digits()
<span style="color: #7590db;">X</span> = digits.data
<span style="color: #7590db;">y</span> = digits.target
<span style="color: #7590db;">param_range</span> = np.logspace(-6, -2.3, 5)
<span style="color: #7590db;">train_loss</span>, <span style="color: #7590db;">test_loss</span> = validation_curve(
        SVC(), X, y, param_name=<span style="color: #2d9574;">'gamma'</span>, param_range=param_range, cv=10,
        scoring=<span style="color: #2d9574;">'mean_squared_error'</span>)
<span style="color: #7590db;">train_loss_mean</span> = -np.mean(train_loss, axis=1)
<span style="color: #7590db;">test_loss_mean</span> = -np.mean(test_loss, axis=1)

plt.plot(param_range, train_loss_mean, <span style="color: #2d9574;">'o-'</span>, color=<span style="color: #2d9574;">"r"</span>,
             label=<span style="color: #2d9574;">"Training"</span>)
plt.plot(param_range, test_loss_mean, <span style="color: #2d9574;">'o-'</span>, color=<span style="color: #2d9574;">"g"</span>,
             label=<span style="color: #2d9574;">"Cross-validation"</span>)

plt.xlabel(<span style="color: #2d9574;">"gamma"</span>)
plt.ylabel(<span style="color: #2d9574;">"Loss"</span>)
plt.legend(loc=<span style="color: #2d9574;">"best"</span>)
plt.show()


</pre>
</div>
</div>
</div>
<div id="outline-container-orge67b345" class="outline-4">
<h4 id="orge67b345">data application</h4>
<div class="outline-text-4" id="text-orge67b345">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> datasets
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.linear_model <span style="color: #4f97d7; font-weight: bold;">import</span> LinearRegression
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt

<span style="color: #7590db;">loaded_data</span> = datasets.load_boston()
<span style="color: #7590db;">data_X</span> = loaded_data.data
<span style="color: #7590db;">data_y</span> = loaded_data.target

<span style="color: #7590db;">model</span> = LinearRegression()
model.fit(data_X, data_y)

<span style="color: #4f97d7; font-weight: bold;">print</span>(model.predict(data_X[:4, :]))
<span style="color: #4f97d7; font-weight: bold;">print</span>(data_y[:4])

<span style="color: #7590db;">X</span>, <span style="color: #7590db;">y</span> = datasets.make_regression(n_samples=100, n_features=1, n_targets=1, noise=1)
plt.scatter(X, y)
plt.show()


</pre>
</div>
</div>
</div>
<div id="outline-container-orgd80d682" class="outline-4">
<h4 id="orgd80d682">eigenschaft function</h4>
<div class="outline-text-4" id="text-orgd80d682">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> datasets
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.linear_model <span style="color: #4f97d7; font-weight: bold;">import</span> LinearRegression

<span style="color: #7590db;">loaded_data</span> = datasets.load_boston()
<span style="color: #7590db;">data_X</span> = loaded_data.data
<span style="color: #7590db;">data_y</span> = loaded_data.target

<span style="color: #7590db;">model</span> = LinearRegression()
model.fit(data_X, data_y)

<span style="color: #4f97d7; font-weight: bold;">print</span>(model.predict(data_X[:4, :]))
<span style="color: #4f97d7; font-weight: bold;">print</span>(model.coef_)
<span style="color: #4f97d7; font-weight: bold;">print</span>(model.intercept_)
<span style="color: #4f97d7; font-weight: bold;">print</span>(model.get_params())
<span style="color: #4f97d7; font-weight: bold;">print</span>(model.score(data_X, data_y)) <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">R^2 coefficient of determination</span>


</pre>
</div>
</div>
</div>
<div id="outline-container-orge1f17b0" class="outline-4">
<h4 id="orge1f17b0">iris</h4>
<div class="outline-text-4" id="text-orge1f17b0">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> datasets
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.model_selection <span style="color: #4f97d7; font-weight: bold;">import</span> train_test_split
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.neighbors <span style="color: #4f97d7; font-weight: bold;">import</span> KNeighborsClassifier

<span style="color: #7590db;">iris</span> = datasets.load_iris()
<span style="color: #7590db;">iris_X</span> = iris.data
<span style="color: #7590db;">iris_y</span> = iris.target

<span style="color: #2aa1ae; background-color: #292e34;">##</span><span style="color: #2aa1ae; background-color: #292e34;">print(iris_X[:2, :])</span>
<span style="color: #2aa1ae; background-color: #292e34;">##</span><span style="color: #2aa1ae; background-color: #292e34;">print(iris_y)</span>

<span style="color: #7590db;">X_train</span>, <span style="color: #7590db;">X_test</span>, <span style="color: #7590db;">y_train</span>, <span style="color: #7590db;">y_test</span> = train_test_split(
    iris_X, iris_y, test_size=0.3)

<span style="color: #2aa1ae; background-color: #292e34;">##</span><span style="color: #2aa1ae; background-color: #292e34;">print(y_train)</span>

<span style="color: #7590db;">knn</span> = KNeighborsClassifier()
knn.fit(X_train, y_train)
<span style="color: #4f97d7; font-weight: bold;">print</span>(knn.predict(X_test))
<span style="color: #4f97d7; font-weight: bold;">print</span>(y_test)


</pre>
</div>
</div>
</div>
<div id="outline-container-org6be5985" class="outline-4">
<h4 id="org6be5985">normnalization</h4>
<div class="outline-text-4" id="text-org6be5985">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python learning tutorial on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> preprocessing
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.model_selection <span style="color: #4f97d7; font-weight: bold;">import</span> train_test_split
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.datasets.samples_generator <span style="color: #4f97d7; font-weight: bold;">import</span> make_classification
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.svm <span style="color: #4f97d7; font-weight: bold;">import</span> SVC
<span style="color: #4f97d7; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #4f97d7; font-weight: bold;">as</span> plt

<span style="color: #7590db;">a</span> = np.array([[10, 2.7, 3.6],
                     [-100, 5, -2],
                     [120, 20, 40]], dtype=np.float64)
<span style="color: #4f97d7; font-weight: bold;">print</span>(a)
<span style="color: #4f97d7; font-weight: bold;">print</span>(preprocessing.scale(a))

<span style="color: #7590db;">X</span>, <span style="color: #7590db;">y</span> = make_classification(n_samples=300, n_features=2 , n_redundant=0, n_informative=2, random_state=22, n_clusters_per_class=1, scale=100)
plt.scatter(X[:, 0], X[:, 1], c=y)
plt.show()
<span style="color: #7590db;">X</span> = preprocessing.scale(X)    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">normalization step</span>
<span style="color: #7590db;">X_train</span>, <span style="color: #7590db;">X_test</span>, <span style="color: #7590db;">y_train</span>, <span style="color: #7590db;">y_test</span> = train_test_split(X, y, test_size=.3)
<span style="color: #7590db;">clf</span> = SVC()
clf.fit(X_train, y_train)
<span style="color: #4f97d7; font-weight: bold;">print</span>(clf.score(X_test, y_test))


</pre>
</div>
</div>
</div>
<div id="outline-container-orgf700e77" class="outline-4">
<h4 id="orgf700e77">save load</h4>
<div class="outline-text-4" id="text-orgf700e77">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python tutorials on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">Please note, this code is only for python 3+. If you are using python 2+, please modify the code accordingly.</span>
<span style="color: #9f8766;">"""</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> __future__ <span style="color: #4f97d7; font-weight: bold;">import</span> print_function
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> svm
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn <span style="color: #4f97d7; font-weight: bold;">import</span> datasets

<span style="color: #7590db;">clf</span> = svm.SVC()
<span style="color: #7590db;">iris</span> = datasets.load_iris()
<span style="color: #7590db;">X</span>, <span style="color: #7590db;">y</span> = iris.data, iris.target
clf.fit(X, y)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># method 1: pickle</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">import pickle</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># save</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">with open('save/clf.pickle', 'wb') as f:</span>
<span style="color: #2aa1ae; background-color: #292e34;">#     </span><span style="color: #2aa1ae; background-color: #292e34;">pickle.dump(clf, f)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># restore</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">with open('save/clf.pickle', 'rb') as f:</span>
<span style="color: #2aa1ae; background-color: #292e34;">#    </span><span style="color: #2aa1ae; background-color: #292e34;">clf2 = pickle.load(f)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#    </span><span style="color: #2aa1ae; background-color: #292e34;">print(clf2.predict(X[0:1]))</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">method 2: joblib</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> sklearn.externals <span style="color: #4f97d7; font-weight: bold;">import</span> joblib
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Save</span>
joblib.dump(clf, <span style="color: #2d9574;">'save/clf.pkl'</span>)
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">restore</span>
<span style="color: #7590db;">clf3</span> = joblib.load(<span style="color: #2d9574;">'save/clf.pkl'</span>)
<span style="color: #4f97d7; font-weight: bold;">print</span>(clf3.predict(X[0:1]))


</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9c62a5e" class="outline-2">
<h2 id="org9c62a5e">theano</h2>
<div class="outline-text-2" id="text-org9c62a5e">
</div>
<div id="outline-container-orgdac2a39" class="outline-4">
<h4 id="orgdac2a39">basic</h4>
<div class="outline-text-4" id="text-orgdac2a39">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">View more python tutorials on my Youtube and Youku channel!!!</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youtube video tutorial: https://www.youtube.com/channel/UCdyjiB5H8Pu7aDTNVXTTpcg</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Youku video tutorial: http://i.youku.com/pythontutorial</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4 - basic usage</span>
<span style="color: #2aa1ae; background-color: #292e34;">#   </span><span style="color: #2aa1ae; background-color: #292e34;">from __future__ import print_function</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np
<span style="color: #4f97d7; font-weight: bold;">import</span> theano.tensor <span style="color: #4f97d7; font-weight: bold;">as</span> T
<span style="color: #4f97d7; font-weight: bold;">from</span> theano <span style="color: #4f97d7; font-weight: bold;">import</span> function

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">basic</span>
<span style="color: #7590db;">x</span> = T.dscalar(<span style="color: #2d9574;">'x'</span>)
<span style="color: #7590db;">y</span> = T.dscalar(<span style="color: #2d9574;">'y'</span>)
<span style="color: #7590db;">z</span> = x+y     <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">define the actual function in here</span>
<span style="color: #7590db;">f</span> = function([x, y], z)  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the inputs are in [], and the output in the "z"</span>

<span style="color: #4f97d7; font-weight: bold;">print</span>(f(2,3))  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">only give the inputs "x and y" for this function, then it will calculate the output "z"</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># to pretty-print the function</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> theano <span style="color: #4f97d7; font-weight: bold;">import</span> pp
<span style="color: #4f97d7; font-weight: bold;">print</span>(pp(z))

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;"># how about matrix</span>
<span style="color: #7590db;">x</span> = T.dmatrix(<span style="color: #2d9574;">'x'</span>)
<span style="color: #7590db;">y</span> = T.dmatrix(<span style="color: #2d9574;">'y'</span>)
<span style="color: #7590db;">z</span> = x + y
<span style="color: #7590db;">f</span> = function([x, y], z)
<span style="color: #4f97d7; font-weight: bold;">print</span>(f(np.arange(12).reshape((3,4)), 10*np.ones((3,4))))


</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-orgad42593" class="outline-2">
<h2 id="orgad42593">Backlinks</h2>
</div>


<div id="outline-container-org901d760" class="outline-2">
<h2 id="org901d760">1 Backlinks</h2>
<div class="outline-text-2" id="text-org901d760">
</div>
<div id="outline-container-org9b1896a" class="outline-3">
<h3 id="org9b1896a"><a href="file:///home/sx/Dropbox/subjects/AI.html">AI</a></h3>
<div class="outline-text-3" id="text-org9b1896a">
<p>
<a href="file:///home/sx/Dropbox/Projects/tensorflow/tf1.html">tf1</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: sx</p>
<p class="date">Created: 2020-05-23 Sa 12:00</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>

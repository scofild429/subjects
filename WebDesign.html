<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-02-12 Fr 22:52 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Webdesige</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="silin" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/bigblow_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/bigblow_theme/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/bigblow_theme/css/hideshow.css"/>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/bigblow.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/hideshow.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Webdesige</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgbd2d47b">config</a>
<ul>
<li><a href="#org1e35db0">Factory mode</a>
<ul>
<li><a href="#org609b7b4">one product one factory many many design</a></li>
<li><a href="#org6238781">one product many factory many design</a></li>
<li><a href="#org8b84c54">many  product many factory many design</a></li>
</ul>
</li>
<li><a href="#org8169c81">project build digraph</a></li>
<li><a href="#org5e25d3e">WordPress Web development in AWS</a>
<ul>
<li><a href="#orgbded9a2">构建后台</a></li>
<li><a href="#org6ba493d">解析域名</a></li>
<li><a href="#org65b1998">ssl</a></li>
<li><a href="#orga8eab09">scp</a></li>
<li><a href="#org7af2f77">external html</a></li>
</ul>
</li>
<li><a href="#org7bbd688">Web Design Envirement in Emacs</a>
<ul>
<li><a href="#org7d6474b">lsp-mode</a></li>
<li><a href="#org7404296">lsp-java</a></li>
<li><a href="#orgcf6752f">dap-mode</a></li>
<li><a href="#org74833d0">Spring Boot</a></li>
<li><a href="#org4996504">project build digraph</a></li>
<li><a href="#org4edd6e6">appeared Problem</a></li>
</ul>
</li>
<li><a href="#org2bc1b27">redis</a></li>
<li><a href="#orgf8f349f">MySQL</a>
<ul>
<li><a href="#orgcdd6309">事务隔离</a></li>
<li><a href="#orgdc05a14">single java file connect to mysql</a></li>
<li><a href="#org10f3cbf">mvn project connect to mysql</a></li>
<li><a href="#orgcd2e5d5">springboot</a></li>
<li><a href="#org1b7ce0f">事务 Transaction</a></li>
<li><a href="#org4305b7e">范式</a></li>
<li><a href="#orgee09a49">连接池</a></li>
<li><a href="#org542be1a">外键</a></li>
<li><a href="#orgb24714b">多表</a></li>
<li><a href="#org0f2d2b4">single java file connect to mysql</a></li>
<li><a href="#orgc1e8756">execute in emacs</a></li>
</ul>
</li>
<li><a href="#org5d0014c">MongoDB</a>
<ul>
<li><a href="#orgb041143">open the mongodb service</a></li>
<li><a href="#org0f918b2">create database, collections, and drops</a></li>
<li><a href="#org3df984d">create database, collections, and documents</a></li>
<li><a href="#org1f682b2">backup and restore</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf4011f4">frontend</a>
<ul>
<li><a href="#org7d3c7d3">JS</a></li>
<li><a href="#org8ccafd9">ts</a></li>
<li><a href="#orgfda3064">Vue</a>
<ul>
<li><a href="#orgaa91f9e">Mustache</a></li>
<li><a href="#org5c9b365">v-bind</a></li>
<li><a href="#org8dca984">v-show</a></li>
<li><a href="#org643bf2f">v-if</a></li>
</ul>
</li>
<li><a href="#org748ad99">webpack</a></li>
<li><a href="#org0f0faa9">JQary</a>
<ul>
<li><a href="#orgddf36ba">JQuery选择器</a></li>
<li><a href="#org0b6b6b6">CSS 选择器</a></li>
<li><a href="#org59888ff">operation function</a></li>
</ul>
</li>
<li><a href="#org043db0d">AJAX</a></li>
<li><a href="#org813ef5f">Vue</a></li>
<li><a href="#org43142ce">Servlet</a></li>
<li><a href="#org910ee67">Bootstrap</a></li>
</ul>
</li>
<li><a href="#orga57c17d">backend</a>
<ul>
<li><a href="#org27fba53">Spring</a>
<ul>
<li><a href="#org8f35540">sammelung:</a></li>
<li><a href="#org02cd14d">Annotation mehthod</a></li>
<li><a href="#orgd09012d">xml mehthod</a></li>
<li><a href="#org48af75f">bean method</a></li>
<li><a href="#orgfeed42f">advancd mehthod</a></li>
<li><a href="#orgbbe7e4a">log4j</a></li>
<li><a href="#org64996c9">Test</a></li>
<li><a href="#org79aad1e">AOP</a></li>
<li><a href="#orgd6c0444">JDBC</a></li>
</ul>
</li>
<li><a href="#org541184f">SpingMVC</a></li>
<li><a href="#org0ef7d46">Spring Boot</a>
<ul>
<li><a href="#一spring-boot-入门">一、Spring Boot 入门</a></li>
<li><a href="#二配置文件">二、配置文件</a></li>
<li><a href="#三日志">三、日志</a></li>
<li><a href="#四web开发">四、Web开发</a></li>
<li><a href="#五docker">五、Docker</a></li>
<li><a href="#六springboot与数据访问">六、SpringBoot与数据访问</a></li>
<li><a href="#七启动配置原理">七、启动配置原理</a></li>
<li><a href="#八自定义starter">八、自定义starter</a></li>
<li><a href="#更多springboot整合示例">更多SpringBoot整合示例</a></li>
</ul>
</li>
<li><a href="#org9218e7c">JDBC</a></li>
<li><a href="#org8680c66">mybatis</a>
<ul>
<li><a href="#org65c30eb">framework</a></li>
<li><a href="#org4620e0b">流程</a></li>
<li><a href="#org569f6ce">延迟加载</a></li>
<li><a href="#orgbc204dc">缓存</a></li>
<li><a href="#orgc828e69">一级缓存</a></li>
<li><a href="#orge1e6972">二级缓存</a></li>
<li><a href="#orgeff2912">注解开发</a></li>
</ul>
</li>
<li><a href="#org72da14f">Shiro</a></li>
<li><a href="#org66f9e68">c3p0</a></li>
<li><a href="#orgcc9004d">Rruid</a></li>
</ul>
</li>
<li><a href="#org2f361bc">deployment</a>
<ul>
<li><a href="#org516fa99">nginx</a>
<ul>
<li><a href="#orge460237">local Nginx deployment</a></li>
<li><a href="#org6b85efa">Nginx with php</a></li>
</ul>
</li>
<li><a href="#orga2a588f">Docker envirement deployment</a></li>
<li><a href="#org78421a0">apache2</a></li>
<li><a href="#orgd52bea0">Maven</a>
<ul>
<li><a href="#orgcf85361">package all the dependencies together as a jar</a></li>
<li><a href="#orgcd20b0d">customize locally archetype</a></li>
</ul>
</li>
<li><a href="#orgff4da32">Session und Cookie</a></li>
<li><a href="#org65aeb52">HTTP Proposal</a>
<ul>
<li><a href="#orge9910fe">http Request</a></li>
<li><a href="#org0277da8">Http Response</a></li>
</ul>
</li>
<li><a href="#org696ff49">appeared Problem</a>
<ul>
<li><a href="#org4596522">server is not startup</a></li>
<li><a href="#orga0897da">can't find the main class to start project</a></li>
<li><a href="#org35fb6d7">没有对应的补全</a></li>
</ul>
</li>
<li><a href="#orgf3600f3">local jdk configuration</a></li>
</ul>
</li>
<li><a href="#orgdac195b">RuoYi-Vue project</a>
<ul>
<li><a href="#org5e0a2a2">backup deployment</a>
<ul>
<li><a href="#orgcdd491c">redis</a></li>
<li><a href="#org06db92d">mysql</a></li>
<li><a href="#org0a73b47">tomcat</a></li>
<li><a href="#orgf7d994d">schnitt</a></li>
<li><a href="#org0efc363">ssh</a></li>
<li><a href="#orgc801db7">dependence from jdk8</a></li>
</ul>
</li>
<li><a href="#org5306003">frontend deployment</a>
<ul>
<li><a href="#orgbd76db3">build</a></li>
<li><a href="#org604019c">验证码 for nginx</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgbd2d47b" class="outline-2">
<h2 id="orgbd2d47b">config</h2>
<div class="outline-text-2" id="text-orgbd2d47b">
</div>
<div id="outline-container-org1e35db0" class="outline-3">
<h3 id="org1e35db0">Factory mode</h3>
<div class="outline-text-3" id="text-org1e35db0">
</div>
<div id="outline-container-org609b7b4" class="outline-4">
<h4 id="org609b7b4">one product one factory many many design</h4>
<div class="outline-text-4" id="text-org609b7b4">
<p>
一个产品，在一个工厂里有多个设计实现
</p>
</div>
</div>

<div id="outline-container-org6238781" class="outline-4">
<h4 id="org6238781">one product many factory many design</h4>
<div class="outline-text-4" id="text-org6238781">
<p>
一个产品，在多个各自的工厂里，有自己特有的设计实现
</p>
</div>
</div>

<div id="outline-container-org8b84c54" class="outline-4">
<h4 id="org8b84c54">many  product many factory many design</h4>
<div class="outline-text-4" id="text-org8b84c54">
<p>
对于多个产品，在多个各自的工厂里，有自己特有的对每个产品的设计实现
</p>
</div>
</div>
</div>
<div id="outline-container-org8169c81" class="outline-3">
<h3 id="org8169c81">project build digraph</h3>
<div class="outline-text-3" id="text-org8169c81">

<div class="figure">
<p><img src="foto/webbuildmitemacs.png" alt="webbuildmitemacs.png" />
</p>
</div>


<pre class="example">
1 add the to the above SRC begin:  dot :file ../sysconf/foto/webbuild.png
2 delete the output :  [[file:../sysconf/foto/webbuild.png]]
3 push the sysc repository, because the foto is located in it
4 add the link from sysc repository  https://github.com/scofild429/sysc/blob/master/foto/webbuild.png
</pre>
</div>
</div>

<div id="outline-container-org5e25d3e" class="outline-3">
<h3 id="org5e25d3e">WordPress Web development in AWS</h3>
<div class="outline-text-3" id="text-org5e25d3e">
</div>
<div id="outline-container-orgbded9a2" class="outline-4">
<h4 id="orgbded9a2">构建后台</h4>
<div class="outline-text-4" id="text-orgbded9a2">
<p>
没事不要执行该代码
</p>
<pre class="example">
cd ~/Documents/web/key_aws
ssh ubuntu@3.124.205.43 -i pass1aws.pem
sudo apt update -y
sudo apt upgrade -y
sudo apt install apache2
sudo systemctl status apache2
sudo systemctl enable apache2
sudo apt install mariadb-server mariadb-client
sudo systemctl start mariadb
sudo systemctl status mariadb
sudo mysql_secure_installation ...
sudo systemctl restart mariadb
sudo apt install php php-mysql php-gd php-cli php-common
sudo apt install wget unzip
sudo wget https://wordpress.org/latest.zip
sudo unzip latest.zip
sudo cp -r wordpress/* /var/www/html/
cd /var/www/html/
sudo chown www-data:www-data -R /var/www/html/
sudo rm index.html 
## Now go to the IP webseit, when need database, do so
sudo mysql -u root -p
Enter
##  create database wordpress;
create database wordpress;
create user "wpadmin"@"%" identified by "wpadminpw";
grant all privileges on wordpress.* to "wpadmin"@"%";
exit;
</pre>
<p>
back to the IP webseit,
pass the database , username and password,
set username and password for wordpress,
到此，可以用IP 地址访问前端和后台了
</p>
</div>
</div>

<div id="outline-container-org6ba493d" class="outline-4">
<h4 id="org6ba493d">解析域名</h4>
<div class="outline-text-4" id="text-org6ba493d">
<p>
route53, 用域名创建NS
A-IPV4,名称为空， 值为IP
CNAME，名称www, 值为域名
再将A 和CNAME 放到namecheap的域名的DNS管理中
</p>
</div>
</div>

<div id="outline-container-org65b1998" class="outline-4">
<h4 id="org65b1998">ssl</h4>
<div class="outline-text-4" id="text-org65b1998">
<pre class="example">
sudo a2enmod ssl
sudo systemctl restart apache2
cd ~
wget https://dl.eff.org/certbot-auto
chmod a+x certbot-auto
sudo ./certbot-auto --apache....
</pre>
<p>
go to <a href="https://www.sslshopper.com/ssl-checker.html">https://www.sslshopper.com/ssl-checker.html</a> and check you domina
</p>
</div>
</div>

<div id="outline-container-orga8eab09" class="outline-4">
<h4 id="orga8eab09">scp</h4>
<div class="outline-text-4" id="text-orga8eab09">
<p>
transfer file to linux instance of CE2
</p>
<pre class="example">
scp -i pass1aws.pem init.el ubuntu@3.124.205.43:.emacs.d
</pre>
</div>
</div>

<div id="outline-container-org7af2f77" class="outline-4">
<h4 id="org7af2f77">external html</h4>
<div class="outline-text-4" id="text-org7af2f77">
<ul class="org-ul">
<li>将文件传到部署根目录</li>
<li>复制文件xxx.html 为page-xxx.php到应用主题根目录</li>
<li>创建页面，先只写标题，保存后改别名，slug 为xxx</li>
<li>发布后，将页面设为菜单就能访问</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org7bbd688" class="outline-3">
<h3 id="org7bbd688">Web Design Envirement in Emacs</h3>
<div class="outline-text-3" id="text-org7bbd688">
</div>
<div id="outline-container-org7d6474b" class="outline-4">
<h4 id="org7d6474b">lsp-mode</h4>
</div>
<div id="outline-container-org7404296" class="outline-4">
<h4 id="org7404296">lsp-java</h4>
</div>
<div id="outline-container-orgcf6752f" class="outline-4">
<h4 id="orgcf6752f">dap-mode</h4>
</div>
<div id="outline-container-org74833d0" class="outline-4">
<h4 id="org74833d0">Spring Boot</h4>
<div class="outline-text-4" id="text-org74833d0">
<p>
Emacs : M-x lsp-java-springboot-generate
after build the project, it can be compiled by Maven,and run
</p>
</div>
</div>

<div id="outline-container-org4996504" class="outline-4">
<h4 id="org4996504">project build digraph</h4>
<div class="outline-text-4" id="text-org4996504">
<pre class="example">
digraph diagramm {
	Emacs  [shape=box,color=red]
	LspJavaSpringInitizer [shape=box,color=red]
	Config [shape=box,color=red]
	dapDebug [shape=box,color=red]
	Programmierung [shape=box,color=red]
	Terminal -&gt;  Maven建包;
	Maven建包 -&gt; Maven加依赖pom;
	Maven加依赖pom -&gt; OpenEmacsFile;
	OpenEmacsFile -&gt;   Programmierung;
	Programmierung -&gt; MavenCompile;
	MavenCompile -&gt; MavenPackage;
	MavenCompile -&gt; dapDebug[label = "也可./mvnx"];
	MavenPackage -&gt; 执行jar包;
	MavenPackage -&gt; dapDebug;
	执行jar包 -&gt; dapDebug;
	Emacs -&gt; LspJavaSpringInitizer;
	LspJavaSpringInitizer -&gt; Config;
	Config -&gt; Programmierung;
	Programmierung -&gt; dapDebug;
	dapDebug -&gt; Webbroser;
}
</pre>

<pre class="example">
1 add the to the above SRC begin:  dot :file ../sysconf/foto/webbuild.png
2 delete the output :  [[file:../sysconf/foto/webbuild.png]]
3 push the sysc repository, because the foto is located in it
4 add the link from sysc repository  https://github.com/scofild429/sysc/blob/master/foto/webbuild.png
</pre>

<p>
<a href="https://github.com/scofild429/sysc/blob/master/foto/webbuild.png">webbuild.png</a>
</p>
</div>
</div>

<div id="outline-container-org4edd6e6" class="outline-4">
<h4 id="org4edd6e6">appeared Problem</h4>
<div class="outline-text-4" id="text-org4edd6e6">
</div>
<ul class="org-ul">
<li><a id="orga5d1c58"></a>server is not startup<br />
<div class="outline-text-5" id="text-orga5d1c58">
<p>
1, workspace 有重叠和包含，
2, 需要重启 lsp mode
</p>
</div>
</li>

<li><a id="org0fef1a4"></a>can't find the main class to start project<br />
<div class="outline-text-5" id="text-org0fef1a4">
<p>
mvn compile 出现问题，大多数时候是依赖的问题
</p>
</div>
</li>

<li><a id="org5c67d2a"></a>没有对应的补全<br />
<div class="outline-text-5" id="text-org5c67d2a">
<p>
mvn 依赖的version 不同会有不同的包，补全也不同
</p>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org2bc1b27" class="outline-3">
<h3 id="org2bc1b27">redis</h3>
<div class="outline-text-3" id="text-org2bc1b27">
<ol class="org-ol">
<li>without password : redis-cli</li>
<li>with password    : redis-cli -h localhost -p 6379 -a 123456</li>
</ol>
<p>
PING -&gt; PONG
</p>
</div>
</div>

<div id="outline-container-orgf8f349f" class="outline-3">
<h3 id="orgf8f349f">MySQL</h3>
<div class="outline-text-3" id="text-orgf8f349f">
</div>
<div id="outline-container-orgcdd6309" class="outline-4">
<h4 id="orgcdd6309">事务隔离</h4>
<div class="outline-text-4" id="text-orgcdd6309">
<p>
1 可同时访问修改   脏读
2 隔离访问        不可重返读
3 单人访问        幻读
</p>
</div>
</div>

<div id="outline-container-orgdc05a14" class="outline-4">
<h4 id="orgdc05a14">single java file connect to mysql</h4>
<div class="outline-text-4" id="text-orgdc05a14">
<p>
1.download the driver to a current to java file
</p>

<p>
<a href="https://jar-download.com/artifacts/mysql/mysql-connector-java">official web</a>, and in my case 
</p>

<p>
mysql-connector-java-8.0.20.jar
</p>

<p>
2.add the current path to the CLASSPATH
</p>

<p>
export CLASSPATH=mysql-connector-java-8.0.20.jar:.
</p>

<p>
3.compile and connect
</p>
</div>
</div>

<div id="outline-container-org10f3cbf" class="outline-4">
<h4 id="org10f3cbf">mvn project connect to mysql</h4>
<div class="outline-text-4" id="text-org10f3cbf">
</div>
<ul class="org-ul">
<li><a id="org22ea4b2"></a>execute in emacs<br />
<div class="outline-text-5" id="text-org22ea4b2">
<ol class="org-ol">
<li>create mvn project</li>
<li>find the plugin of mysql and add it to pom.xml</li>
<li>programmierung</li>
<li>the connection can be call in the dabug of emacs</li>
</ol>
<p>
M-x :dap-debug
</p>
</div>
</li>

<li><a id="org3954316"></a>execute as a jar file<br />
<div class="outline-text-5" id="text-org3954316">
<p>
if I want to package them to a package to a jar
<a href="https://stackoverflow.com/questions/574594/how-can-i-create-an-executable-jar-with-dependencies-using-maven">starkoverflow hitting</a>
and this plugin to pom.xml
</p>
<pre class="example">
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
	&lt;archive&gt;
	  &lt;manifest&gt;
	    &lt;mainClass&gt;fully.qualified.MainClass&lt;/mainClass&gt;
	  &lt;/manifest&gt;
	&lt;/archive&gt;
	&lt;descriptorRefs&gt;
	  &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;
	&lt;/descriptorRefs&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
</pre>
<p>
and run with : mvn clean compile assembly:single
</p>

<p>
and then mvn package
</p>

<p>
can be called by jar file
</p>

<p>
java -cp target/xxxx&#x2026;.xx.jar com.mycompany.app.App 
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgcd2e5d5" class="outline-4">
<h4 id="orgcd2e5d5">springboot</h4>
<div class="outline-text-4" id="text-orgcd2e5d5">
<p>
just call the plugins at the start
</p>
</div>
</div>

<div id="outline-container-org1b7ce0f" class="outline-4">
<h4 id="org1b7ce0f">事务 Transaction</h4>
<div class="outline-text-4" id="text-org1b7ce0f">
<pre class="example">

声明式：Annoation
1, 配置事务管理器
2, 开启事务注解
3, 添加事务注解
@Transaction(propagation, isolation, timeout, readout, (no)rollback)
propagation;事务是否传播
isolation:
脏读：未提交的事务读取到另一个未提交的事务的原始数据
不可重复读；未提交的事务读取到另一个提交的事务的原始数据
幻读；未提交的事务读取到另一个提交的事务的修改数据
</pre>
</div>
</div>

<div id="outline-container-org4305b7e" class="outline-4">
<h4 id="org4305b7e">范式</h4>
<div class="outline-text-4" id="text-org4305b7e">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">原子性</td>
<td class="org-left">一致性</td>
<td class="org-left">隔离性</td>
<td class="org-left">持久性</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgee09a49" class="outline-4">
<h4 id="orgee09a49">连接池</h4>
</div>
<div id="outline-container-org542be1a" class="outline-4">
<h4 id="org542be1a">外键</h4>
</div>
<div id="outline-container-orgb24714b" class="outline-4">
<h4 id="orgb24714b">多表</h4>
</div>
<div id="outline-container-org0f2d2b4" class="outline-4">
<h4 id="org0f2d2b4">single java file connect to mysql</h4>
<div class="outline-text-4" id="text-org0f2d2b4">
<ol class="org-ol">
<li>download the driver to a current to java file ,<a href="https://jar-download.com/artifacts/mysql/mysql-connector-java">official web</a>, and in my case 

<ul class="org-ul">
<li>mysql-connector-java-8.0.20.jar</li>
</ul></li>

<li>add the current path to the CLASSPATH

<ul class="org-ul">
<li>export CLASSPATH=mysql-connector-java-8.0.20.jar:.</li>
</ul></li>

<li>compile and connect</li>
</ol>
</div>
</div>

<div id="outline-container-orgc1e8756" class="outline-4">
<h4 id="orgc1e8756">execute in emacs</h4>
<div class="outline-text-4" id="text-orgc1e8756">
<ol class="org-ol">
<li>create mvn project</li>
<li>find the plugin of mysql and add it to pom.xml</li>
<li>programmierung</li>
<li>the connection can be call in the dabug of emacs</li>
</ol>
<p>
M-x :dap-debug
</p>
</div>
</div>
</div>

<div id="outline-container-org5d0014c" class="outline-3">
<h3 id="org5d0014c">MongoDB</h3>
<div class="outline-text-3" id="text-org5d0014c">
</div>
<div id="outline-container-orgb041143" class="outline-4">
<h4 id="orgb041143">open the mongodb service</h4>
<div class="outline-text-4" id="text-orgb041143">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">commonds</th>
<th scope="col" class="org-left">functions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">or</td>
<td class="org-left">$inc</td>
</tr>

<tr>
<td class="org-left">in</td>
<td class="org-left">$mul</td>
</tr>

<tr>
<td class="org-left">exist</td>
<td class="org-left">$rename</td>
</tr>

<tr>
<td class="org-left">gl</td>
<td class="org-left">$set</td>
</tr>

<tr>
<td class="org-left">sort</td>
<td class="org-left">$unset</td>
</tr>

<tr>
<td class="org-left">limit</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">skip</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><i>x</i></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><i>^x</i></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">upsert</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">rename</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">getIndexs</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">createIndex</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">dropIndex</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>


<div class="org-src-container">
<pre class="src src-sh">sudo systemctl start mongod
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f918b2" class="outline-4">
<h4 id="org0f918b2">create database, collections, and drops</h4>
<div class="outline-text-4" id="text-org0f918b2">
<p>
:admin  at the first step, we must login into one  database
</p>

<div class="org-src-container">
<pre class="src src-mongo">show dbs;
use xiaoma;
db.createCollection("posts");
show collections;
db.posts.drop();
db.dropDatabase();
</pre>
</div>
</div>
</div>

<div id="outline-container-org3df984d" class="outline-4">
<h4 id="org3df984d">create database, collections, and documents</h4>
<div class="outline-text-4" id="text-org3df984d">
<div class="org-src-container">
<pre class="src src-mongo">use xiaoma;
db.createCollection("posts");
show collections;

db.posts.insert({ 
    title: "my first blog",
    content: "can be start"
});
db.posts.insert({ 
    title: "my second blog",
    content: "can be start now",
    tag: ["unknow type"]
});

for(var i = 3;i&lt;=10;i++){
    db.posts.insert( {title :"this is my "+i+"th blog"});
};
db.posts.find();
db.posts.count();
db.posts.remove({});
db.posts.drop();
db.dropDatabase();
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f682b2" class="outline-4">
<h4 id="org1f682b2">backup and restore</h4>
<div class="outline-text-4" id="text-org1f682b2">
<p>
mongo xiaoma  : can just get in xiaoma database
</p>
</div>
<ul class="org-ul">
<li><a id="orga0a7387"></a>01, create documents<br />
<div class="outline-text-5" id="text-orga0a7387">
<div class="org-src-container">
<pre class="src src-mongo">use xiaoma;
db.createCollection("posts");
show collections;

db.posts.insert({ 
    title: "my first blog",
    content: "can be start"
});
db.posts.insert({ 
    title: "my second blog",
    content: "can be start now",
    tag: ["unknow type"]
});

for(var i = 3;i&lt;=10;i++){
    db.posts.insert( {title :"this is my "+i+"th blog"});
};

db.posts.find();
db.posts.count();

</pre>
</div>
</div>
</li>

<li><a id="org8f80341"></a>02, dump<br />
<div class="outline-text-5" id="text-org8f80341">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #4f97d7;">cd</span> ~/Desktop/
mkdir mongobk
<span style="color: #4f97d7;">cd</span> mongobk
mongodump -d xiaoma

</pre>
</div>
</div>
</li>


<li><a id="org8665747"></a>03, delete documents<br />
<div class="outline-text-5" id="text-org8665747">
<div class="org-src-container">
<pre class="src src-mongo">use xiaoma;
db.posts.remove({});
db.posts.find();
exit;
</pre>
</div>
</div>
</li>


<li><a id="org67fa664"></a>04, restore<br />
<div class="outline-text-5" id="text-org67fa664">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #4f97d7;">cd</span> ~/Desktop/mongobk
mongorestore --drop
</pre>
</div>
</div>
</li>

<li><a id="org016a6a5"></a>05, check<br />
<div class="outline-text-5" id="text-org016a6a5">
<div class="org-src-container">
<pre class="src src-mongo">use xiaoma;
db.posts.find();
db.posts.drop();
db.dropDatabase();
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgf4011f4" class="outline-2">
<h2 id="orgf4011f4">frontend</h2>
<div class="outline-text-2" id="text-orgf4011f4">
</div>
<div id="outline-container-org7d3c7d3" class="outline-3">
<h3 id="org7d3c7d3">JS</h3>
<div class="outline-text-3" id="text-org7d3c7d3">
<p>
some ES6 has to be connected <a href="JS.html">JS</a> to here, 
</p>
</div>
</div>

<div id="outline-container-org8ccafd9" class="outline-3">
<h3 id="org8ccafd9">ts</h3>
</div>
<div id="outline-container-orgfda3064" class="outline-3">
<h3 id="orgfda3064">Vue</h3>
<div class="outline-text-3" id="text-orgfda3064">
</div>
<div id="outline-container-orgaa91f9e" class="outline-4">
<h4 id="orgaa91f9e">Mustache</h4>
<div class="outline-text-4" id="text-orgaa91f9e">
<p>
{{item }} item von el can be here
</p>
</div>
</div>

<div id="outline-container-org5c9b365" class="outline-4">
<h4 id="org5c9b365">v-bind</h4>
<div class="outline-text-4" id="text-org5c9b365">
<p>
v-bind: kann verbunden werden mit
id, href, key, für characters von DOM elements
</p>
</div>
</div>

<div id="outline-container-org8dca984" class="outline-4">
<h4 id="org8dca984">v-show</h4>
<div class="outline-text-4" id="text-org8dca984">
<p>
if v-show is false, the DOM element is already included, but will not be presented.
</p>
</div>
</div>

<div id="outline-container-org643bf2f" class="outline-4">
<h4 id="org643bf2f">v-if</h4>
<div class="outline-text-4" id="text-org643bf2f">
<p>
if v-if is false, the DOM element will be deleted
</p>
</div>
</div>
</div>

<div id="outline-container-org748ad99" class="outline-3">
<h3 id="org748ad99">webpack</h3>
<div class="outline-text-3" id="text-org748ad99">
<pre class="example">
npm init -y
npm i -D webpack webpack-cli typescript ts-loader

设定生成的html的特性，包括使用模板
npm i -D html-webpack-plugin

设定项目的运行服务器
npm i -D webpack-dev-server
in package.json/"scripts":      "start": "webpack serve --open chromium-browser"
and then in terminal: npm start


删除上次的生成文件，整个dist目录
npm i -D clean-webpack-plugin




</pre>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">const</span> <span style="color: #7590db;">path</span> = require(<span style="color: #2d9574;">"path"</span>);

<span style="color: #4f97d7; font-weight: bold;">const</span> <span style="color: #7590db;">HTMLWebpackPlugin</span> = require(<span style="color: #2d9574;">"html-webpack-plugin"</span>);

<span style="color: #4f97d7; font-weight: bold;">const</span> { CleanWebpackPlugin } = require(<span style="color: #2d9574;">"clean-webpack-plugin"</span>);

module.exports = {
    entry: <span style="color: #2d9574;">"./src/index.ts"</span>,
    output: {
        path: path.resolve(__dirname, <span style="color: #2d9574;">"dist"</span>),
        filename: <span style="color: #2d9574;">"bundle.js"</span>,
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">environment: {</span>
        <span style="color: #2aa1ae; background-color: #292e34;">//     </span><span style="color: #2aa1ae; background-color: #292e34;">arrowFunction: false,</span>
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">},</span>
    },
    module: {
        rules: [
            {
                test: <span style="color: #2d9574;">/\.ts$/</span>,
                use: [
                    {
                        loader: <span style="color: #2d9574;">"babel-loader"</span>,
                        options: {
                            presets: [
                                [
                                    <span style="color: #2d9574;">"@babel/preset-env"</span>,
                                    {
                                        targets: {
                                            chrome: <span style="color: #2d9574;">"87"</span>,
                                            <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">ie: "11",</span>
                                        },
                                        corejs: <span style="color: #2d9574;">"3"</span>,
                                        useBuiltIns: <span style="color: #2d9574;">"usage"</span>,
                                    },
                                ],
                            ],
                        },
                    },
                    <span style="color: #2d9574;">"ts-loader"</span>,
                ],
                exclude: <span style="color: #2d9574;">/node-modules/</span>,
            },
        ],
    },
    plugins: [
        <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HTMLWebpackPlugin</span>({
            title: <span style="color: #2d9574;">"APP For Webpack"</span>,
        }),
        <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">CleanWebpackPlugin</span>(),
    ],

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27169;&#22359;&#35774;&#23450;</span>
    resolve: {
        extensions: [<span style="color: #2d9574;">".ts"</span>, <span style="color: #2d9574;">".js"</span>],
    },
};

</pre>
</div>
</div>
</div>
<div id="outline-container-org0f0faa9" class="outline-3">
<h3 id="org0f0faa9">JQary</h3>
<div class="outline-text-3" id="text-org0f0faa9">
</div>
<div id="outline-container-orgddf36ba" class="outline-4">
<h4 id="orgddf36ba">JQuery选择器</h4>
<div class="outline-text-4" id="text-orgddf36ba">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">elements chooser</td>
<td class="org-left">class chooser</td>
<td class="org-left">id  chooser</td>
</tr>

<tr>
<td class="org-left">$("p"), $("div"), $("h2")</td>
<td class="org-left">$(".test")</td>
<td class="org-left">$("#test")</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org0b6b6b6" class="outline-4">
<h4 id="org0b6b6b6">CSS 选择器</h4>
<div class="outline-text-4" id="text-org0b6b6b6">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">elements chooser</td>
<td class="org-left">class chooser</td>
<td class="org-left">id  chooser</td>
</tr>

<tr>
<td class="org-left">p, div, h2</td>
<td class="org-left">.test</td>
<td class="org-left">#test</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org59888ff" class="outline-4">
<h4 id="org59888ff">operation function</h4>
<div class="outline-text-4" id="text-org59888ff">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">toggle</td>
<td class="org-left">fade</td>
<td class="org-left">slide</td>
<td class="org-left">animate</td>
<td class="org-left">stop</td>
<td class="org-left">clain</td>
</tr>

<tr>
<td class="org-left">text</td>
<td class="org-left">html</td>
<td class="org-left">val</td>
<td class="org-left">attr</td>
<td class="org-left">append</td>
<td class="org-left">prepend</td>
</tr>

<tr>
<td class="org-left">after</td>
<td class="org-left">before</td>
<td class="org-left">remove</td>
<td class="org-left">empty</td>
<td class="org-left">addclass</td>
<td class="org-left">removeclass</td>
</tr>

<tr>
<td class="org-left">css</td>
<td class="org-left">width</td>
<td class="org-left">height</td>
<td class="org-left">perent</td>
<td class="org-left">childen</td>
<td class="org-left">siblings</td>
</tr>

<tr>
<td class="org-left">load</td>
<td class="org-left">get</td>
<td class="org-left">post</td>
<td class="org-left">noConflict</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org043db0d" class="outline-3">
<h3 id="org043db0d">AJAX</h3>
</div>
<div id="outline-container-org813ef5f" class="outline-3">
<h3 id="org813ef5f">Vue</h3>
<div class="outline-text-3" id="text-org813ef5f">
<p>
id 选择器的名字不能是数字
</p>
</div>
</div>

<div id="outline-container-org43142ce" class="outline-3">
<h3 id="org43142ce">Servlet</h3>
</div>
<div id="outline-container-org910ee67" class="outline-3">
<h3 id="org910ee67">Bootstrap</h3>
</div>
</div>
<div id="outline-container-orga57c17d" class="outline-2">
<h2 id="orga57c17d">backend</h2>
<div class="outline-text-2" id="text-orga57c17d">
</div>
<div id="outline-container-org27fba53" class="outline-3">
<h3 id="org27fba53">Spring</h3>
<div class="outline-text-3" id="text-org27fba53">
</div>
<div id="outline-container-org8f35540" class="outline-4">
<h4 id="org8f35540">sammelung:</h4>
<div class="outline-text-4" id="text-org8f35540">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Component</td>
<td class="org-left">inject the class into Spring from current file as bean</td>
</tr>

<tr>
<td class="org-left">ComponentScan</td>
<td class="org-left">load the bean into current file from Spring  as class</td>
</tr>

<tr>
<td class="org-left">Autowired</td>
<td class="org-left">complete all beans dependence with the beans in spring</td>
</tr>

<tr>
<td class="org-left">Configuration</td>
<td class="org-left">configuration class</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>


<p>
模式： 单例和多例：生命周期：创建和销毁时间
</p>
</div>
</div>

<div id="outline-container-org02cd14d" class="outline-4">
<h4 id="org02cd14d">Annotation mehthod</h4>
<div class="outline-text-4" id="text-org02cd14d">
</div>
<ul class="org-ul">
<li><a id="orgeb9fbe5"></a>@Component<br />
<div class="outline-text-5" id="text-orgeb9fbe5">
<p>
将所修饰的类做成bean，由 Spring 来管理
为了减少耦合，建立一个配置类来管理全部的bean
由 @Configuation and @ComponentScan 创建的配置类来管理。
注意Spring只是默认管理@ComponentScan所在的其以下的区域，
除非指定包名，可以到其上一级的包路径
</p>
</div>
</li>

<li><a id="org2942c38"></a>web hierarchy with @component<br />
<div class="outline-text-5" id="text-org2942c38">
<p>
Controller layer use @Controller than @Component
Service layer use @Service than @Component
Dao layer use @Repository than @Component
</p>
</div>
</li>

<li><a id="org6fd1af8"></a>autowired<br />
<div class="outline-text-5" id="text-org6fd1af8">
<ul class="org-ul">
<li>Set注入 利用set方法</li>
<li>cost注入 利用构造方法，可和set 注入混用</li>
<li>普通成员变量</li>
<li>普通成员函数</li>
</ul>
</div>
</li>
<li><a id="org1e4985b"></a>interface with @Autowired<br />
<div class="outline-text-5" id="text-org1e4985b">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">注入</td>
<td class="org-left">@Compenten</td>
<td class="org-left">加在实现类</td>
</tr>

<tr>
<td class="org-left">装配</td>
<td class="org-left">@Autowired</td>
<td class="org-left">放在该接口的类型前</td>
</tr>

<tr>
<td class="org-left">产生歧义</td>
<td class="org-left">多个Autowired</td>
<td class="org-left">如果该接口有多个实现类，不知道用那个实现类的bean</td>
</tr>

<tr>
<td class="org-left">首选bean</td>
<td class="org-left">@Primary</td>
<td class="org-left">多个实现类的Compenten注入时，可制定唯一一个实现类为首</td>
</tr>

<tr>
<td class="org-left">限定附</td>
<td class="org-left">@Qualifier("xxx")</td>
<td class="org-left">在Autowired时，使用一样的 @Qualifier("xxx")</td>
</tr>

<tr>
<td class="org-left">bean id</td>
<td class="org-left">@Compenten("xxx")</td>
<td class="org-left">同样在Autowired时，使用一样的 @Qualifier("xxx")</td>
</tr>

<tr>
<td class="org-left">默认bean id</td>
<td class="org-left">xxx即为类名</td>
<td class="org-left">在Autowired时 @Qualifier("xxx")时，类名首字母小写即可</td>
</tr>

<tr>
<td class="org-left">二合一</td>
<td class="org-left">@Resource(name="小写类名")</td>
<td class="org-left">代替Autowired 和Qulifier()</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgd09012d" class="outline-4">
<h4 id="orgd09012d">xml mehthod</h4>
<div class="outline-text-4" id="text-orgd09012d">
<p>
New-&gt; XML Configuration File -&gt; Spring Config 
 default name: ApplicationContext.xml
</p>

<p>
&lt;bean
 class="xxx.xxx.xxx.class"
 id="" (gleich wie name="") 别名可以多个，隔开即可
 &lt;consturctor-arg ref="beanid"&gt; für contributor bean 
 &lt;consturctor-arg name="xxx" value="yyy"&gt; für contributor string
 c:contributor C名称空间
 &lt;list&gt;
 &lt;map&gt;
 &lt;set&gt;
 &lt;p&gt;
 &lt;util&gt;
 &lt;properties&gt;
 &#x2026;            
    &gt;&lt;bean&gt;
</p>
</div>
</div>

<div id="outline-container-org48af75f" class="outline-4">
<h4 id="org48af75f">bean method</h4>
<div class="outline-text-4" id="text-org48af75f">
<p>
Don't use @Component or Service Controller Repository to inject bean(IOC)
with a config class @Configuation
Use @bean on it's consturctor function to inject bean.
对其多实现类的歧义性处理，和自动装配一样，@Primary @Qualifer and BEANID    
</p>
</div>
<ul class="org-ul">
<li><a id="orgf621a5a"></a>seter<br />
<div class="outline-text-5" id="text-orgf621a5a">
<p>
passing the contributor bean can use setter function
</p>
</div>
</li>

<li><a id="org499819a"></a>consturctor<br />
<div class="outline-text-5" id="text-org499819a">
<p>
if a bean need another bean as contributor, 
the contributor can be passed as argument into consturctor function,
or generated
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgfeed42f" class="outline-4">
<h4 id="orgfeed42f">advancd mehthod</h4>
<div class="outline-text-4" id="text-orgfeed42f">
</div>
<ul class="org-ul">
<li><a id="org2066531"></a>function field<br />
<div class="outline-text-5" id="text-org2066531">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">singleton</td>
<td class="org-left">default only one bean</td>
</tr>

<tr>
<td class="org-left">prototype</td>
<td class="org-left">scope="prototype"</td>
</tr>

<tr>
<td class="org-left">Session</td>
<td class="org-left">each inject</td>
</tr>

<tr>
<td class="org-left">request</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="org9aca54d"></a>lazy load bean<br />
<div class="outline-text-5" id="text-org9aca54d">
<p>
in xml: lazy-init="true"
in Annotation: @Lazy with prototype, singleton is default as lazy
</p>
</div>
</li>
<li><a id="orgba1f362"></a>init and destroy<br /></li>
</ul>
</div>

<div id="outline-container-orgbbe7e4a" class="outline-4">
<h4 id="orgbbe7e4a">log4j</h4>
<div class="outline-text-4" id="text-orgbbe7e4a">
<p>
after injuct in pox.xml, create log4j.properties in project resources fold
</p>

<pre class="example">
log4j.rootCategory=INFO, stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %t %c{2}:%L - %m%n

log4j.category.org.springframework.beans.factory=DEBUG


</pre>
</div>
</div>

<div id="outline-container-org64996c9" class="outline-4">
<h4 id="org64996c9">Test</h4>
<div class="outline-text-4" id="text-org64996c9">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">@RunWith</td>
</tr>

<tr>
<td class="org-left">@ContextConfiguration</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org79aad1e" class="outline-4">
<h4 id="org79aad1e">AOP</h4>
<div class="outline-text-4" id="text-org79aad1e">
<p>
动态代理，(JDK，接口) (CGLib, 接口)
</p>

<p>
前置，后置，环绕
class 1 -&gt; Bean 1
Bean 1 + pointcut(expression,within,args) + class 2 -&gt; Bean 2
</p>
</div>

<ul class="org-ul">
<li><a id="org34069ad"></a>Concept<br />
<div class="outline-text-5" id="text-org34069ad">
<p>
连接点：可增强的方法
切入点: 实际上被增强的方法
通知（增强）：增强的内容
</p>
<ul class="org-ul">
<li>前置 Before</li>
<li>后置 After  增强之后，return 之前，有异常也执行</li>
<li>环绕 Around</li>
<li>异常 AfterThrowing 有异常才执行</li>
<li>最终 AterRreturning return 之后才执行，有异常不执行</li>
</ul>

<p>
切面：将增强内容应用到切入点
</p>
</div>
</li>


<li><a id="org9c2b494"></a>AspectJ<br />
<div class="outline-text-5" id="text-org9c2b494">
<ul class="org-ul">
<li>xml</li>
<li>Annotation</li>
</ul>
<p>
切入点表达式
@Pointcut
@Oder()
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgd6c0444" class="outline-4">
<h4 id="orgd6c0444">JDBC</h4>
<div class="outline-text-4" id="text-orgd6c0444">
<p>
JDBC Template
update(sql, args) 增删改
queryForObject()查
query()
bachtupdate()
</p>
</div>
</div>
</div>


<div id="outline-container-org541184f" class="outline-3">
<h3 id="org541184f">SpingMVC</h3>
<div class="outline-text-3" id="text-org541184f">
<p>
Web action &#x2013;&gt;  前端控制 &#x2013;&gt; Path &#x2013;&gt; 后端 &#x2013;&gt; handler &#x2013;&gt; 前端 
backend reserver arguments.
</p>
<ol class="org-ol">
<li>single argument</li>
<li>multi arguments</li>
<li>class instance</li>
</ol>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">C -&gt; C</td>
<td class="org-left">redirect</td>
<td class="org-left">重定向</td>
<td class="org-left">刷新后会重复提交增删改</td>
</tr>

<tr>
<td class="org-left">C -&gt; V</td>
<td class="org-left">forward</td>
<td class="org-left">转发</td>
<td class="org-left">查询需要转发</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>


<p>
-Dfile.encoding=utf-8 for Tomcat server VM Options: backend output for chineseisch
</p>

<p>
 C-&gt; V assugment
request session model
</p>
</div>
</div>

<div id="outline-container-org0ef7d46" class="outline-3">
<h3 id="org0ef7d46">Spring Boot</h3>
<div class="outline-text-3" id="text-org0ef7d46">
</div>
<div id="outline-container-org29efdac" class="outline-4">
<h4 id="一spring-boot-入门">一、Spring Boot 入门</h4>
<div class="outline-text-4" id="text-一spring-boot-入门">
</div>

<ul class="org-ul">
<li><a id="spring-boot-简介"></a>1、Spring Boot 简介<br />
<div class="outline-text-5" id="text-spring-boot-简介">
<blockquote>
<p>
简化Spring应用开发的一个框架；
</p>

<p>
整个Spring技术栈的一个大整合；
</p>

<p>
J2EE开发的一站式解决方案；
</p>
</blockquote>
</div>
</li>

<li><a id="微服务"></a>2、微服务<br />
<div class="outline-text-5" id="text-微服务">
<p>
2014，martin fowler
</p>

<p>
微服务：架构风格（服务微化）
</p>

<p>
一个应用应该是一组小型服务；可以通过HTTP的方式进行互通；
</p>

<p>
单体应用：ALL IN ONE
</p>

<p>
微服务：每一个功能元素最终都是一个可独立替换和独立升级的软件单元；
</p>

<p>
<a href="https://martinfowler.com/articles/microservices.html#MicroservicesAndSoa">详细参照微服务文档</a>
</p>
</div>
</li>

<li><a id="环境准备"></a>3、环境准备<br />
<div class="outline-text-5" id="text-环境准备">
<p>
<a href="http://www.gulixueyuan.com/">http://www.gulixueyuan.com/</a> 谷粒学院
</p>

<p>
环境约束
</p>

<p>
&#x2013;jdk1.8：Spring Boot 推荐jdk1.7及以上；java version "1.8.0\<sub>112</sub>"
</p>

<p>
&#x2013;maven3.x：maven 3.3以上版本；Apache Maven 3.3.9
</p>

<p>
&#x2013;IntelliJIDEA2017：IntelliJ IDEA 2017.2.2 x64、STS
</p>

<p>
&#x2013;SpringBoot 1.5.9.RELEASE：1.5.9；
</p>

<p>
统一环境；
</p>
</div>

<ul class="org-ul">
<li><a id="maven设置"></a>1、MAVEN设置；<br />
<div class="outline-text-6" id="text-maven设置">
<p>
给maven 的settings.xml配置文件的profiles标签添加
</p>

<pre class="example">
&lt;profile&gt;
  &lt;id&gt;jdk-1.8&lt;/id&gt;
  &lt;activation&gt;
    &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
    &lt;jdk&gt;1.8&lt;/jdk&gt;
  &lt;/activation&gt;
  &lt;properties&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;maven.compiler.compilerVersion&gt;1.8&lt;/maven.compiler.compilerVersion&gt;
  &lt;/properties&gt;
&lt;/profile&gt;
</pre>
</div>
</li>

<li><a id="idea设置"></a>2、IDEA设置<br />
<div class="outline-text-6" id="text-idea设置">
<p>
整合maven进来；
</p>


<div class="figure">
<p><img src="images/搜狗截图20180129151045.png" alt="搜狗截图20180129151045.png" />
</p>
<p><span class="figure-number">Figure 2: </span>idea设置</p>
</div>


<div class="figure">
<p><img src="images/搜狗截图20180129151112.png" alt="搜狗截图20180129151112.png" />
</p>
<p><span class="figure-number">Figure 3: </span>images/</p>
</div>
</div>
</li>
</ul>
</li>

<li><a id="spring-boot-helloworld"></a>4、Spring Boot HelloWorld<br />
<div class="outline-text-5" id="text-spring-boot-helloworld">
<p>
一个功能：
</p>

<p>
浏览器发送hello请求，服务器接受请求并处理，响应Hello World字符串；
</p>
</div>

<ul class="org-ul">
<li><a id="创建一个maven工程jar"></a>1、创建一个maven工程；（jar）<br />
<div class="outline-text-6" id="text-创建一个maven工程jar">
</div>
</li>

<li><a id="导入spring-boot相关的依赖"></a>2、导入spring boot相关的依赖<br />
<div class="outline-text-6" id="text-导入spring-boot相关的依赖">
<pre class="example">
&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;1.5.9.RELEASE&lt;/version&gt;
&lt;/parent&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre>
</div>
</li>

<li><a id="编写一个主程序启动spring-boot应用"></a>3、编写一个主程序；启动Spring Boot应用<br />
<div class="outline-text-6" id="text-编写一个主程序启动spring-boot应用">
<div class="org-src-container">
<pre class="src src-java">
<span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> *  @SpringBootApplication &#26469;&#26631;&#27880;&#19968;&#20010;&#20027;&#31243;&#24207;&#31867;&#65292;&#35828;&#26126;&#36825;&#26159;&#19968;&#20010;Spring Boot&#24212;&#29992;</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #a45bad;">@SpringBootApplication</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloWorldMainApplication</span> {

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>(<span style="color: #ce537a; font-weight: bold;">String</span>[] <span style="color: #7590db;">args</span>) {

        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Spring&#24212;&#29992;&#21551;&#21160;&#36215;&#26469;</span>
        SpringApplication.run(HelloWorldMainApplication.<span style="color: #4f97d7; font-weight: bold;">class</span>,args);
    }
}
</pre>
</div>
</div>
</li>

<li><a id="编写相关的controllerservice"></a>4、编写相关的Controller、Service<br />
<div class="outline-text-6" id="text-编写相关的controllerservice">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Controller</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloController</span> {

    <span style="color: #a45bad;">@ResponseBody</span>
    <span style="color: #a45bad;">@RequestMapping</span>(<span style="color: #2d9574;">"/hello"</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #bc6ec5; font-weight: bold;">hello</span>(){
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">"Hello World!"</span>;
    }
}
</pre>
</div>
</div>
</li>

<li><a id="运行主程序测试"></a>5、运行主程序测试<br />
<div class="outline-text-6" id="text-运行主程序测试">
</div>
</li>

<li><a id="简化部署"></a>6、简化部署<br />
<div class="outline-text-6" id="text-简化部署">
<pre class="example">
&lt;!-- 这个插件，可以将应用打包成一个可执行的jar包；--&gt;
   &lt;build&gt;
       &lt;plugins&gt;
           &lt;plugin&gt;
               &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
               &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
           &lt;/plugin&gt;
       &lt;/plugins&gt;
   &lt;/build&gt;
</pre>

<p>
将这个应用打成jar包，直接使用java -jar的命令进行执行；
</p>
</div>
</li>
</ul>
</li>

<li><a id="hello-world探究"></a>5、Hello World探究<br />
<div class="outline-text-5" id="text-hello-world探究">
</div>

<ul class="org-ul">
<li><a id="pom文件"></a>1、POM文件<br />
<div class="outline-text-6" id="text-pom文件">
</div>

<ul class="org-ul">
<li><a id="父项目"></a>1、父项目<br />
<div class="outline-text-7" id="text-父项目">
<pre class="example">
&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;1.5.9.RELEASE&lt;/version&gt;
&lt;/parent&gt;

他的父项目是
&lt;parent&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;
  &lt;version&gt;1.5.9.RELEASE&lt;/version&gt;
  &lt;relativePath&gt;../../spring-boot-dependencies&lt;/relativePath&gt;
&lt;/parent&gt;
他来真正管理Spring Boot应用里面的所有依赖版本；
</pre>

<p>
Spring Boot的版本仲裁中心；
</p>

<p>
以后我们导入依赖默认是不需要写版本；（没有在dependencies里面管理的依赖自然需要声明版本号）
</p>
</div>
</li>

<li><a id="启动器"></a>2、启动器<br />
<div class="outline-text-7" id="text-启动器">
<pre class="example">
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre>

<p>
<b>spring-boot-starter</b>-==web==：
</p>

<p>
​
spring-boot-starter：spring-boot场景启动器；帮我们导入了web模块正常运行所依赖的组件；
</p>

<p>
Spring
Boot将所有的功能场景都抽取出来，做成一个个的starters（启动器），只需要在项目里面引入这些starter相关场景的所有依赖都会导入进来。要用什么功能就导入什么场景的启动器
</p>
</div>
</li>
</ul>
</li>

<li><a id="主程序类主入口类"></a>2、主程序类，主入口类<br />
<div class="outline-text-6" id="text-主程序类主入口类">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> *  @SpringBootApplication &#26469;&#26631;&#27880;&#19968;&#20010;&#20027;&#31243;&#24207;&#31867;&#65292;&#35828;&#26126;&#36825;&#26159;&#19968;&#20010;Spring Boot&#24212;&#29992;</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #a45bad;">@SpringBootApplication</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloWorldMainApplication</span> {

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>(<span style="color: #ce537a; font-weight: bold;">String</span>[] <span style="color: #7590db;">args</span>) {

        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Spring&#24212;&#29992;&#21551;&#21160;&#36215;&#26469;</span>
        SpringApplication.run(HelloWorldMainApplication.<span style="color: #4f97d7; font-weight: bold;">class</span>,args);
    }
}
</pre>
</div>

<p>
@**SpringBootApplication**: Spring
Boot应用标注在某个类上说明这个类是SpringBoot的主配置类，SpringBoot就应该运行这个类的main方法来启动SpringBoot应用；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Target</span>(<span style="color: #a45bad;">ElementType</span>.<span style="color: #ce537a; font-weight: bold;">TYPE</span>)
<span style="color: #a45bad;">@Retention</span>(<span style="color: #a45bad;">RetentionPolicy</span>.<span style="color: #ce537a; font-weight: bold;">RUNTIME</span>)
<span style="color: #a45bad;">@Documented</span>
<span style="color: #a45bad;">@Inherited</span>
<span style="color: #a45bad;">@SpringBootConfiguration</span>
<span style="color: #a45bad;">@EnableAutoConfiguration</span>
<span style="color: #a45bad;">@ComponentScan</span>(excludeFilters = {
      <span style="color: #a45bad;">@Filter</span>(type = <span style="color: #a45bad;">FilterType</span>.CUSTOM, classes = TypeExcludeFilter.<span style="color: #4f97d7; font-weight: bold;">class</span>),
      <span style="color: #a45bad;">@Filter</span>(type = <span style="color: #a45bad;">FilterType</span>.CUSTOM, classes = AutoConfigurationExcludeFilter.<span style="color: #4f97d7; font-weight: bold;">class</span>) })
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">@interface</span> <span style="color: #ce537a; font-weight: bold;">SpringBootApplication</span> {
</pre>
</div>

<p>
@**SpringBootConfiguration**:Spring Boot的配置类；
</p>

<p>
​ 标注在某个类上，表示这是一个Spring Boot的配置类；
</p>

<p>
​ @**Configuration**:配置类上来标注这个注解；
</p>

<p>
​ 配置类 &#x2013;&#x2014; 配置文件；配置类也是容器中的一个组件；@Component
</p>

<p>
@**EnableAutoConfiguration**：开启自动配置功能；
</p>

<p>
​ 以前我们需要配置的东西，Spring
Boot帮我们自动配置；@**EnableAutoConfiguration**告诉SpringBoot开启自动配置功能；这样自动配置才能生效；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@AutoConfigurationPackage</span>
<span style="color: #a45bad;">@Import</span>(EnableAutoConfigurationImportSelector.<span style="color: #4f97d7; font-weight: bold;">class</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">@interface</span> <span style="color: #ce537a; font-weight: bold;">EnableAutoConfiguration</span> {
</pre>
</div>

<p>
​ @**AutoConfigurationPackage**：自动配置包
</p>

<p>
​ @**Import**(AutoConfigurationPackages.Registrar.class)：
</p>

<p>
​
Spring的底层注解@Import，给容器中导入一个组件；导入的组件由AutoConfigurationPackages.Registrar.class；
</p>

<p>
<code>=将主配置类（@SpringBootApplication标注的类）的所在包及下面所有子包里面的所有组件扫描到Spring容器；=</code>
</p>

<p>
​ @**Import**(EnableAutoConfigurationImportSelector.class)；
</p>

<p>
​ 给容器中导入组件？
</p>

<p>
​ *EnableAutoConfigurationImportSelector*：导入哪些组件的选择器；
</p>

<p>
​ 将所有需要导入的组件以全类名的方式返回；这些组件就会被添加到容器中；
</p>

<p>
​
会给容器中导入非常多的自动配置类（xxxAutoConfiguration）；就是给容器中导入这个场景需要的所有组件，并配置好这些组件；
<img src="images/搜狗截图20180129224104.png" alt="搜狗截图20180129224104.png" />
</p>

<p>
有了自动配置类，免去了我们手动编写配置注入功能组件等的工作；
</p>

<p>
​
SpringFactoriesLoader.loadFactoryNames(EnableAutoConfiguration.class,classLoader)；
</p>

<p>
==Spring
Boot在启动的时候从类路径下的META-INF/spring.factories中获取EnableAutoConfiguration指定的值，将这些值作为自动配置类导入到容器中，自动配置类就生效，帮我们进行自动配置工作；==以前我们需要自己配置的东西，自动配置类都帮我们；
</p>

<p>
J2EE的整体整合解决方案和自动配置都在spring-boot-autoconfigure-1.5.9.RELEASE.jar；
</p>

<p>
​
</p>

<p>
<code>=Spring注解版（谷粒学院）=</code>
</p>
</div>
</li>
</ul>
</li>

<li><a id="使用spring-initializer快速创建spring-boot项目"></a>6、使用Spring Initializer快速创建Spring Boot项目<br />
<div class="outline-text-5" id="text-使用spring-initializer快速创建spring-boot项目">
</div>

<ul class="org-ul">
<li><a id="idea使用-spring-initializer快速创建项目"></a>1、IDEA：使用 Spring Initializer快速创建项目<br />
<div class="outline-text-6" id="text-idea使用-spring-initializer快速创建项目">
<p>
IDE都支持使用Spring的项目创建向导快速创建一个Spring Boot项目；
</p>

<p>
选择我们需要的模块；向导会联网创建Spring Boot项目；
</p>

<p>
默认生成的Spring Boot项目；
</p>

<ul class="org-ul">
<li>主程序已经生成好了，我们只需要我们自己的逻辑</li>
<li>resources文件夹中目录结构</li>
<li>static：保存所有的静态资源； js css images；</li>
<li>templates：保存所有的模板页面；（Spring
Boot默认jar包使用嵌入式的Tomcat，默认不支持JSP页面）；可以使用模板引擎（freemarker、thymeleaf）；</li>
<li>application.properties：Spring
Boot应用的配置文件；可以修改一些默认设置；</li>
</ul>
</div>
</li>

<li><a id="sts使用-spring-starter-project快速创建项目"></a>2、STS使用 Spring Starter Project快速创建项目<br />
<div class="outline-text-6" id="text-sts使用-spring-starter-project快速创建项目">
<hr />
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org003c246" class="outline-4">
<h4 id="二配置文件">二、配置文件</h4>
<div class="outline-text-4" id="text-二配置文件">
</div>

<ul class="org-ul">
<li><a id="配置文件"></a>1、配置文件<br />
<div class="outline-text-5" id="text-配置文件">
<p>
SpringBoot使用一个全局的配置文件，配置文件名是固定的；
</p>

<p>
•application.properties
</p>

<p>
•application.yml
</p>

<p>
配置文件的作用：修改SpringBoot自动配置的默认值；SpringBoot在底层都给我们自动配置好；
</p>

<p>
YAML（YAML Ain't Markup Language）
</p>

<p>
​ YAML A Markup Language：是一个标记语言
</p>

<p>
​ YAML isn't Markup Language：不是一个标记语言；
</p>

<p>
标记语言：
</p>

<p>
​ 以前的配置文件；大多都使用的是 *xxxx.xml*文件；
</p>

<p>
​ YAML：*以数据为中心*，比json、xml等更适合做配置文件；
</p>

<p>
​ YAML：配置例子
</p>

<pre class="example">
server:
  port: 8081
</pre>

<p>
​ XML：
</p>

<pre class="example">
&lt;server&gt;
    &lt;port&gt;8081&lt;/port&gt;
&lt;/server&gt;
</pre>
</div>
</li>

<li><a id="yaml语法"></a>2、YAML语法：<br />
<div class="outline-text-5" id="text-yaml语法">
</div>

<ul class="org-ul">
<li><a id="基本语法"></a>1、基本语法<br />
<div class="outline-text-6" id="text-基本语法">
<p>
k:(空格)v：表示一对键值对（空格必须有）；
</p>

<p>
以*空格*的缩进来控制层级关系；只要是左对齐的一列数据，都是同一个层级的
</p>

<pre class="example">
server:
    port: 8081
    path: /hello
</pre>

<p>
属性和值也是大小写敏感；
</p>
</div>
</li>

<li><a id="值的写法"></a>2、值的写法<br />
<div class="outline-text-6" id="text-值的写法">
</div>

<ul class="org-ul">
<li><a id="字面量普通的值数字字符串布尔"></a>字面量：普通的值（数字，字符串，布尔）<br />
<div class="outline-text-7" id="text-字面量普通的值数字字符串布尔">
<p>
​ k: v：字面直接来写；
</p>

<p>
​ 字符串默认不用加上单引号或者双引号；
</p>

<p>
​
""：双引号；不会转义字符串里面的特殊字符；特殊字符会作为本身想表示的意思
</p>

<p>
​ name: "zhangsan \n lisi"：输出；zhangsan 换行 lisi
</p>

<p>
​ ''：单引号；会转义特殊字符，特殊字符最终只是一个普通的字符串数据
</p>

<p>
​ name: ‘zhangsan \n lisi'：输出；zhangsan \n  lisi
</p>
</div>
</li>

<li><a id="对象map属性和值键值对"></a>对象、Map（属性和值）（键值对）：<br />
<div class="outline-text-7" id="text-对象map属性和值键值对">
<p>
​ k: v：在下一行来写对象的属性和值的关系；注意缩进
</p>

<p>
​ 对象还是k: v的方式
</p>

<pre class="example">
friends:
        lastName: zhangsan
        age: 20
</pre>

<p>
行内写法：
</p>

<pre class="example">
friends: {lastName: zhangsan,age: 18}
</pre>
</div>
</li>

<li><a id="数组listset"></a>数组（List、Set）：<br />
<div class="outline-text-7" id="text-数组listset">
<p>
用- 值表示数组中的一个元素
</p>

<pre class="example">
pets:
 - cat
 - dog
 - pig
</pre>

<p>
行内写法
</p>

<pre class="example">
pets: [cat,dog,pig]
</pre>
</div>
</li>
</ul>
</li>
</ul>
</li>

<li><a id="配置文件值注入"></a>3、配置文件值注入<br />
<div class="outline-text-5" id="text-配置文件值注入">
<p>
配置文件
</p>

<pre class="example">
person:
    lastName: hello
    age: 18
    boss: false
    birth: 2017/12/12
    maps: {k1: v1,k2: 12}
    lists:
      - lisi
      - zhaoliu
    dog:
      name: 小狗
      age: 12
</pre>

<p>
javaBean：
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> * &#23558;&#37197;&#32622;&#25991;&#20214;&#20013;&#37197;&#32622;&#30340;&#27599;&#19968;&#20010;&#23646;&#24615;&#30340;&#20540;&#65292;&#26144;&#23556;&#21040;&#36825;&#20010;&#32452;&#20214;&#20013;</span>
<span style="color: #9f8766;"> * @ConfigurationProperties&#65306;&#21578;&#35785;SpringBoot&#23558;&#26412;&#31867;&#20013;&#30340;&#25152;&#26377;&#23646;&#24615;&#21644;&#37197;&#32622;&#25991;&#20214;&#20013;&#30456;&#20851;&#30340;&#37197;&#32622;&#36827;&#34892;&#32465;&#23450;&#65307;</span>
<span style="color: #9f8766;"> *      prefix = "person"&#65306;&#37197;&#32622;&#25991;&#20214;&#20013;&#21738;&#20010;&#19979;&#38754;&#30340;&#25152;&#26377;&#23646;&#24615;&#36827;&#34892;&#19968;&#19968;&#26144;&#23556;</span>
<span style="color: #9f8766;"> *</span>
<span style="color: #9f8766;"> * &#21482;&#26377;&#36825;&#20010;&#32452;&#20214;&#26159;&#23481;&#22120;&#20013;&#30340;&#32452;&#20214;&#65292;&#25165;&#33021;&#23481;&#22120;&#25552;&#20379;&#30340;@ConfigurationProperties&#21151;&#33021;&#65307;</span>
<span style="color: #9f8766;"> *</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #a45bad;">@Component</span>
<span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"person"</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span> {

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">lastName</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">age</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Boolean</span> <span style="color: #7590db;">boss</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Date</span> <span style="color: #7590db;">birth</span>;

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">maps</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">lists</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Dog</span> <span style="color: #7590db;">dog</span>;
</pre>
</div>

<p>
我们可以导入配置文件处理器，以后编写配置就有提示了
</p>

<pre class="example">
&lt;!--导入配置文件处理器，配置文件进行绑定就会有提示--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
</pre>
</div>

<ul class="org-ul">
<li><a id="properties配置文件在idea中默认utf-8可能会乱码"></a>1、properties配置文件在idea中默认utf-8可能会乱码<br />
<div class="outline-text-7" id="text-properties配置文件在idea中默认utf-8可能会乱码">
<p>
调整
</p>


<div class="figure">
<p><img src="images/搜狗截图20180130161620.png" alt="搜狗截图20180130161620.png" />
</p>
<p><span class="figure-number">Figure 4: </span>idea配置乱码</p>
</div>
</div>
</li>

<li><a id="value获取值和configurationproperties获取值比较"></a>2、@Value获取值和@ConfigurationProperties获取值比较<br />
<div class="outline-text-7" id="text-value获取值和configurationproperties获取值比较">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">@ConfigurationProperties</th>
<th scope="col" class="org-left">@Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">功能</td>
<td class="org-left">批量注入配置文件中的属性</td>
<td class="org-left">一个个指定</td>
</tr>

<tr>
<td class="org-left">松散绑定（松散语法）</td>
<td class="org-left">支持</td>
<td class="org-left">不支持</td>
</tr>

<tr>
<td class="org-left">SpEL</td>
<td class="org-left">不支持</td>
<td class="org-left">支持</td>
</tr>

<tr>
<td class="org-left">JSR303数据校验</td>
<td class="org-left">支持</td>
<td class="org-left">不支持</td>
</tr>

<tr>
<td class="org-left">复杂类型封装</td>
<td class="org-left">支持</td>
<td class="org-left">不支持</td>
</tr>
</tbody>
</table>

<p>
配置文件yml还是properties他们都能获取到值；
</p>

<p>
如果说，我们只是在某个业务逻辑中需要获取一下配置文件中的某项值，使用@Value；
</p>

<p>
如果说，我们专门编写了一个javaBean来和配置文件进行映射，我们就直接使用@ConfigurationProperties；
</p>
</div>
</li>

<li><a id="配置文件注入值数据校验"></a>3、配置文件注入值数据校验<br />
<div class="outline-text-7" id="text-配置文件注入值数据校验">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Component</span>
<span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"person"</span>)
<span style="color: #a45bad;">@Validated</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span> {

    <span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;">     * </span><span style="color: #a45bad;">&lt;bean class="Person"&gt;</span>
<span style="color: #9f8766;">     *      </span><span style="color: #a45bad;">&lt;property name="lastName" value="&#23383;&#38754;&#37327;/${key}&#20174;&#29615;&#22659;&#21464;&#37327;&#12289;&#37197;&#32622;&#25991;&#20214;&#20013;&#33719;&#21462;&#20540;/#{SpEL}"&gt;&lt;/property&gt;</span>
<span style="color: #9f8766;">     * </span><span style="color: #dc752f; background-color: #292b2e;">&lt;</span><span style="color: #9f8766;">bean/</span><span style="color: #dc752f; background-color: #292b2e;">&gt;</span>
<span style="color: #9f8766;">     */</span>

   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">lastName&#24517;&#39035;&#26159;&#37038;&#31665;&#26684;&#24335;</span>
    <span style="color: #a45bad;">@Email</span>
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Value("${person.last-name}")</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">lastName</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Value("#{11*2}")</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">age</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Value("true")</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Boolean</span> <span style="color: #7590db;">boss</span>;

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Date</span> <span style="color: #7590db;">birth</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">maps</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">lists</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Dog</span> <span style="color: #7590db;">dog</span>;
</pre>
</div>
</div>
</li>

<li><a id="propertysourceimportresourcebean"></a>4、@PropertySource&amp;@ImportResource&amp;@Bean<br />
<div class="outline-text-7" id="text-propertysourceimportresourcebean">
<p>
@**PropertySource**：加载指定的配置文件；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> * &#23558;&#37197;&#32622;&#25991;&#20214;&#20013;&#37197;&#32622;&#30340;&#27599;&#19968;&#20010;&#23646;&#24615;&#30340;&#20540;&#65292;&#26144;&#23556;&#21040;&#36825;&#20010;&#32452;&#20214;&#20013;</span>
<span style="color: #9f8766;"> * @ConfigurationProperties&#65306;&#21578;&#35785;SpringBoot&#23558;&#26412;&#31867;&#20013;&#30340;&#25152;&#26377;&#23646;&#24615;&#21644;&#37197;&#32622;&#25991;&#20214;&#20013;&#30456;&#20851;&#30340;&#37197;&#32622;&#36827;&#34892;&#32465;&#23450;&#65307;</span>
<span style="color: #9f8766;"> *      prefix = "person"&#65306;&#37197;&#32622;&#25991;&#20214;&#20013;&#21738;&#20010;&#19979;&#38754;&#30340;&#25152;&#26377;&#23646;&#24615;&#36827;&#34892;&#19968;&#19968;&#26144;&#23556;</span>
<span style="color: #9f8766;"> *</span>
<span style="color: #9f8766;"> * &#21482;&#26377;&#36825;&#20010;&#32452;&#20214;&#26159;&#23481;&#22120;&#20013;&#30340;&#32452;&#20214;&#65292;&#25165;&#33021;&#23481;&#22120;&#25552;&#20379;&#30340;@ConfigurationProperties&#21151;&#33021;&#65307;</span>
<span style="color: #9f8766;"> *  @ConfigurationProperties(prefix = "person")&#40664;&#35748;&#20174;&#20840;&#23616;&#37197;&#32622;&#25991;&#20214;&#20013;&#33719;&#21462;&#20540;&#65307;</span>
<span style="color: #9f8766;"> *</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #a45bad;">@PropertySource</span>(value = {<span style="color: #2d9574;">"classpath:person.properties"</span>})
<span style="color: #a45bad;">@Component</span>
<span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"person"</span>)
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Validated</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span> {

    <span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;">     * </span><span style="color: #a45bad;">&lt;bean class="Person"&gt;</span>
<span style="color: #9f8766;">     *      </span><span style="color: #a45bad;">&lt;property name="lastName" value="&#23383;&#38754;&#37327;/${key}&#20174;&#29615;&#22659;&#21464;&#37327;&#12289;&#37197;&#32622;&#25991;&#20214;&#20013;&#33719;&#21462;&#20540;/#{SpEL}"&gt;&lt;/property&gt;</span>
<span style="color: #9f8766;">     * </span><span style="color: #dc752f; background-color: #292b2e;">&lt;</span><span style="color: #9f8766;">bean/</span><span style="color: #dc752f; background-color: #292b2e;">&gt;</span>
<span style="color: #9f8766;">     */</span>

   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">lastName&#24517;&#39035;&#26159;&#37038;&#31665;&#26684;&#24335;</span>
   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">@Email</span>
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Value("${person.last-name}")</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">lastName</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Value("#{11*2}")</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">age</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Value("true")</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Boolean</span> <span style="color: #7590db;">boss</span>;
</pre>
</div>

<p>
@**ImportResource**：导入Spring的配置文件，让配置文件里面的内容生效；
</p>

<p>
Spring
Boot里面没有Spring的配置文件，我们自己编写的配置文件，也不能自动识别；
</p>

<p>
想让Spring的配置文件生效，加载进来；@**ImportResource**标注在一个配置类上
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ImportResource</span>(locations = {<span style="color: #2d9574;">"classpath:beans.xml"</span>})
&#23548;&#20837;Spring&#30340;&#37197;&#32622;&#25991;&#20214;&#35753;&#20854;&#29983;&#25928;
</pre>
</div>

<p>
不来编写Spring的配置文件
</p>

<pre class="example">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;


    &lt;bean id="helloService" class="com.atguigu.springboot.service.HelloService"&gt;&lt;/bean&gt;
&lt;/beans&gt;
</pre>

<p>
SpringBoot推荐给容器中添加组件的方式；推荐使用全注解的方式
</p>

<p>
1、配置类*@Configuration*-&#x2013;&#x2014;&gt;Spring配置文件
</p>

<p>
2、使用*@Bean*给容器中添加组件
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> * @Configuration&#65306;&#25351;&#26126;&#24403;&#21069;&#31867;&#26159;&#19968;&#20010;&#37197;&#32622;&#31867;&#65307;&#23601;&#26159;&#26469;&#26367;&#20195;&#20043;&#21069;&#30340;Spring&#37197;&#32622;&#25991;&#20214;</span>
<span style="color: #9f8766;"> *</span>
<span style="color: #9f8766;"> * &#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#29992;</span><span style="color: #a45bad;">&lt;bean&gt;</span><span style="color: #dc752f; background-color: #292b2e;">&lt;</span><span style="color: #9f8766;">bean/</span><span style="color: #dc752f; background-color: #292b2e;">&gt;</span><span style="color: #9f8766;">&#26631;&#31614;&#28155;&#21152;&#32452;&#20214;</span>
<span style="color: #9f8766;"> *</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #a45bad;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyAppConfig</span> {

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#26041;&#27861;&#30340;&#36820;&#22238;&#20540;&#28155;&#21152;&#21040;&#23481;&#22120;&#20013;&#65307;&#23481;&#22120;&#20013;&#36825;&#20010;&#32452;&#20214;&#40664;&#35748;&#30340;id&#23601;&#26159;&#26041;&#27861;&#21517;</span>
    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">HelloService</span> <span style="color: #bc6ec5; font-weight: bold;">helloService02</span>(){
        System.out.println(<span style="color: #2d9574;">"&#37197;&#32622;&#31867;@Bean&#32473;&#23481;&#22120;&#20013;&#28155;&#21152;&#32452;&#20214;&#20102;..."</span>);
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HelloService</span>();
    }
}
</pre>
</div>
</div>
</li>
</ul>
</li>

<li><a id="配置文件占位符"></a>4、配置文件占位符<br />
<div class="outline-text-5" id="text-配置文件占位符">
</div>

<ul class="org-ul">
<li><a id="随机数"></a>1、随机数<br />
<div class="outline-text-6" id="text-随机数">
<div class="org-src-container">
<pre class="src src-java">${random.value}&#12289;${random.<span style="color: #ce537a; font-weight: bold;">int</span>}&#12289;${random.<span style="color: #ce537a; font-weight: bold;">long</span>}
${random.<span style="color: #ce537a; font-weight: bold;">int</span>(10)}&#12289;${random.<span style="color: #ce537a; font-weight: bold;">int</span>[1024,65536]}
</pre>
</div>
</div>
</li>

<li><a id="占位符获取之前配置的值如果没有可以是用指定默认值"></a>2、占位符获取之前配置的值，如果没有可以是用:指定默认值<br />
<div class="outline-text-6" id="text-占位符获取之前配置的值如果没有可以是用指定默认值">
<pre class="example">
person.last-name=张三${random.uuid}
person.age=${random.int}
person.birth=2017/12/15
person.boss=false
person.maps.k1=v1
person.maps.k2=14
person.lists=a,b,c
person.dog.name=${person.hello:hello}_dog
person.dog.age=15
</pre>
</div>
</li>
</ul>
</li>

<li><a id="profile"></a>5、Profile<br />
<div class="outline-text-5" id="text-profile">
</div>

<ul class="org-ul">
<li><a id="多profile文件"></a>1、多Profile文件<br />
<div class="outline-text-6" id="text-多profile文件">
<p>
我们在主配置文件编写的时候，文件名可以是
application-{profile}.properties/yml
</p>

<p>
默认使用application.properties的配置；
</p>
</div>
</li>

<li><a id="yml支持多文档块方式"></a>2、yml支持多文档块方式<br />
<div class="outline-text-6" id="text-yml支持多文档块方式">
<pre class="example">

server:
  port: 8081
spring:
  profiles:
    active: prod

---
server:
  port: 8083
spring:
  profiles: dev


---

server:
  port: 8084
spring:
  profiles: prod  #指定属于哪个环境
</pre>
</div>
</li>

<li><a id="激活指定profile"></a>3、激活指定profile<br />
<div class="outline-text-6" id="text-激活指定profile">
<p>
​ 1、在配置文件中指定 spring.profiles.active=dev
</p>

<p>
​ 2、命令行：
</p>

<p>
​ java -jar spring-boot-02-config-0.0.1-SNAPSHOT.jar
&#x2013;spring.profiles.active=dev；
</p>

<p>
​ 可以直接在测试的时候，配置传入命令行参数
</p>

<p>
​ 3、虚拟机参数；
</p>

<p>
​ -Dspring.profiles.active=dev
</p>
</div>
</li>
</ul>
</li>

<li><a id="配置文件加载位置"></a>6、配置文件加载位置<br />
<div class="outline-text-5" id="text-配置文件加载位置">
<p>
springboot
启动会扫描以下位置的application.properties或者application.yml文件作为Spring
boot的默认配置文件
</p>

<p>
--<a href="./config/">./config/</a>
</p>

<p>
--<a href="./">./</a>
</p>

<p>
&#x2013;classpath:/config/
</p>

<p>
&#x2013;classpath:/
</p>

<p>
优先级由高到底，高优先级的配置会覆盖低优先级的配置；
</p>

<p>
SpringBoot会从这四个位置全部加载主配置文件；*互补配置*；
</p>

<p>
<code>=我们还可以通过spring.config.location来改变默认的配置文件位置=</code>
</p>

<p>
<b>项目打包好以后，我们可以使用命令行参数的形式，启动项目的时候来指定配置文件的新位置；指定配置文件和默认加载的这些配置文件共同起作用形成互补配置；</b>
</p>

<p>
java -jar spring-boot-02-config-02-0.0.1-SNAPSHOT.jar
&#x2013;spring.config.location=G:/application.properties
</p>
</div>
</li>

<li><a id="外部配置加载顺序"></a>7、外部配置加载顺序<br />
<div class="outline-text-5" id="text-外部配置加载顺序">
<p>
<b><code>=SpringBoot也可以从以下位置加载配置；
优先级从高到低；高优先级的配置覆盖低优先级的配置，所有的配置会形成互补配置=</code></b>
</p>

<p>
<b>1.命令行参数</b>
</p>

<p>
所有的配置都可以在命令行上进行指定
</p>

<p>
java -jar spring-boot-02-config-02-0.0.1-SNAPSHOT.jar &#x2013;server.port=8087
&#x2013;server.context-path=/abc
</p>

<p>
多个配置用空格分开； &#x2013;配置项=值
</p>

<p>
2.来自java:comp/env的JNDI属性
</p>

<p>
3.Java系统属性（System.getProperties()）
</p>

<p>
4.操作系统环境变量
</p>

<p>
5.RandomValuePropertySource配置的random.*属性值
</p>

<p>
<code>=*由jar包外向jar包内进行寻找；*=</code>
</p>

<p>
<code>=*优先加载带profile*=</code>
</p>

<p>
<b>6.jar包外部的application-{profile}.properties或application.yml(带spring.profile)配置文件</b>
</p>

<p>
<b>7.jar包内部的application-{profile}.properties或application.yml(带spring.profile)配置文件</b>
</p>

<p>
<code>=*再来加载不带profile*=</code>
</p>

<p>
<b>8.jar包外部的application.properties或application.yml(不带spring.profile)配置文件</b>
</p>

<p>
<b>9.jar包内部的application.properties或application.yml(不带spring.profile)配置文件</b>
</p>

<p>
10.@Configuration注解类上的@PropertySource
</p>

<p>
11.通过SpringApplication.setDefaultProperties指定的默认属性
</p>

<p>
所有支持的配置加载来源；
</p>

<p>
<a href="https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/reference/htmlsingle/#boot-features-external-config">参考官方文档</a>
</p>
</div>
</li>

<li><a id="自动配置原理"></a>8、自动配置原理<br />
<div class="outline-text-5" id="text-自动配置原理">
<p>
配置文件到底能写什么？怎么写？自动配置原理；
</p>

<p>
<a href="https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/reference/htmlsingle/#common-application-properties">配置文件能配置的属性参照</a>
</p>
</div>

<ul class="org-ul">
<li><a id="自动配置原理-1"></a>1、*自动配置原理：*<br />
<div class="outline-text-6" id="text-自动配置原理-1">
<p>
1）、SpringBoot启动的时候加载主配置类，开启了自动配置功能
<code>=@EnableAutoConfiguration=</code>
</p>

<p>
<b>2）、@EnableAutoConfiguration 作用：</b>
</p>

<ul class="org-ul">
<li>利用EnableAutoConfigurationImportSelector给容器中导入一些组件？</li>

<li>可以查看selectImports()方法的内容；</li>

<li>List<String> configurations =
getCandidateConfigurations(annotationMetadata,
attributes);获取候选的配置</li>

<li><p>
#+BEGIN<sub>SRC</sub> java
    SpringFactoriesLoader.loadFactoryNames()
    扫描所有jar包类路径下  META-INF/spring.factories
    把扫描到的这些文件的内容包装成properties对象
    从properties中获取到EnableAutoConfiguration.class类（类名）对应的值，然后把他们添加在容器中
#+END<sub>SRC</sub>
</p>

<p>
​
</p></li>
</ul>

<p>
<b><code>=将 类路径下 META-INF/spring.factories
里面配置的所有EnableAutoConfiguration的值加入到了容器中；=</code></b>
</p>

<pre class="example">
# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\
org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\
org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\
org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\
org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\
org.springframework.boot.autoconfigure.cloud.CloudAutoConfiguration,\
org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\
org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\
org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\
org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.jest.JestAutoConfiguration,\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\
org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\
org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\
org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\
org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\
org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\
org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\
org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\
org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\
org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\
org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\
org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\
org.springframework.boot.autoconfigure.mobile.DeviceResolverAutoConfiguration,\
org.springframework.boot.autoconfigure.mobile.DeviceDelegatingViewResolverAutoConfiguration,\
org.springframework.boot.autoconfigure.mobile.SitePreferenceAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.reactor.ReactorAutoConfiguration,\
org.springframework.boot.autoconfigure.security.SecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.SecurityFilterAutoConfiguration,\
org.springframework.boot.autoconfigure.security.FallbackWebSecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.OAuth2AutoConfiguration,\
org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\
org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\
org.springframework.boot.autoconfigure.social.SocialWebAutoConfiguration,\
org.springframework.boot.autoconfigure.social.FacebookAutoConfiguration,\
org.springframework.boot.autoconfigure.social.LinkedInAutoConfiguration,\
org.springframework.boot.autoconfigure.social.TwitterAutoConfiguration,\
org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\
org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\
org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration,\
org.springframework.boot.autoconfigure.web.EmbeddedServletContainerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration,\
org.springframework.boot.autoconfigure.web.HttpMessageConvertersAutoConfiguration,\
org.springframework.boot.autoconfigure.web.MultipartAutoConfiguration,\
org.springframework.boot.autoconfigure.web.ServerPropertiesAutoConfiguration,\
org.springframework.boot.autoconfigure.web.WebClientAutoConfiguration,\
org.springframework.boot.autoconfigure.web.WebMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.WebSocketAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.WebSocketMessagingAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration
</pre>

<p>
每一个这样的
xxxAutoConfiguration类都是容器中的一个组件，都加入到容器中；用他们来做自动配置；
</p>

<p>
3）、每一个自动配置类进行自动配置功能；
</p>

<p>
4）、以*HttpEncodingAutoConfiguration（Http编码自动配置）*为例解释自动配置原理；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Configuration</span>   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#34920;&#31034;&#36825;&#26159;&#19968;&#20010;&#37197;&#32622;&#31867;&#65292;&#20197;&#21069;&#32534;&#20889;&#30340;&#37197;&#32622;&#25991;&#20214;&#19968;&#26679;&#65292;&#20063;&#21487;&#20197;&#32473;&#23481;&#22120;&#20013;&#28155;&#21152;&#32452;&#20214;</span>
<span style="color: #a45bad;">@EnableConfigurationProperties</span>(HttpEncodingProperties.<span style="color: #4f97d7; font-weight: bold;">class</span>)  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21551;&#21160;&#25351;&#23450;&#31867;&#30340;ConfigurationProperties&#21151;&#33021;&#65307;&#23558;&#37197;&#32622;&#25991;&#20214;&#20013;&#23545;&#24212;&#30340;&#20540;&#21644;HttpEncodingProperties&#32465;&#23450;&#36215;&#26469;&#65307;&#24182;&#25226;HttpEncodingProperties&#21152;&#20837;&#21040;ioc&#23481;&#22120;&#20013;</span>

<span style="color: #a45bad;">@ConditionalOnWebApplication</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Spring&#24213;&#23618;@Conditional&#27880;&#35299;&#65288;Spring&#27880;&#35299;&#29256;&#65289;&#65292;&#26681;&#25454;&#19981;&#21516;&#30340;&#26465;&#20214;&#65292;&#22914;&#26524;&#28385;&#36275;&#25351;&#23450;&#30340;&#26465;&#20214;&#65292;&#25972;&#20010;&#37197;&#32622;&#31867;&#37324;&#38754;&#30340;&#37197;&#32622;&#23601;&#20250;&#29983;&#25928;&#65307;    &#21028;&#26029;&#24403;&#21069;&#24212;&#29992;&#26159;&#21542;&#26159;web&#24212;&#29992;&#65292;&#22914;&#26524;&#26159;&#65292;&#24403;&#21069;&#37197;&#32622;&#31867;&#29983;&#25928;</span>

<span style="color: #a45bad;">@ConditionalOnClass</span>(CharacterEncodingFilter.<span style="color: #4f97d7; font-weight: bold;">class</span>)  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21028;&#26029;&#24403;&#21069;&#39033;&#30446;&#26377;&#27809;&#26377;&#36825;&#20010;&#31867;CharacterEncodingFilter&#65307;SpringMVC&#20013;&#36827;&#34892;&#20081;&#30721;&#35299;&#20915;&#30340;&#36807;&#28388;&#22120;&#65307;</span>

<span style="color: #a45bad;">@ConditionalOnProperty</span>(prefix = <span style="color: #2d9574;">"spring.http.encoding"</span>, value = <span style="color: #2d9574;">"enabled"</span>, matchIfMissing = <span style="color: #a45bad;">true</span>)  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21028;&#26029;&#37197;&#32622;&#25991;&#20214;&#20013;&#26159;&#21542;&#23384;&#22312;&#26576;&#20010;&#37197;&#32622;  spring.http.encoding.enabled&#65307;&#22914;&#26524;&#19981;&#23384;&#22312;&#65292;&#21028;&#26029;&#20063;&#26159;&#25104;&#31435;&#30340;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21363;&#20351;&#25105;&#20204;&#37197;&#32622;&#25991;&#20214;&#20013;&#19981;&#37197;&#32622;pring.http.encoding.enabled=true&#65292;&#20063;&#26159;&#40664;&#35748;&#29983;&#25928;&#30340;&#65307;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HttpEncodingAutoConfiguration</span> {

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20182;&#24050;&#32463;&#21644;SpringBoot&#30340;&#37197;&#32622;&#25991;&#20214;&#26144;&#23556;&#20102;</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">HttpEncodingProperties</span> <span style="color: #7590db;">properties</span>;

   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21482;&#26377;&#19968;&#20010;&#26377;&#21442;&#26500;&#36896;&#22120;&#30340;&#24773;&#20917;&#19979;&#65292;&#21442;&#25968;&#30340;&#20540;&#23601;&#20250;&#20174;&#23481;&#22120;&#20013;&#25343;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> HttpEncodingAutoConfiguration(<span style="color: #ce537a; font-weight: bold;">HttpEncodingProperties</span> <span style="color: #7590db;">properties</span>) {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.properties = properties;
    }

    <span style="color: #a45bad;">@Bean</span>   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#32473;&#23481;&#22120;&#20013;&#28155;&#21152;&#19968;&#20010;&#32452;&#20214;&#65292;&#36825;&#20010;&#32452;&#20214;&#30340;&#26576;&#20123;&#20540;&#38656;&#35201;&#20174;properties&#20013;&#33719;&#21462;</span>
    <span style="color: #a45bad;">@ConditionalOnMissingBean</span>(CharacterEncodingFilter.<span style="color: #4f97d7; font-weight: bold;">class</span>) <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21028;&#26029;&#23481;&#22120;&#27809;&#26377;&#36825;&#20010;&#32452;&#20214;&#65311;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">CharacterEncodingFilter</span> <span style="color: #bc6ec5; font-weight: bold;">characterEncodingFilter</span>() {
        <span style="color: #ce537a; font-weight: bold;">CharacterEncodingFilter</span> <span style="color: #7590db;">filter</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">OrderedCharacterEncodingFilter</span>();
        filter.setEncoding(<span style="color: #4f97d7; font-weight: bold;">this</span>.properties.getCharset().name());
        filter.setForceRequestEncoding(<span style="color: #4f97d7; font-weight: bold;">this</span>.properties.shouldForce(<span style="color: #a45bad;">Type</span>.REQUEST));
        filter.setForceResponseEncoding(<span style="color: #4f97d7; font-weight: bold;">this</span>.properties.shouldForce(<span style="color: #a45bad;">Type</span>.RESPONSE));
        <span style="color: #4f97d7; font-weight: bold;">return</span> filter;
    }
</pre>
</div>

<p>
根据当前不同的条件判断，决定这个配置类是否生效？
</p>

<p>
一但这个配置类生效；这个配置类就会给容器中添加各种组件；这些组件的属性是从对应的properties类中获取的，这些类里面的每一个属性又是和配置文件绑定的；
</p>

<p>
5）、所有在配置文件中能配置的属性都是在xxxxProperties类中封装者‘；配置文件能配置什么就可以参照某个功能对应的这个属性类
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"spring.http.encoding"</span>)  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#37197;&#32622;&#25991;&#20214;&#20013;&#33719;&#21462;&#25351;&#23450;&#30340;&#20540;&#21644;bean&#30340;&#23646;&#24615;&#36827;&#34892;&#32465;&#23450;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HttpEncodingProperties</span> {

   <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">Charset</span> <span style="color: #7590db;">DEFAULT_CHARSET</span> = Charset.forName(<span style="color: #2d9574;">"UTF-8"</span>);
</pre>
</div>

<p>
<b>精髓：</b>
</p>

<p>
​ <b>1）、SpringBoot启动会加载大量的自动配置类</b>
</p>

<p>
​ <b>2）、我们看我们需要的功能有没有SpringBoot默认写好的自动配置类；</b>
</p>

<p>
​
<b>3）、我们再来看这个自动配置类中到底配置了哪些组件；（只要我们要用的组件有，我们就不需要再来配置了）</b>
</p>

<p>
​
<b>4）、给容器中自动配置类添加组件的时候，会从properties类中获取某些属性。我们就可以在配置文件中指定这些属性的值；</b>
</p>

<p>
xxxxAutoConfigurartion：自动配置类；
</p>

<p>
给容器中添加组件
</p>

<p>
xxxxProperties:封装配置文件中相关属性；
</p>
</div>
</li>

<li><a id="细节"></a>2、细节<br />
<div class="outline-text-6" id="text-细节">
</div>

<ul class="org-ul">
<li><a id="conditional派生注解spring注解版原生的conditional作用"></a>1、@Conditional派生注解（Spring注解版原生的@Conditional作用）<br />
<div class="outline-text-7" id="text-conditional派生注解spring注解版原生的conditional作用">
<p>
作用：必须是@Conditional指定的条件成立，才给容器中添加组件，配置配里面的所有内容才生效；
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">@Conditional扩展注解</th>
<th scope="col" class="org-left">作用（判断是否满足当前指定条件）</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">@ConditionalOnJava</td>
<td class="org-left">系统的java版本是否符合要求</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnBean</td>
<td class="org-left">容器中存在指定Bean；</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnMissingBean</td>
<td class="org-left">容器中不存在指定Bean；</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnExpression</td>
<td class="org-left">满足SpEL表达式指定</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnClass</td>
<td class="org-left">系统中有指定的类</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnMissingClass</td>
<td class="org-left">系统中没有指定的类</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnSingleCandidate</td>
<td class="org-left">容器中只有一个指定的Bean，或者这个Bean是首选Bean</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnProperty</td>
<td class="org-left">系统中指定的属性是否有指定的值</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnResource</td>
<td class="org-left">类路径下是否存在指定资源文件</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnWebApplication</td>
<td class="org-left">当前是web环境</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnNotWebApplication</td>
<td class="org-left">当前不是web环境</td>
</tr>

<tr>
<td class="org-left">@ConditionalOnJndi</td>
<td class="org-left">JNDI存在指定项</td>
</tr>
</tbody>
</table>

<p>
<b>自动配置类必须在一定的条件下才能生效；</b>
</p>

<p>
我们怎么知道哪些自动配置类生效；
</p>

<p>
*==我们可以通过启用
debug=true属性；来让控制台打印自动配置报告==*，这样我们就可以很方便的知道哪些自动配置类生效；
</p>

<div class="org-src-container">
<pre class="src src-java">=========================
AUTO-CONFIGURATION REPORT
=========================


Positive matches:&#65288;&#33258;&#21160;&#37197;&#32622;&#31867;&#21551;&#29992;&#30340;&#65289;
-----------------

   DispatcherServletAutoConfiguration matched:
      - <span style="color: #a45bad;">@ConditionalOnClass</span> found required <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #dc752f; background-color: #292b2e;">'</span><span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">web</span>.<span style="color: #a45bad;">servlet</span>.DispatcherServlet<span style="color: #dc752f; background-color: #292b2e;">'</span>; <span style="color: #a45bad;">@ConditionalOnMissingClass</span> did not find <span style="color: #ce537a; font-weight: bold;">unwanted</span> <span style="color: #4f97d7; font-weight: bold;">class</span> (OnClassCondition)
      - <span style="color: #a45bad;">@ConditionalOnWebApplication</span> (required) found StandardServletEnvironment (OnWebApplicationCondition)


Negative matches:&#65288;&#27809;&#26377;&#21551;&#21160;&#65292;&#27809;&#26377;&#21305;&#37197;&#25104;&#21151;&#30340;&#33258;&#21160;&#37197;&#32622;&#31867;&#65289;
-----------------

   ActiveMQAutoConfiguration:
      Did not match:
         - <span style="color: #a45bad;">@ConditionalOnClass</span> did not find required classes <span style="color: #dc752f; background-color: #292b2e;">'</span><span style="color: #a45bad;">javax</span>.<span style="color: #a45bad;">jms</span>.ConnectionFactory<span style="color: #dc752f; background-color: #292b2e;">'</span>, <span style="color: #dc752f; background-color: #292b2e;">'</span><span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">apache</span>.<span style="color: #a45bad;">activemq</span>.ActiveMQConnectionFactory<span style="color: #dc752f; background-color: #292b2e;">'</span> (<span style="color: #ce537a; font-weight: bold;">OnClassCondition</span>)

   AopAutoConfiguration:
      Did not match:
         - <span style="color: #a45bad;">@ConditionalOnClass</span> did not find required classes <span style="color: #dc752f; background-color: #292b2e;">'</span><span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">aspectj</span>.<span style="color: #a45bad;">lang</span>.<span style="color: #a45bad;">annotation</span>.Aspect<span style="color: #dc752f; background-color: #292b2e;">'</span>, <span style="color: #dc752f; background-color: #292b2e;">'</span><span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">aspectj</span>.<span style="color: #a45bad;">lang</span>.<span style="color: #a45bad;">reflect</span>.Advice<span style="color: #dc752f; background-color: #292b2e;">'</span> (OnClassCondition)

</pre>
</div>
</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgaf7ec95" class="outline-4">
<h4 id="三日志">三、日志</h4>
<div class="outline-text-4" id="text-三日志">
</div>

<ul class="org-ul">
<li><a id="日志框架"></a>1、日志框架<br />
<div class="outline-text-5" id="text-日志框架">
<p>
小张；开发一个大型系统；
</p>

<p>
​
1、System.out.println("")；将关键数据打印在控制台；去掉？写在一个文件？
</p>

<p>
​ 2、框架来记录系统的一些运行时信息；日志框架 ； zhanglogging.jar；
</p>

<p>
​ 3、高大上的几个功能？异步模式？自动归档？xxxx？
zhanglogging-good.jar？
</p>

<p>
​
4、将以前框架卸下来？换上新的框架，重新修改之前相关的API；zhanglogging-prefect.jar；
</p>

<p>
​ 5、JDBC&#x2014;数据库驱动；
</p>

<p>
​
写了一个统一的接口层；日志门面（日志的一个抽象层）；logging-abstract.jar；
</p>

<p>
​ 给项目中导入具体的日志实现就行了；我们之前的日志框架都是实现的抽象层；
</p>

<p>
<b>市面上的日志框架；</b>
</p>

<p>
JUL、JCL、Jboss-logging、logback、log4j、log4j2、slf4j&#x2026;.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">日志门面 （日志的抽象层）</th>
<th scope="col" class="org-left">日志实现</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><del>JCL（Jakarta Commons Logging）</del> SLF4j（Simple Logging Facade for Java） <b><del>jboss-logging</del></b></td>
<td class="org-left">Log4j JUL（java.util.logging） Log4j2 <b>Logback</b></td>
</tr>
</tbody>
</table>

<p>
左边选一个门面（抽象层）、右边来选一个实现；
</p>

<p>
日志门面： SLF4J；
</p>

<p>
日志实现：Logback；
</p>

<p>
SpringBoot：底层是Spring框架，Spring框架默认是用JCL；‘
</p>

<p>
​ <b><code>=SpringBoot选用 SLF4j和logback；=</code></b>
</p>
</div>
</li>

<li><a id="slf4j使用"></a>2、SLF4j使用<br />
<div class="outline-text-5" id="text-slf4j使用">
</div>

<ul class="org-ul">
<li><a id="如何在系统中使用slf4j-httpswww.slf4j.org"></a>1、如何在系统中使用SLF4j <a href="https://www.slf4j.org">https://www.slf4j.org</a><br />
<div class="outline-text-6" id="text-如何在系统中使用slf4j-httpswww.slf4j.org">
<p>
以后开发的时候，日志记录方法的调用，不应该来直接调用日志的实现类，而是调用日志抽象层里面的方法；
</p>

<p>
给系统里面导入slf4j的jar和 logback的实现jar
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">slf4j</span>.<span style="color: #ce537a; font-weight: bold;">Logger</span>;
<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">slf4j</span>.<span style="color: #ce537a; font-weight: bold;">LoggerFactory</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloWorld</span> {
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>(<span style="color: #ce537a; font-weight: bold;">String</span>[] <span style="color: #7590db;">args</span>) {
    <span style="color: #ce537a; font-weight: bold;">Logger</span> <span style="color: #7590db;">logger</span> = LoggerFactory.getLogger(HelloWorld.<span style="color: #4f97d7; font-weight: bold;">class</span>);
    logger.info(<span style="color: #2d9574;">"Hello World"</span>);
  }
}
</pre>
</div>

<p>
图示；
</p>


<div class="figure">
<p><img src="images/concrete-bindings.png" alt="concrete-bindings.png" />
</p>
<p><span class="figure-number">Figure 5: </span>images/concrete-bindings.png</p>
</div>

<p>
每一个日志的实现框架都有自己的配置文件。使用slf4j以后，*配置文件还是做成日志实现框架自己本身的配置文件；*
</p>
</div>
</li>

<li><a id="遗留问题"></a>2、遗留问题<br />
<div class="outline-text-6" id="text-遗留问题">
<p>
a（slf4j+logback）:
Spring（commons-logging）、Hibernate（jboss-logging）、MyBatis、xxxx
</p>

<p>
统一日志记录，即使是别的框架和我一起统一使用slf4j进行输出？
</p>


<div class="figure">
<p><img src="images/legacy.png" alt="legacy.png" />
</p>
</div>

<p>
<b>如何让系统中所有的日志都统一到slf4j；</b>
</p>

<p>
<code>=1、将系统中其他日志框架先排除出去；=</code>
</p>

<p>
<code>=2、用中间包来替换原有的日志框架；=</code>
</p>

<p>
<code>=3、我们导入slf4j其他的实现=</code>
</p>
</div>
</li>
</ul>
</li>

<li><a id="springboot日志关系"></a>3、SpringBoot日志关系<br />
<div class="outline-text-5" id="text-springboot日志关系">
<pre class="example">
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre>

<p>
SpringBoot使用它来做日志功能；
</p>

<pre class="example">
&lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
    &lt;/dependency&gt;
</pre>

<p>
底层依赖关系
</p>


<div class="figure">
<p><img src="images/搜狗截图20180131220946.png" alt="搜狗截图20180131220946.png" />
</p>
</div>

<p>
总结：
</p>

<p>
​ 1）、SpringBoot底层也是使用slf4j+logback的方式进行日志记录
</p>

<p>
​ 2）、SpringBoot也把其他的日志都替换成了slf4j；
</p>

<p>
​ 3）、中间替换包？
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@SuppressWarnings</span>(<span style="color: #2d9574;">"rawtypes"</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">abstract</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">LogFactory</span> {

    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">UNSUPPORTED_OPERATION_IN_JCL_OVER_SLF4J</span> = <span style="color: #2d9574;">"http://www.slf4j.org/codes.html#unsupported_operation_in_jcl_over_slf4j"</span>;

    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">LogFactory</span> <span style="color: #7590db;">logFactory</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">SLF4JLogFactory</span>();
</pre>
</div>


<div class="figure">
<p><img src="images/搜狗截图20180131221411.png" alt="搜狗截图20180131221411.png" />
</p>
</div>

<p>
​ 4）、如果我们要引入其他框架？一定要把这个框架的默认日志依赖移除掉？
</p>

<p>
​ Spring框架用的是commons-logging；
</p>

<pre class="example">
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;commons-logging&lt;/groupId&gt;
            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
</pre>

<p>
<b><code>=SpringBoot能自动适配所有的日志，而且底层使用slf4j+logback的方式记录日志，引入其他框架的时候，只需要把这个框架依赖的日志框架排除掉即可；=</code></b>
</p>
</div>
</li>

<li><a id="日志使用"></a>4、日志使用；<br />
<div class="outline-text-5" id="text-日志使用">
</div>

<ul class="org-ul">
<li><a id="默认配置"></a>1、默认配置<br />
<div class="outline-text-6" id="text-默认配置">
<p>
SpringBoot默认帮我们配置好了日志；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#35760;&#24405;&#22120;</span>
<span style="color: #ce537a; font-weight: bold;">Logger</span> <span style="color: #7590db;">logger</span> = LoggerFactory.getLogger(getClass());
<span style="color: #a45bad;">@Test</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">contextLoads</span>() {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">System.out.println();</span>

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#26085;&#24535;&#30340;&#32423;&#21035;&#65307;</span>
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#30001;&#20302;&#21040;&#39640;   trace&lt;debug&lt;info&lt;warn&lt;error</span>
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#20197;&#35843;&#25972;&#36755;&#20986;&#30340;&#26085;&#24535;&#32423;&#21035;&#65307;&#26085;&#24535;&#23601;&#21482;&#20250;&#22312;&#36825;&#20010;&#32423;&#21035;&#20197;&#20197;&#21518;&#30340;&#39640;&#32423;&#21035;&#29983;&#25928;</span>
    logger.trace(<span style="color: #2d9574;">"&#36825;&#26159;trace&#26085;&#24535;..."</span>);
    logger.debug(<span style="color: #2d9574;">"&#36825;&#26159;debug&#26085;&#24535;..."</span>);
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">SpringBoot&#40664;&#35748;&#32473;&#25105;&#20204;&#20351;&#29992;&#30340;&#26159;info&#32423;&#21035;&#30340;&#65292;&#27809;&#26377;&#25351;&#23450;&#32423;&#21035;&#30340;&#23601;&#29992;SpringBoot&#40664;&#35748;&#35268;&#23450;&#30340;&#32423;&#21035;&#65307;root&#32423;&#21035;</span>
    logger.info(<span style="color: #2d9574;">"&#36825;&#26159;info&#26085;&#24535;..."</span>);
    logger.warn(<span style="color: #2d9574;">"&#36825;&#26159;warn&#26085;&#24535;..."</span>);
    logger.error(<span style="color: #2d9574;">"&#36825;&#26159;error&#26085;&#24535;..."</span>);


}
</pre>
</div>

<pre class="example">
日志输出格式：
    %d表示日期时间，
    %thread表示线程名，
    %-5level：级别从左显示5个字符宽度
    %logger{50} 表示logger名字最长50个字符，否则按照句点分割。 
    %msg：日志消息，
    %n是换行符
--&gt;
%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n
</pre>

<p>
SpringBoot修改日志的默认配置
</p>

<pre class="example">
logging.level.com.atguigu=trace


#logging.path=
# 不指定路径在当前项目下生成springboot.log日志
# 可以指定完整的路径；
#logging.file=G:/springboot.log

# 在当前磁盘的根路径下创建spring文件夹和里面的log文件夹；使用 spring.log 作为默认文件
logging.path=/spring/log

#  在控制台输出的日志的格式
logging.pattern.console=%d{yyyy-MM-dd} [%thread] %-5level %logger{50} - %msg%n
# 指定文件中日志输出的格式
logging.pattern.file=%d{yyyy-MM-dd} === [%thread] === %-5level === %logger{50} ==== %msg%n
</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">logging.file</th>
<th scope="col" class="org-left">logging.path</th>
<th scope="col" class="org-left">Example</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(none)</td>
<td class="org-left">(none)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">只在控制台输出</td>
</tr>

<tr>
<td class="org-left">指定文件名</td>
<td class="org-left">(none)</td>
<td class="org-left">my.log</td>
<td class="org-left">输出日志到my.log文件</td>
</tr>

<tr>
<td class="org-left">(none)</td>
<td class="org-left">指定目录</td>
<td class="org-left">/var/log</td>
<td class="org-left">输出到指定目录的 spring.log 文件中</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="指定配置"></a>2、指定配置<br />
<div class="outline-text-6" id="text-指定配置">
<p>
给类路径下放上每个日志框架自己的配置文件即可；SpringBoot就不使用他默认配置的了
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Logging System</th>
<th scope="col" class="org-left">Customization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Logback</td>
<td class="org-left"><code>logback-spring.xml</code>, <code>logback-spring.groovy</code>, <code>logback.xml</code> or <code>logback.groovy</code></td>
</tr>

<tr>
<td class="org-left">Log4j2</td>
<td class="org-left"><code>log4j2-spring.xml</code> or <code>log4j2.xml</code></td>
</tr>

<tr>
<td class="org-left">JDK (Java Util Logging)</td>
<td class="org-left"><code>logging.properties</code></td>
</tr>
</tbody>
</table>

<p>
logback.xml：直接就被日志框架识别了；
</p>

<p>
*logback-spring.xml*：日志框架就不直接加载日志的配置项，由SpringBoot解析日志配置，可以使用SpringBoot的高级Profile功能
</p>

<pre class="example">
&lt;springProfile name="staging"&gt;
    &lt;!-- configuration to be enabled when the "staging" profile is active --&gt;
    可以指定某段配置只在某个环境下生效
&lt;/springProfile&gt;
</pre>

<p>
如：
</p>

<pre class="example">
&lt;appender name="stdout" class="ch.qos.logback.core.ConsoleAppender"&gt;
        &lt;!--
        日志输出格式：
            %d表示日期时间，
            %thread表示线程名，
            %-5level：级别从左显示5个字符宽度
            %logger{50} 表示logger名字最长50个字符，否则按照句点分割。 
            %msg：日志消息，
            %n是换行符
        --&gt;
        &lt;layout class="ch.qos.logback.classic.PatternLayout"&gt;
            &lt;springProfile name="dev"&gt;
                &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} ----&gt; [%thread] ---&gt; %-5level %logger{50} - %msg%n&lt;/pattern&gt;
            &lt;/springProfile&gt;
            &lt;springProfile name="!dev"&gt;
                &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} ==== [%thread] ==== %-5level %logger{50} - %msg%n&lt;/pattern&gt;
            &lt;/springProfile&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
</pre>

<p>
如果使用logback.xml作为日志配置文件，还要使用profile功能，会有以下错误
</p>

<p>
<code>no applicable action for [springProfile]</code>
</p>
</div>
</li>
</ul>
</li>

<li><a id="切换日志框架"></a>5、切换日志框架<br />
<div class="outline-text-5" id="text-切换日志框架">
<p>
可以按照slf4j的日志适配图，进行相关的切换；
</p>

<p>
slf4j+log4j的方式；
</p>

<pre class="example">
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
  &lt;exclusions&gt;
    &lt;exclusion&gt;
      &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
    &lt;/exclusion&gt;
    &lt;exclusion&gt;
      &lt;artifactId&gt;log4j-over-slf4j&lt;/artifactId&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;/exclusion&gt;
  &lt;/exclusions&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre>

<p>
切换为log4j2
</p>

<pre class="example">
   &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre>

<hr />
</div>
</li>
</ul>
</div>
<div id="outline-container-org69a156e" class="outline-4">
<h4 id="四web开发">四、Web开发</h4>
<div class="outline-text-4" id="text-四web开发">
</div>

<ul class="org-ul">
<li><a id="简介"></a>1、简介<br />
<div class="outline-text-5" id="text-简介">
<p>
使用SpringBoot；
</p>

<p>
<b>1）、创建SpringBoot应用，选中我们需要的模块；</b>
</p>

<p>
<b>2）、SpringBoot已经默认将这些场景配置好了，只需要在配置文件中指定少量配置就可以运行起来</b>
</p>

<p>
<b>3）、自己编写业务代码；</b>
</p>

<p>
<b>自动配置原理？</b>
</p>

<p>
这个场景SpringBoot帮我们配置了什么？能不能修改？能修改哪些配置？能不能扩展？xxx
</p>

<pre class="example">
xxxxAutoConfiguration：帮我们给容器中自动配置组件；
xxxxProperties:配置类来封装配置文件的内容；
</pre>
</div>
</li>

<li><a id="springboot对静态资源的映射规则"></a>2、SpringBoot对静态资源的映射规则；<br />
<div class="outline-text-5" id="text-springboot对静态资源的映射规则">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"spring.resources"</span>, ignoreUnknownFields = <span style="color: #a45bad;">false</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ResourceProperties</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">ResourceLoaderAware</span> {
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#20197;&#35774;&#32622;&#21644;&#38745;&#24577;&#36164;&#28304;&#26377;&#20851;&#30340;&#21442;&#25968;&#65292;&#32531;&#23384;&#26102;&#38388;&#31561;</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-java">WebMvcAuotConfiguration&#65306;
    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addResourceHandlers</span>(<span style="color: #ce537a; font-weight: bold;">ResourceHandlerRegistry</span> <span style="color: #7590db;">registry</span>) {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span><span style="color: #4f97d7; font-weight: bold;">this</span>.resourceProperties.isAddMappings()) {
            logger.debug(<span style="color: #2d9574;">"Default resource handling disabled"</span>);
            <span style="color: #4f97d7; font-weight: bold;">return</span>;
        }
        <span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">cachePeriod</span> = <span style="color: #4f97d7; font-weight: bold;">this</span>.resourceProperties.getCachePeriod();
        <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span>registry.hasMappingForPattern(<span style="color: #2d9574;">"/webjars/**"</span>)) {
            customizeResourceHandlerRegistration(
                    registry.addResourceHandler(<span style="color: #2d9574;">"/webjars/**"</span>)
                            .addResourceLocations(
                                    <span style="color: #2d9574;">"classpath:/META-INF/resources/webjars/"</span>)
                    .setCachePeriod(cachePeriod));
        }
        <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">staticPathPattern</span> = <span style="color: #4f97d7; font-weight: bold;">this</span>.mvcProperties.getStaticPathPattern();
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#36164;&#28304;&#25991;&#20214;&#22841;&#26144;&#23556;</span>
        <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span>registry.hasMappingForPattern(staticPathPattern)) {
            customizeResourceHandlerRegistration(
                    registry.addResourceHandler(staticPathPattern)
                            .addResourceLocations(
                                    <span style="color: #4f97d7; font-weight: bold;">this</span>.resourceProperties.getStaticLocations())
                    .setCachePeriod(cachePeriod));
        }
    }

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#37197;&#32622;&#27426;&#36814;&#39029;&#26144;&#23556;</span>
    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">WelcomePageHandlerMapping</span> <span style="color: #bc6ec5; font-weight: bold;">welcomePageHandlerMapping</span>(
            <span style="color: #ce537a; font-weight: bold;">ResourceProperties</span> <span style="color: #7590db;">resourceProperties</span>) {
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">WelcomePageHandlerMapping</span>(resourceProperties.getWelcomePage(),
                <span style="color: #4f97d7; font-weight: bold;">this</span>.mvcProperties.getStaticPathPattern());
    }

   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#37197;&#32622;&#21916;&#27426;&#30340;&#22270;&#26631;</span>
    <span style="color: #a45bad;">@Configuration</span>
    <span style="color: #a45bad;">@ConditionalOnProperty</span>(value = <span style="color: #2d9574;">"spring.mvc.favicon.enabled"</span>, matchIfMissing = <span style="color: #a45bad;">true</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">FaviconConfiguration</span> {

        <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">ResourceProperties</span> <span style="color: #7590db;">resourceProperties</span>;

        <span style="color: #4f97d7; font-weight: bold;">public</span> FaviconConfiguration(<span style="color: #ce537a; font-weight: bold;">ResourceProperties</span> <span style="color: #7590db;">resourceProperties</span>) {
            <span style="color: #4f97d7; font-weight: bold;">this</span>.resourceProperties = resourceProperties;
        }

        <span style="color: #a45bad;">@Bean</span>
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">SimpleUrlHandlerMapping</span> <span style="color: #bc6ec5; font-weight: bold;">faviconHandlerMapping</span>() {
            <span style="color: #ce537a; font-weight: bold;">SimpleUrlHandlerMapping</span> <span style="color: #7590db;">mapping</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">SimpleUrlHandlerMapping</span>();
            mapping.setOrder(<span style="color: #a45bad;">Ordered</span>.HIGHEST_PRECEDENCE + 1);
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25152;&#26377;  **/favicon.ico </span>
            mapping.setUrlMap(Collections.singletonMap(<span style="color: #2d9574;">"**/favicon.ico"</span>,
                    faviconRequestHandler()));
            <span style="color: #4f97d7; font-weight: bold;">return</span> mapping;
        }

        <span style="color: #a45bad;">@Bean</span>
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ResourceHttpRequestHandler</span> <span style="color: #bc6ec5; font-weight: bold;">faviconRequestHandler</span>() {
            <span style="color: #ce537a; font-weight: bold;">ResourceHttpRequestHandler</span> <span style="color: #7590db;">requestHandler</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ResourceHttpRequestHandler</span>();
            requestHandler
                    .setLocations(<span style="color: #4f97d7; font-weight: bold;">this</span>.resourceProperties.getFaviconLocations());
            <span style="color: #4f97d7; font-weight: bold;">return</span> requestHandler;
        }

    }
</pre>
</div>

<p>
<code>=1）、所有 /webjars/** ，都去 classpath:/META-INF/resources/webjars/
找资源；=</code>
</p>

<p>
​ webjars：以jar包的方式引入静态资源；
</p>

<p>
<a href="http://www.webjars.org/">http://www.webjars.org/</a>
</p>


<div class="figure">
<p><img src="images/搜狗截图20180203181751.png" alt="搜狗截图20180203181751.png" />
</p>
</div>

<p>
localhost:8080/webjars/jquery/3.3.1/jquery.js
</p>

<pre class="example">
&lt;!--引入jquery-webjar--&gt;在访问的时候只需要写webjars下面资源的名称即可
        &lt;dependency&gt;
            &lt;groupId&gt;org.webjars&lt;/groupId&gt;
            &lt;artifactId&gt;jquery&lt;/artifactId&gt;
            &lt;version&gt;3.3.1&lt;/version&gt;
        &lt;/dependency&gt;
</pre>

<p>
<code>=2）、"/**" 访问当前项目的任何资源，都去（静态资源的文件夹）找映射=</code>
</p>

<pre class="example">
"classpath:/META-INF/resources/", 
"classpath:/resources/",
"classpath:/static/", 
"classpath:/public/" 
"/"：当前项目的根路径
</pre>

<p>
localhost:8080/abc <code>=</code> 去静态资源文件夹里面找abc
</p>

<p>
<code>=3）、欢迎页； 静态资源文件夹下的所有index.html页面；被"/**"映射；=</code>
</p>

<p>
​ localhost:8080/ 找index页面
</p>

<p>
<code>=4）、所有的 **/favicon.ico 都是在静态资源文件下找；=</code>
</p>
</div>
</li>

<li><a id="模板引擎"></a>3、模板引擎<br />
<div class="outline-text-5" id="text-模板引擎">
<p>
JSP、Velocity、Freemarker、Thymeleaf
</p>


<div class="figure">
<p><img src="images/template-engine.png" alt="template-engine.png" />
</p>
</div>

<p>
SpringBoot推荐的Thymeleaf；
</p>

<p>
语法更简单，功能更强大；
</p>
</div>

<ul class="org-ul">
<li><a id="引入thymeleaf"></a>1、引入thymeleaf；<br />
<div class="outline-text-6" id="text-引入thymeleaf">
<pre class="example">
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
            2.1.6
        &lt;/dependency&gt;
切换thymeleaf版本
&lt;properties&gt;
        &lt;thymeleaf.version&gt;3.0.9.RELEASE&lt;/thymeleaf.version&gt;
        &lt;!-- 布局功能的支持程序  thymeleaf3主程序  layout2以上版本 --&gt;
        &lt;!-- thymeleaf2   layout1--&gt;
        &lt;thymeleaf-layout-dialect.version&gt;2.2.2&lt;/thymeleaf-layout-dialect.version&gt;
  &lt;/properties&gt;
</pre>
</div>
</li>

<li><a id="thymeleaf使用"></a>2、Thymeleaf使用<br />
<div class="outline-text-6" id="text-thymeleaf使用">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"spring.thymeleaf"</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ThymeleafProperties</span> {

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">Charset</span> <span style="color: #7590db;">DEFAULT_ENCODING</span> = Charset.forName(<span style="color: #2d9574;">"UTF-8"</span>);

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">MimeType</span> <span style="color: #7590db;">DEFAULT_CONTENT_TYPE</span> = MimeType.valueOf(<span style="color: #2d9574;">"text/html"</span>);

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">DEFAULT_PREFIX</span> = <span style="color: #2d9574;">"classpath:/templates/"</span>;

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">DEFAULT_SUFFIX</span> = <span style="color: #2d9574;">".html"</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">//</span>
</pre>
</div>

<p>
只要我们把HTML页面放在classpath:/templates/，thymeleaf就能自动渲染；
</p>

<p>
使用：
</p>

<p>
1、导入thymeleaf的名称空间
</p>

<pre class="example">
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
</pre>

<p>
2、使用thymeleaf语法；
</p>

<pre class="example">
&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;成功！&lt;/h1&gt;
    &lt;!--th:text 将div里面的文本内容设置为 --&gt;
    &lt;div th:text="${hello}"&gt;这是显示欢迎信息&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>
</li>

<li><a id="语法规则"></a>3、语法规则<br />
<div class="outline-text-6" id="text-语法规则">
<p>
1）、th:text；改变当前元素里面的文本内容；
</p>

<p>
​ th：任意html属性；来替换原生属性的值
</p>


<div class="figure">
<p><img src="images/2018-02-04_123955.png" alt="2018-02-04_123955.png" />
</p>
</div>

<p>
2）、表达式？
</p>

<pre class="example">
Simple expressions:（表达式语法）
    Variable Expressions: ${...}：获取变量值；OGNL；
            1）、获取对象的属性、调用方法
            2）、使用内置的基本对象：
                #ctx : the context object.
                #vars: the context variables.
                #locale : the context locale.
                #request : (only in Web Contexts) the HttpServletRequest object.
                #response : (only in Web Contexts) the HttpServletResponse object.
                #session : (only in Web Contexts) the HttpSession object.
                #servletContext : (only in Web Contexts) the ServletContext object.

                ${session.foo}
            3）、内置的一些工具对象：
#execInfo : information about the template being processed.
#messages : methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using #{…} syntax.
#uris : methods for escaping parts of URLs/URIs
#conversions : methods for executing the configured conversion service (if any).
#dates : methods for java.util.Date objects: formatting, component extraction, etc.
#calendars : analogous to #dates , but for java.util.Calendar objects.
#numbers : methods for formatting numeric objects.
#strings : methods for String objects: contains, startsWith, prepending/appending, etc.
#objects : methods for objects in general.
#bools : methods for boolean evaluation.
#arrays : methods for arrays.
#lists : methods for lists.
#sets : methods for sets.
#maps : methods for maps.
#aggregates : methods for creating aggregates on arrays or collections.
#ids : methods for dealing with id attributes that might be repeated (for example, as a result of an iteration).

    Selection Variable Expressions: *{...}：选择表达式：和${}在功能上是一样；
        补充：配合 th:object="${session.user}：
   &lt;div th:object="${session.user}"&gt;
    &lt;p&gt;Name: &lt;span th:text="*{firstName}"&gt;Sebastian&lt;/span&gt;.&lt;/p&gt;
    &lt;p&gt;Surname: &lt;span th:text="*{lastName}"&gt;Pepper&lt;/span&gt;.&lt;/p&gt;
    &lt;p&gt;Nationality: &lt;span th:text="*{nationality}"&gt;Saturn&lt;/span&gt;.&lt;/p&gt;
    &lt;/div&gt;

    Message Expressions: #{...}：获取国际化内容
    Link URL Expressions: @{...}：定义URL；
            @{/order/process(execId=${execId},execType='FAST')}
    Fragment Expressions: ~{...}：片段引用表达式
            &lt;div th:insert="~{commons :: main}"&gt;...&lt;/div&gt;

Literals（字面量）
      Text literals: 'one text' , 'Another one!' ,…
      Number literals: 0 , 34 , 3.0 , 12.3 ,…
      Boolean literals: true , false
      Null literal: null
      Literal tokens: one , sometext , main ,…
Text operations:（文本操作）
    String concatenation: +
    Literal substitutions: |The name is ${name}|
Arithmetic operations:（数学运算）
    Binary operators: + , - , * , / , %
    Minus sign (unary operator): -
Boolean operations:（布尔运算）
    Binary operators: and , or
    Boolean negation (unary operator): ! , not
Comparisons and equality:（比较运算）
    Comparators: &gt; , &lt; , &gt;= , &lt;= ( gt , lt , ge , le )
    Equality operators: == , != ( eq , ne )
Conditional operators:条件运算（三元运算符）
    If-then: (if) ? (then)
    If-then-else: (if) ? (then) : (else)
    Default: (value) ?: (defaultvalue)
Special tokens:
    No-Operation: _ 
</pre>
</div>
</li>
</ul>
</li>

<li><a id="springmvc自动配置"></a>4、SpringMVC自动配置<br />
<div class="outline-text-5" id="text-springmvc自动配置">
<p>
<a href="https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications">https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications</a>
</p>
</div>

<ul class="org-ul">
<li><a id="spring-mvc-auto-configuration"></a>1. Spring MVC auto-configuration<br />
<div class="outline-text-6" id="text-spring-mvc-auto-configuration">
<p>
Spring Boot 自动配置好了SpringMVC
</p>

<p>
以下是SpringBoot对SpringMVC的默认配置:*==（WebMvcAutoConfiguration）==*
</p>

<ul class="org-ul">
<li>Inclusion of <code>ContentNegotiatingViewResolver</code> and
<code>BeanNameViewResolver</code> beans.</li>
<li>自动配置了ViewResolver（视图解析器：根据方法的返回值得到视图对象（View），视图对象决定如何渲染（转发？重定向？））</li>
<li>ContentNegotiatingViewResolver：组合所有的视图解析器的；</li>
<li><code>=如何定制：我们可以自己给容器中添加一个视图解析器；自动的将其组合进来；=</code></li>

<li>Support for serving static resources, including support for WebJars
(see below).静态资源文件夹路径,webjars</li>

<li>Static <code>index.html</code> support. 静态首页访问</li>

<li>Custom <code>Favicon</code> support (see below). favicon.ico</li>
</ul>

<p>
​
</p>

<ul class="org-ul">
<li>自动注册了 of <code>Converter</code>, <code>GenericConverter</code>, <code>Formatter</code> beans.</li>

<li>Converter：转换器； public String hello(User
user)：类型转换使用Converter</li>
<li><code>Formatter</code> 格式化器； 2017.12.17===Date；</li>
</ul>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Bean</span>
<span style="color: #a45bad;">@ConditionalOnProperty</span>(prefix = <span style="color: #2d9574;">"spring.mvc"</span>, name = <span style="color: #2d9574;">"date-format"</span>)<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;&#25991;&#20214;&#20013;&#37197;&#32622;&#26085;&#26399;&#26684;&#24335;&#21270;&#30340;&#35268;&#21017;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Formatter</span>&lt;<span style="color: #ce537a; font-weight: bold;">Date</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">dateFormatter</span>() {
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">DateFormatter</span>(<span style="color: #4f97d7; font-weight: bold;">this</span>.mvcProperties.getDateFormat());<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#26085;&#26399;&#26684;&#24335;&#21270;&#32452;&#20214;</span>
}
</pre>
</div>

<p>
​ <code>=自己添加的格式化器转换器，我们只需要放在容器中即可=</code>
</p>

<ul class="org-ul">
<li>Support for <code>HttpMessageConverters</code> (see below).</li>

<li>HttpMessageConverter：SpringMVC用来转换Http请求和响应的；User&#x2014;Json；</li>

<li><p>
<code>HttpMessageConverters</code>
是从容器中确定；获取所有的HttpMessageConverter；
</p>

<p>
<code>=自己给容器中添加HttpMessageConverter，只需要将自己的组件注册容器中（@Bean,@Component）=</code>
</p>

<p>
​
</p></li>

<li>Automatic registration of <code>MessageCodesResolver</code> (see
below).定义错误代码生成规则</li>

<li>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (see
below).</li>
</ul>

<p>
<code>=我们可以配置一个ConfigurableWebBindingInitializer来替换默认的；（添加到容器）=</code>
</p>

<p>
<code>初始化WebDataBinder；   请求数据=====JavaBean；</code>
</p>

<p>
<b>org.springframework.boot.autoconfigure.web：web的所有自动场景；</b>
</p>

<p>
If you want to keep Spring Boot MVC features, and you just want to add
additional
<a href="https://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/htmlsingle#mvc">MVC
configuration</a> (interceptors, formatters, view controllers etc.) you
can add your own <code>@Configuration</code> class of type
<code>WebMvcConfigurerAdapter</code>, but <b>without</b> <code>@EnableWebMvc</code>. If you wish to
provide custom instances of <code>RequestMappingHandlerMapping</code>,
<code>RequestMappingHandlerAdapter</code> or <code>ExceptionHandlerExceptionResolver</code>
you can declare a <code>WebMvcRegistrationsAdapter</code> instance providing such
components.
</p>

<p>
If you want to take complete control of Spring MVC, you can add your own
<code>@Configuration</code> annotated with <code>@EnableWebMvc</code>.
</p>
</div>
</li>

<li><a id="扩展springmvc"></a>2、扩展SpringMVC<br />
<div class="outline-text-6" id="text-扩展springmvc">
<pre class="example">
&lt;mvc:view-controller path="/hello" view-name="success"/&gt;
&lt;mvc:interceptors&gt;
    &lt;mvc:interceptor&gt;
        &lt;mvc:mapping path="/hello"/&gt;
        &lt;bean&gt;&lt;/bean&gt;
    &lt;/mvc:interceptor&gt;
&lt;/mvc:interceptors&gt;
</pre>

<p>
<b><code>=编写一个配置类（@Configuration），是WebMvcConfigurerAdapter类型；不能标注@EnableWebMvc=</code></b>;
</p>

<p>
既保留了所有的自动配置，也能用我们扩展的配置；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;WebMvcConfigurerAdapter&#21487;&#20197;&#26469;&#25193;&#23637;SpringMVC&#30340;&#21151;&#33021;</span>
<span style="color: #a45bad;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyMvcConfig</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> {

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addViewControllers</span>(<span style="color: #ce537a; font-weight: bold;">ViewControllerRegistry</span> <span style="color: #7590db;">registry</span>) {
       <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">super.addViewControllers(registry);</span>
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27983;&#35272;&#22120;&#21457;&#36865; /atguigu &#35831;&#27714;&#26469;&#21040; success</span>
        registry.addViewController(<span style="color: #2d9574;">"/atguigu"</span>).setViewName(<span style="color: #2d9574;">"success"</span>);
    }
}
</pre>
</div>

<p>
原理：
</p>

<p>
​ 1）、WebMvcAutoConfiguration是SpringMVC的自动配置类
</p>

<p>
​
2）、在做其他自动配置时会导入；@Import(<b>EnableWebMvcConfiguration</b>.class)
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">EnableWebMvcConfiguration</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">DelegatingWebMvcConfiguration</span> {
  <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">final</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerComposite</span> <span style="color: #7590db;">configurers</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerComposite</span>();

 <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#23481;&#22120;&#20013;&#33719;&#21462;&#25152;&#26377;&#30340;WebMvcConfigurer</span>
  <span style="color: #a45bad;">@Autowired</span>(required = <span style="color: #a45bad;">false</span>)
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">setConfigurers</span>(<span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">WebMvcConfigurer</span>&gt; <span style="color: #7590db;">configurers</span>) {
      <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span>CollectionUtils.isEmpty(configurers)) {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.configurers.addWebMvcConfigurers(configurers);
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#20010;&#21442;&#32771;&#23454;&#29616;&#65307;&#23558;&#25152;&#26377;&#30340;WebMvcConfigurer&#30456;&#20851;&#37197;&#32622;&#37117;&#26469;&#19968;&#36215;&#35843;&#29992;&#65307;  </span>
            <span style="color: #a45bad;">@Override</span>
         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">public void addViewControllers(ViewControllerRegistry registry) {</span>
          <span style="color: #2aa1ae; background-color: #292e34;">//    </span><span style="color: #2aa1ae; background-color: #292e34;">for (WebMvcConfigurer delegate : this.delegates) {</span>
           <span style="color: #2aa1ae; background-color: #292e34;">//       </span><span style="color: #2aa1ae; background-color: #292e34;">delegate.addViewControllers(registry);</span>
           <span style="color: #2aa1ae; background-color: #292e34;">//   </span><span style="color: #2aa1ae; background-color: #292e34;">}</span>
          }
      }
}
</pre>
</div>

<p>
​ 3）、容器中所有的WebMvcConfigurer都会一起起作用；
</p>

<p>
​ 4）、我们的配置类也会被调用；
</p>

<p>
​ 效果：SpringMVC的自动配置和我们的扩展配置都会起作用；
</p>
</div>
</li>

<li><a id="全面接管springmvc"></a>3、全面接管SpringMVC；<br />
<div class="outline-text-6" id="text-全面接管springmvc">
<p>
SpringBoot对SpringMVC的自动配置不需要了，所有都是我们自己配置；所有的SpringMVC的自动配置都失效了
</p>

<p>
<b>我们需要在配置类中添加@EnableWebMvc即可；</b>
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;WebMvcConfigurerAdapter&#21487;&#20197;&#26469;&#25193;&#23637;SpringMVC&#30340;&#21151;&#33021;</span>
<span style="color: #a45bad;">@EnableWebMvc</span>
<span style="color: #a45bad;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyMvcConfig</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> {

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addViewControllers</span>(<span style="color: #ce537a; font-weight: bold;">ViewControllerRegistry</span> <span style="color: #7590db;">registry</span>) {
       <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">super.addViewControllers(registry);</span>
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27983;&#35272;&#22120;&#21457;&#36865; /atguigu &#35831;&#27714;&#26469;&#21040; success</span>
        registry.addViewController(<span style="color: #2d9574;">"/atguigu"</span>).setViewName(<span style="color: #2d9574;">"success"</span>);
    }
}
</pre>
</div>

<p>
原理：
</p>

<p>
为什么@EnableWebMvc自动配置就失效了；
</p>

<p>
1）@EnableWebMvc的核心
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Import</span>(DelegatingWebMvcConfiguration.<span style="color: #4f97d7; font-weight: bold;">class</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">@interface</span> <span style="color: #ce537a; font-weight: bold;">EnableWebMvc</span> {
</pre>
</div>

<p>
2）、
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">DelegatingWebMvcConfiguration</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurationSupport</span> {
</pre>
</div>

<p>
3）、
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Configuration</span>
<span style="color: #a45bad;">@ConditionalOnWebApplication</span>
<span style="color: #a45bad;">@ConditionalOnClass</span>({ Servlet.<span style="color: #4f97d7; font-weight: bold;">class</span>, DispatcherServlet.<span style="color: #4f97d7; font-weight: bold;">class</span>,
        WebMvcConfigurerAdapter.<span style="color: #4f97d7; font-weight: bold;">class</span> })
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23481;&#22120;&#20013;&#27809;&#26377;&#36825;&#20010;&#32452;&#20214;&#30340;&#26102;&#20505;&#65292;&#36825;&#20010;&#33258;&#21160;&#37197;&#32622;&#31867;&#25165;&#29983;&#25928;</span>
<span style="color: #a45bad;">@ConditionalOnMissingBean</span>(WebMvcConfigurationSupport.<span style="color: #4f97d7; font-weight: bold;">class</span>)
<span style="color: #a45bad;">@AutoConfigureOrder</span>(<span style="color: #a45bad;">Ordered</span>.HIGHEST_PRECEDENCE + 10)
<span style="color: #a45bad;">@AutoConfigureAfter</span>({ DispatcherServletAutoConfiguration.<span style="color: #4f97d7; font-weight: bold;">class</span>,
        ValidationAutoConfiguration.<span style="color: #4f97d7; font-weight: bold;">class</span> })
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">WebMvcAutoConfiguration</span> {
</pre>
</div>

<p>
4）、@EnableWebMvc将WebMvcConfigurationSupport组件导入进来；
</p>

<p>
5）、导入的WebMvcConfigurationSupport只是SpringMVC最基本的功能；
</p>
</div>
</li>
</ul>
</li>

<li><a id="如何修改springboot的默认配置"></a>5、如何修改SpringBoot的默认配置<br />
<div class="outline-text-5" id="text-如何修改springboot的默认配置">
<p>
模式：
</p>

<p>
​
1）、SpringBoot在自动配置很多组件的时候，先看容器中有没有用户自己配置的（@Bean、@Component）如果有就用用户配置的，如果没有，才自动配置；如果有些组件可以有多个（ViewResolver）将用户配置的和自己默认的组合起来；
</p>

<p>
​ 2）、在SpringBoot中会有非常多的xxxConfigurer帮助我们进行扩展配置
</p>

<p>
​ 3）、在SpringBoot中会有很多的xxxCustomizer帮助我们进行定制配置
</p>
</div>
</li>

<li><a id="restfulcrud"></a>6、RestfulCRUD<br />
<div class="outline-text-5" id="text-restfulcrud">
</div>

<ul class="org-ul">
<li><a id="默认访问首页"></a>1）、默认访问首页<br />
<div class="outline-text-6" id="text-默认访问首页">
<div class="org-src-container">
<pre class="src src-java">
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;WebMvcConfigurerAdapter&#21487;&#20197;&#26469;&#25193;&#23637;SpringMVC&#30340;&#21151;&#33021;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@EnableWebMvc   &#19981;&#35201;&#25509;&#31649;SpringMVC</span>
<span style="color: #a45bad;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyMvcConfig</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> {

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addViewControllers</span>(<span style="color: #ce537a; font-weight: bold;">ViewControllerRegistry</span> <span style="color: #7590db;">registry</span>) {
       <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">super.addViewControllers(registry);</span>
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27983;&#35272;&#22120;&#21457;&#36865; /atguigu &#35831;&#27714;&#26469;&#21040; success</span>
        registry.addViewController(<span style="color: #2d9574;">"/atguigu"</span>).setViewName(<span style="color: #2d9574;">"success"</span>);
    }

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25152;&#26377;&#30340;WebMvcConfigurerAdapter&#32452;&#20214;&#37117;&#20250;&#19968;&#36215;&#36215;&#20316;&#29992;</span>
    <span style="color: #a45bad;">@Bean</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#32452;&#20214;&#27880;&#20876;&#22312;&#23481;&#22120;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> <span style="color: #bc6ec5; font-weight: bold;">webMvcConfigurerAdapter</span>(){
        <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> <span style="color: #7590db;">adapter</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span>() {
            <span style="color: #a45bad;">@Override</span>
            <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addViewControllers</span>(<span style="color: #ce537a; font-weight: bold;">ViewControllerRegistry</span> <span style="color: #7590db;">registry</span>) {
                registry.addViewController(<span style="color: #2d9574;">"/"</span>).setViewName(<span style="color: #2d9574;">"login"</span>);
                registry.addViewController(<span style="color: #2d9574;">"/index.html"</span>).setViewName(<span style="color: #2d9574;">"login"</span>);
            }
        };
        <span style="color: #4f97d7; font-weight: bold;">return</span> adapter;
    }
}
</pre>
</div>
</div>
</li>

<li><a id="国际化"></a>2）、国际化<br />
<div class="outline-text-6" id="text-国际化">
<p>
<b>1）、编写国际化配置文件；</b>
</p>

<p>
2）、使用ResourceBundleMessageSource管理国际化资源文件
</p>

<p>
3）、在页面使用fmt:message取出国际化内容
</p>

<p>
步骤：
</p>

<p>
1）、编写国际化配置文件，抽取页面需要显示的国际化消息
</p>


<div class="figure">
<p><img src="images/搜狗截图20180211130721.png" alt="搜狗截图20180211130721.png" />
</p>
</div>

<p>
2）、SpringBoot自动配置好了管理国际化资源文件的组件；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"spring.messages"</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MessageSourceAutoConfiguration</span> {

    <span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;">     * Comma-separated list of basenames (essentially a fully-qualified classpath</span>
<span style="color: #9f8766;">     * location), each following the ResourceBundle convention with relaxed support for</span>
<span style="color: #9f8766;">     * slash based locations. If it doesn't contain a package qualifier (such as</span>
<span style="color: #9f8766;">     * "org.mypackage"), it will be resolved from the classpath root.</span>
<span style="color: #9f8766;">     */</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">basename</span> = <span style="color: #2d9574;">"messages"</span>;  
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25105;&#20204;&#30340;&#37197;&#32622;&#25991;&#20214;&#21487;&#20197;&#30452;&#25509;&#25918;&#22312;&#31867;&#36335;&#24452;&#19979;&#21483;messages.properties&#65307;</span>

    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">MessageSource</span> <span style="color: #bc6ec5; font-weight: bold;">messageSource</span>() {
        <span style="color: #ce537a; font-weight: bold;">ResourceBundleMessageSource</span> <span style="color: #7590db;">messageSource</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ResourceBundleMessageSource</span>();
        <span style="color: #4f97d7; font-weight: bold;">if</span> (StringUtils.hasText(<span style="color: #4f97d7; font-weight: bold;">this</span>.basename)) {
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622;&#22269;&#38469;&#21270;&#36164;&#28304;&#25991;&#20214;&#30340;&#22522;&#30784;&#21517;&#65288;&#21435;&#25481;&#35821;&#35328;&#22269;&#23478;&#20195;&#30721;&#30340;&#65289;</span>
            messageSource.setBasenames(StringUtils.commaDelimitedListToStringArray(
                    StringUtils.trimAllWhitespace(<span style="color: #4f97d7; font-weight: bold;">this</span>.basename)));
        }
        <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.encoding != <span style="color: #a45bad;">null</span>) {
            messageSource.setDefaultEncoding(<span style="color: #4f97d7; font-weight: bold;">this</span>.encoding.name());
        }
        messageSource.setFallbackToSystemLocale(<span style="color: #4f97d7; font-weight: bold;">this</span>.fallbackToSystemLocale);
        messageSource.setCacheSeconds(<span style="color: #4f97d7; font-weight: bold;">this</span>.cacheSeconds);
        messageSource.setAlwaysUseMessageFormat(<span style="color: #4f97d7; font-weight: bold;">this</span>.alwaysUseMessageFormat);
        <span style="color: #4f97d7; font-weight: bold;">return</span> messageSource;
    }
</pre>
</div>

<p>
3）、去页面获取国际化的值；
</p>


<div class="figure">
<p><img src="images/搜狗截图20180211134506.png" alt="搜狗截图20180211134506.png" />
</p>
</div>

<pre class="example">
&lt;!DOCTYPE html&gt;
&lt;html lang="en"  xmlns:th="http://www.thymeleaf.org"&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
        &lt;meta name="description" content=""&gt;
        &lt;meta name="author" content=""&gt;
        &lt;title&gt;Signin Template for Bootstrap&lt;/title&gt;
        &lt;!-- Bootstrap core CSS --&gt;
        &lt;link href="asserts/css/bootstrap.min.css" th:href="@{/webjars/bootstrap/4.0.0/css/bootstrap.css}" rel="stylesheet"&gt;
        &lt;!-- Custom styles for this template --&gt;
        &lt;link href="asserts/css/signin.css" th:href="@{/asserts/css/signin.css}" rel="stylesheet"&gt;
    &lt;/head&gt;

    &lt;body class="text-center"&gt;
        &lt;form class="form-signin" action="dashboard.html"&gt;
            &lt;img class="mb-4" th:src="@{/asserts/img/bootstrap-solid.svg}" src="asserts/img/bootstrap-solid.svg" alt="" width="72" height="72"&gt;
            &lt;h1 class="h3 mb-3 font-weight-normal" th:text="#{login.tip}"&gt;Please sign in&lt;/h1&gt;
            &lt;label class="sr-only" th:text="#{login.username}"&gt;Username&lt;/label&gt;
            &lt;input type="text" class="form-control" placeholder="Username" th:placeholder="#{login.username}" required="" autofocus=""&gt;
            &lt;label class="sr-only" th:text="#{login.password}"&gt;Password&lt;/label&gt;
            &lt;input type="password" class="form-control" placeholder="Password" th:placeholder="#{login.password}" required=""&gt;
            &lt;div class="checkbox mb-3"&gt;
                &lt;label&gt;
                &lt;input type="checkbox" value="remember-me"/&gt; [[#{login.remember}]]
        &lt;/label&gt;
            &lt;/div&gt;
            &lt;button class="btn btn-lg btn-primary btn-block" type="submit" th:text="#{login.btn}"&gt;Sign in&lt;/button&gt;
            &lt;p class="mt-5 mb-3 text-muted"&gt;© 2017-2018&lt;/p&gt;
            &lt;a class="btn btn-sm"&gt;中文&lt;/a&gt;
            &lt;a class="btn btn-sm"&gt;English&lt;/a&gt;
        &lt;/form&gt;

    &lt;/body&gt;

&lt;/html&gt;
</pre>

<p>
效果：根据浏览器语言设置的信息切换了国际化；
</p>

<p>
原理：
</p>

<p>
​ 国际化Locale（区域信息对象）；LocaleResolver（获取区域信息对象）；
</p>

<div class="org-src-container">
<pre class="src src-java">        <span style="color: #a45bad;">@Bean</span>
        <span style="color: #a45bad;">@ConditionalOnMissingBean</span>
        <span style="color: #a45bad;">@ConditionalOnProperty</span>(prefix = <span style="color: #2d9574;">"spring.mvc"</span>, name = <span style="color: #2d9574;">"locale"</span>)
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">LocaleResolver</span> <span style="color: #bc6ec5; font-weight: bold;">localeResolver</span>() {
            <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.mvcProperties
                    .getLocaleResolver() == <span style="color: #a45bad;">WebMvcProperties</span>.<span style="color: #a45bad;">LocaleResolver</span>.FIXED) {
                <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">FixedLocaleResolver</span>(<span style="color: #4f97d7; font-weight: bold;">this</span>.mvcProperties.getLocale());
            }
            <span style="color: #ce537a; font-weight: bold;">AcceptHeaderLocaleResolver</span> <span style="color: #7590db;">localeResolver</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">AcceptHeaderLocaleResolver</span>();
            localeResolver.setDefaultLocale(<span style="color: #4f97d7; font-weight: bold;">this</span>.mvcProperties.getLocale());
            <span style="color: #4f97d7; font-weight: bold;">return</span> localeResolver;
        }
&#40664;&#35748;&#30340;&#23601;&#26159;&#26681;&#25454;&#35831;&#27714;&#22836;&#24102;&#26469;&#30340;&#21306;&#22495;&#20449;&#24687;&#33719;&#21462;Locale&#36827;&#34892;&#22269;&#38469;&#21270;
</pre>
</div>

<p>
4）、点击链接切换国际化
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> * &#21487;&#20197;&#22312;&#36830;&#25509;&#19978;&#25658;&#24102;&#21306;&#22495;&#20449;&#24687;</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyLocaleResolver</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">LocaleResolver</span> {

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Locale</span> <span style="color: #bc6ec5; font-weight: bold;">resolveLocale</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>) {
        <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">l</span> = request.getParameter(<span style="color: #2d9574;">"l"</span>);
        <span style="color: #ce537a; font-weight: bold;">Locale</span> <span style="color: #7590db;">locale</span> = Locale.getDefault();
        <span style="color: #4f97d7; font-weight: bold;">if</span>(<span style="color: #a45bad;">!</span>StringUtils.isEmpty(l)){
            <span style="color: #ce537a; font-weight: bold;">String</span>[] <span style="color: #7590db;">split</span> = l.split(<span style="color: #2d9574;">"_"</span>);
            locale = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Locale</span>(split[0],split[1]);
        }
        <span style="color: #4f97d7; font-weight: bold;">return</span> locale;
    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">setLocale</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>, <span style="color: #ce537a; font-weight: bold;">HttpServletResponse</span> <span style="color: #7590db;">response</span>, <span style="color: #ce537a; font-weight: bold;">Locale</span> <span style="color: #7590db;">locale</span>) {

    }
}


 <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">LocaleResolver</span> <span style="color: #bc6ec5; font-weight: bold;">localeResolver</span>(){
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MyLocaleResolver</span>();
    }
}

</pre>
</div>
</div>
</li>

<li><a id="登陆"></a>3）、登陆<br />
<div class="outline-text-6" id="text-登陆">
<p>
开发期间模板引擎页面修改以后，要实时生效
</p>

<p>
1）、禁用模板引擎的缓存
</p>

<pre class="example">
# 禁用缓存
spring.thymeleaf.cache=false 
</pre>

<p>
2）、页面修改完成以后ctrl+f9：重新编译；
</p>

<p>
登陆错误消息的显示
</p>

<pre class="example">
&lt;p style="color: red" th:text="${msg}" th:if="${not #strings.isEmpty(msg)}"&gt;&lt;/p&gt;
</pre>
</div>
</li>

<li><a id="拦截器进行登陆检查"></a>4）、拦截器进行登陆检查<br />
<div class="outline-text-6" id="text-拦截器进行登陆检查">
<p>
拦截器
</p>

<div class="org-src-container">
<pre class="src src-java">
<span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> * &#30331;&#38470;&#26816;&#26597;&#65292;</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">LoginHandlerInterceptor</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">HandlerInterceptor</span> {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#30446;&#26631;&#26041;&#27861;&#25191;&#34892;&#20043;&#21069;</span>
    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">boolean</span> <span style="color: #bc6ec5; font-weight: bold;">preHandle</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>, <span style="color: #ce537a; font-weight: bold;">HttpServletResponse</span> <span style="color: #7590db;">response</span>, <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">handler</span>) <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> {
        <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">user</span> = request.getSession().getAttribute(<span style="color: #2d9574;">"loginUser"</span>);
        <span style="color: #4f97d7; font-weight: bold;">if</span>(user == <span style="color: #a45bad;">null</span>){
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#26410;&#30331;&#38470;&#65292;&#36820;&#22238;&#30331;&#38470;&#39029;&#38754;</span>
            request.setAttribute(<span style="color: #2d9574;">"msg"</span>,<span style="color: #2d9574;">"&#27809;&#26377;&#26435;&#38480;&#35831;&#20808;&#30331;&#38470;"</span>);
            request.getRequestDispatcher(<span style="color: #2d9574;">"/index.html"</span>).forward(request,response);
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">false</span>;
        }<span style="color: #4f97d7; font-weight: bold;">else</span>{
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#24050;&#30331;&#38470;&#65292;&#25918;&#34892;&#35831;&#27714;</span>
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">true</span>;
        }

    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">postHandle</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>, <span style="color: #ce537a; font-weight: bold;">HttpServletResponse</span> <span style="color: #7590db;">response</span>, <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">handler</span>, <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #7590db;">modelAndView</span>) <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> {

    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">afterCompletion</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>, <span style="color: #ce537a; font-weight: bold;">HttpServletResponse</span> <span style="color: #7590db;">response</span>, <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">handler</span>, <span style="color: #ce537a; font-weight: bold;">Exception</span> <span style="color: #7590db;">ex</span>) <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> {

    }
}
</pre>
</div>

<p>
注册拦截器
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25152;&#26377;&#30340;WebMvcConfigurerAdapter&#32452;&#20214;&#37117;&#20250;&#19968;&#36215;&#36215;&#20316;&#29992;</span>
  <span style="color: #a45bad;">@Bean</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#32452;&#20214;&#27880;&#20876;&#22312;&#23481;&#22120;</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> <span style="color: #bc6ec5; font-weight: bold;">webMvcConfigurerAdapter</span>(){
      <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span> <span style="color: #7590db;">adapter</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">WebMvcConfigurerAdapter</span>() {
          <span style="color: #a45bad;">@Override</span>
          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addViewControllers</span>(<span style="color: #ce537a; font-weight: bold;">ViewControllerRegistry</span> <span style="color: #7590db;">registry</span>) {
              registry.addViewController(<span style="color: #2d9574;">"/"</span>).setViewName(<span style="color: #2d9574;">"login"</span>);
              registry.addViewController(<span style="color: #2d9574;">"/index.html"</span>).setViewName(<span style="color: #2d9574;">"login"</span>);
              registry.addViewController(<span style="color: #2d9574;">"/main.html"</span>).setViewName(<span style="color: #2d9574;">"dashboard"</span>);
          }

          <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#20876;&#25318;&#25130;&#22120;</span>
          <span style="color: #a45bad;">@Override</span>
          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">addInterceptors</span>(<span style="color: #ce537a; font-weight: bold;">InterceptorRegistry</span> <span style="color: #7590db;">registry</span>) {
              <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">super.addInterceptors(registry);</span>
              <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#36164;&#28304;&#65307;  *.css , *.js</span>
              <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">SpringBoot&#24050;&#32463;&#20570;&#22909;&#20102;&#38745;&#24577;&#36164;&#28304;&#26144;&#23556;</span>
              registry.addInterceptor(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">LoginHandlerInterceptor</span>()).addPathPatterns(<span style="color: #2d9574;">"/**"</span>)
                      .excludePathPatterns(<span style="color: #2d9574;">"/index.html"</span>,<span style="color: #2d9574;">"/"</span>,<span style="color: #2d9574;">"/user/login"</span>);
          }
      };
      <span style="color: #4f97d7; font-weight: bold;">return</span> adapter;
  }
</pre>
</div>
</div>
</li>

<li><a id="crud-员工列表"></a>5）、CRUD-员工列表<br />
<div class="outline-text-6" id="text-crud-员工列表">
<p>
实验要求：
</p>

<p>
1）、RestfulCRUD：CRUD满足Rest风格；
</p>

<p>
URI： /资源名称/资源标识 HTTP请求方式区分对资源CRUD操作
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">普通CRUD（uri来区分操作）</th>
<th scope="col" class="org-left">RestfulCRUD</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">查询</td>
<td class="org-left">getEmp</td>
<td class="org-left">emp&#x2014;GET</td>
</tr>

<tr>
<td class="org-left">添加</td>
<td class="org-left">addEmp?xxx</td>
<td class="org-left">emp&#x2014;POST</td>
</tr>

<tr>
<td class="org-left">修改</td>
<td class="org-left">updateEmp?id=xxx&amp;xxx=xx</td>
<td class="org-left">emp/{id}&#x2014;PUT</td>
</tr>

<tr>
<td class="org-left">删除</td>
<td class="org-left">deleteEmp?id=1</td>
<td class="org-left">emp/{id}&#x2014;DELETE</td>
</tr>
</tbody>
</table>

<p>
2）、实验的请求架构;
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">实验功能</th>
<th scope="col" class="org-left">请求URI</th>
<th scope="col" class="org-left">请求方式</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">查询所有员工</td>
<td class="org-left">emps</td>
<td class="org-left">GET</td>
</tr>

<tr>
<td class="org-left">查询某个员工(来到修改页面)</td>
<td class="org-left">emp/1</td>
<td class="org-left">GET</td>
</tr>

<tr>
<td class="org-left">来到添加页面</td>
<td class="org-left">emp</td>
<td class="org-left">GET</td>
</tr>

<tr>
<td class="org-left">添加员工</td>
<td class="org-left">emp</td>
<td class="org-left">POST</td>
</tr>

<tr>
<td class="org-left">来到修改页面（查出员工进行信息回显）</td>
<td class="org-left">emp/1</td>
<td class="org-left">GET</td>
</tr>

<tr>
<td class="org-left">修改员工</td>
<td class="org-left">emp</td>
<td class="org-left">PUT</td>
</tr>

<tr>
<td class="org-left">删除员工</td>
<td class="org-left">emp/1</td>
<td class="org-left">DELETE</td>
</tr>
</tbody>
</table>

<p>
3）、员工列表：
</p>
</div>

<ul class="org-ul">
<li><a id="thymeleaf公共页面元素抽取"></a>thymeleaf公共页面元素抽取<br />
<div class="outline-text-7" id="text-thymeleaf公共页面元素抽取">
<pre class="example">
1、抽取公共片段
&lt;div th:fragment="copy"&gt;
&amp;copy; 2011 The Good Thymes Virtual Grocery
&lt;/div&gt;

2、引入公共片段
&lt;div th:insert="~{footer :: copy}"&gt;&lt;/div&gt;
~{templatename::selector}：模板名::选择器
~{templatename::fragmentname}:模板名::片段名

3、默认效果：
insert的公共片段在div标签中
如果使用th:insert等属性进行引入，可以不用写~{}：
行内写法可以加上：[[~{}]];[(~{})]；
</pre>

<p>
三种引入公共片段的th属性：
</p>

<p>
*th:insert*：将公共片段整个插入到声明引入的元素中
</p>

<p>
*th:replace*：将声明引入的元素替换为公共片段
</p>

<p>
*th:include*：将被引入的片段的内容包含进这个标签中
</p>

<pre class="example">
&lt;footer th:fragment="copy"&gt;
&amp;copy; 2011 The Good Thymes Virtual Grocery
&lt;/footer&gt;

引入方式
&lt;div th:insert="footer :: copy"&gt;&lt;/div&gt;
&lt;div th:replace="footer :: copy"&gt;&lt;/div&gt;
&lt;div th:include="footer :: copy"&gt;&lt;/div&gt;

效果
&lt;div&gt;
    &lt;footer&gt;
    &amp;copy; 2011 The Good Thymes Virtual Grocery
    &lt;/footer&gt;
&lt;/div&gt;

&lt;footer&gt;
&amp;copy; 2011 The Good Thymes Virtual Grocery
&lt;/footer&gt;

&lt;div&gt;
&amp;copy; 2011 The Good Thymes Virtual Grocery
&lt;/div&gt;
</pre>

<p>
引入片段的时候传入参数：
</p>

<pre class="example">

&lt;nav class="col-md-2 d-none d-md-block bg-light sidebar" id="sidebar"&gt;
    &lt;div class="sidebar-sticky"&gt;
        &lt;ul class="nav flex-column"&gt;
            &lt;li class="nav-item"&gt;
                &lt;a class="nav-link active"
                   th:class="${activeUri=='main.html'?'nav-link active':'nav-link'}"
                   href="#" th:href="@{/main.html}"&gt;
                    &lt;svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"&gt;
                        &lt;path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"&gt;&lt;/path&gt;
                        &lt;polyline points="9 22 9 12 15 12 15 22"&gt;&lt;/polyline&gt;
                    &lt;/svg&gt;
                    Dashboard &lt;span class="sr-only"&gt;(current)&lt;/span&gt;
                &lt;/a&gt;
            &lt;/li&gt;

&lt;!--引入侧边栏;传入参数--&gt;
&lt;div th:replace="commons/bar::#sidebar(activeUri='emps')"&gt;&lt;/div&gt;
</pre>
</div>
</li>
</ul>
</li>

<li><a id="crud-员工添加"></a>6）、CRUD-员工添加<br />
<div class="outline-text-6" id="text-crud-员工添加">
<p>
添加页面
</p>

<pre class="example">
&lt;form&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;LastName&lt;/label&gt;
        &lt;input type="text" class="form-control" placeholder="zhangsan"&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;Email&lt;/label&gt;
        &lt;input type="email" class="form-control" placeholder="zhangsan@atguigu.com"&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;Gender&lt;/label&gt;&lt;br/&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;input class="form-check-input" type="radio" name="gender"  value="1"&gt;
            &lt;label class="form-check-label"&gt;男&lt;/label&gt;
        &lt;/div&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;input class="form-check-input" type="radio" name="gender"  value="0"&gt;
            &lt;label class="form-check-label"&gt;女&lt;/label&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;department&lt;/label&gt;
        &lt;select class="form-control"&gt;
            &lt;option&gt;1&lt;/option&gt;
            &lt;option&gt;2&lt;/option&gt;
            &lt;option&gt;3&lt;/option&gt;
            &lt;option&gt;4&lt;/option&gt;
            &lt;option&gt;5&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;Birth&lt;/label&gt;
        &lt;input type="text" class="form-control" placeholder="zhangsan"&gt;
    &lt;/div&gt;
    &lt;button type="submit" class="btn btn-primary"&gt;添加&lt;/button&gt;
&lt;/form&gt;
</pre>

<p>
提交的数据格式不对：生日：日期；
</p>

<p>
2017-12-12；2017/12/12；2017.12.12；
</p>

<p>
日期的格式化；SpringMVC将页面提交的值需要转换为指定的类型;
</p>

<p>
2017-12-12&#x2014;Date； 类型转换，格式化;
</p>

<p>
默认日期是按照/的方式；
</p>
</div>
</li>

<li><a id="crud-员工修改"></a>7）、CRUD-员工修改<br />
<div class="outline-text-6" id="text-crud-员工修改">
<p>
修改添加二合一表单
</p>

<pre class="example">
&lt;!--需要区分是员工修改还是添加；--&gt;
&lt;form th:action="@{/emp}" method="post"&gt;
    &lt;!--发送put请求修改员工数据--&gt;
    &lt;!--
1、SpringMVC中配置HiddenHttpMethodFilter;（SpringBoot自动配置好的）
2、页面创建一个post表单
3、创建一个input项，name="_method";值就是我们指定的请求方式
--&gt;
    &lt;input type="hidden" name="_method" value="put" th:if="${emp!=null}"/&gt;
    &lt;input type="hidden" name="id" th:if="${emp!=null}" th:value="${emp.id}"&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;LastName&lt;/label&gt;
        &lt;input name="lastName" type="text" class="form-control" placeholder="zhangsan" th:value="${emp!=null}?${emp.lastName}"&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;Email&lt;/label&gt;
        &lt;input name="email" type="email" class="form-control" placeholder="zhangsan@atguigu.com" th:value="${emp!=null}?${emp.email}"&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;Gender&lt;/label&gt;&lt;br/&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;input class="form-check-input" type="radio" name="gender" value="1" th:checked="${emp!=null}?${emp.gender==1}"&gt;
            &lt;label class="form-check-label"&gt;男&lt;/label&gt;
        &lt;/div&gt;
        &lt;div class="form-check form-check-inline"&gt;
            &lt;input class="form-check-input" type="radio" name="gender" value="0" th:checked="${emp!=null}?${emp.gender==0}"&gt;
            &lt;label class="form-check-label"&gt;女&lt;/label&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;department&lt;/label&gt;
        &lt;!--提交的是部门的id--&gt;
        &lt;select class="form-control" name="department.id"&gt;
            &lt;option th:selected="${emp!=null}?${dept.id == emp.department.id}" th:value="${dept.id}" th:each="dept:${depts}" th:text="${dept.departmentName}"&gt;1&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class="form-group"&gt;
        &lt;label&gt;Birth&lt;/label&gt;
        &lt;input name="birth" type="text" class="form-control" placeholder="zhangsan" th:value="${emp!=null}?${#dates.format(emp.birth, 'yyyy-MM-dd HH:mm')}"&gt;
    &lt;/div&gt;
    &lt;button type="submit" class="btn btn-primary" th:text="${emp!=null}?'修改':'添加'"&gt;添加&lt;/button&gt;
&lt;/form&gt;
</pre>
</div>
</li>

<li><a id="crud-员工删除"></a>8）、CRUD-员工删除<br />
<div class="outline-text-6" id="text-crud-员工删除">
<pre class="example">
&lt;tr th:each="emp:${emps}"&gt;
    &lt;td th:text="${emp.id}"&gt;&lt;/td&gt;
    &lt;td&gt;[[${emp.lastName}]]&lt;/td&gt;
    &lt;td th:text="${emp.email}"&gt;&lt;/td&gt;
    &lt;td th:text="${emp.gender}==0?'女':'男'"&gt;&lt;/td&gt;
    &lt;td th:text="${emp.department.departmentName}"&gt;&lt;/td&gt;
    &lt;td th:text="${#dates.format(emp.birth, 'yyyy-MM-dd HH:mm')}"&gt;&lt;/td&gt;
    &lt;td&gt;
        &lt;a class="btn btn-sm btn-primary" th:href="@{/emp/}+${emp.id}"&gt;编辑&lt;/a&gt;
        &lt;button th:attr="del_uri=@{/emp/}+${emp.id}" class="btn btn-sm btn-danger deleteBtn"&gt;删除&lt;/button&gt;
    &lt;/td&gt;
&lt;/tr&gt;


&lt;script&gt;
    $(".deleteBtn").click(function(){
        //删除当前员工的
        $("#deleteEmpForm").attr("action",$(this).attr("del_uri")).submit();
        return false;
    });
&lt;/script&gt;
</pre>
</div>
</li>
</ul>
</li>

<li><a id="错误处理机制"></a>7、错误处理机制<br />
<div class="outline-text-5" id="text-错误处理机制">
</div>

<ul class="org-ul">
<li><a id="springboot默认的错误处理机制"></a>1）、SpringBoot默认的错误处理机制<br />
<div class="outline-text-6" id="text-springboot默认的错误处理机制">
<p>
默认效果：
</p>

<p>
​ 1）、浏览器，返回一个默认的错误页面
</p>


<div class="figure">
<p><img src="images/搜狗截图20180226173408.png" alt="搜狗截图20180226173408.png" />
</p>
</div>

<p>
浏览器发送请求的请求头：
</p>


<div class="figure">
<p><img src="images/搜狗截图20180226180347.png" alt="搜狗截图20180226180347.png" />
</p>
</div>

<p>
​ 2）、如果是其他客户端，默认响应一个json数据
</p>


<div class="figure">
<p><img src="images/搜狗截图20180226173527.png" alt="搜狗截图20180226173527.png" />
</p>
</div>

<p>
​ <img src="images/搜狗截图20180226180504.png" alt="搜狗截图20180226180504.png" />
</p>

<p>
原理：
</p>

<p>
​ 可以参照ErrorMvcAutoConfiguration；错误处理的自动配置；
</p>

<pre class="example">
给容器中添加了以下组件
</pre>

<p>
​ 1、DefaultErrorAttributes：
</p>

<div class="org-src-container">
<pre class="src src-java">&#24110;&#25105;&#20204;&#22312;&#39029;&#38754;&#20849;&#20139;&#20449;&#24687;&#65307;
<span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; getErrorAttributes(<span style="color: #ce537a; font-weight: bold;">RequestAttributes</span> <span style="color: #7590db;">requestAttributes</span>,
            <span style="color: #ce537a; font-weight: bold;">boolean</span> <span style="color: #7590db;">includeStackTrace</span>) {
        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">errorAttributes</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">LinkedHashMap</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt;();
        errorAttributes.put(<span style="color: #2d9574;">"timestamp"</span>, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Date</span>());
        addStatus(errorAttributes, requestAttributes);
        addErrorDetails(errorAttributes, requestAttributes, includeStackTrace);
        addPath(errorAttributes, requestAttributes);
        <span style="color: #4f97d7; font-weight: bold;">return</span> errorAttributes;
    }
</pre>
</div>

<p>
​ 2、BasicErrorController：处理默认/error请求
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Controller</span>
<span style="color: #a45bad;">@RequestMapping</span>(<span style="color: #2d9574;">"${server.error.path:${error.path:/error}}"</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">BasicErrorController</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">AbstractErrorController</span> {

    <span style="color: #a45bad;">@RequestMapping</span>(produces = <span style="color: #2d9574;">"text/html"</span>)<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20135;&#29983;html&#31867;&#22411;&#30340;&#25968;&#25454;&#65307;&#27983;&#35272;&#22120;&#21457;&#36865;&#30340;&#35831;&#27714;&#26469;&#21040;&#36825;&#20010;&#26041;&#27861;&#22788;&#29702;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #bc6ec5; font-weight: bold;">errorHtml</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>,
            <span style="color: #ce537a; font-weight: bold;">HttpServletResponse</span> <span style="color: #7590db;">response</span>) {
        <span style="color: #ce537a; font-weight: bold;">HttpStatus</span> <span style="color: #7590db;">status</span> = getStatus(request);
        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">model</span> = Collections.unmodifiableMap(getErrorAttributes(
                request, isIncludeStackTrace(request, <span style="color: #a45bad;">MediaType</span>.TEXT_HTML)));
        response.setStatus(status.value());

        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21435;&#21738;&#20010;&#39029;&#38754;&#20316;&#20026;&#38169;&#35823;&#39029;&#38754;&#65307;&#21253;&#21547;&#39029;&#38754;&#22320;&#22336;&#21644;&#39029;&#38754;&#20869;&#23481;</span>
        <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #7590db;">modelAndView</span> = resolveErrorView(request, response, status, model);
        <span style="color: #4f97d7; font-weight: bold;">return</span> (modelAndView == <span style="color: #a45bad;">null</span> ? <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ModelAndView</span>(<span style="color: #2d9574;">"error"</span>, model) : modelAndView);
    }

    <span style="color: #a45bad;">@RequestMapping</span>
    <span style="color: #a45bad;">@ResponseBody</span>    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20135;&#29983;json&#25968;&#25454;&#65292;&#20854;&#20182;&#23458;&#25143;&#31471;&#26469;&#21040;&#36825;&#20010;&#26041;&#27861;&#22788;&#29702;&#65307;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ResponseEntity</span>&lt;<span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt;&gt; <span style="color: #bc6ec5; font-weight: bold;">error</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>) {
        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">body</span> = getErrorAttributes(request,
                isIncludeStackTrace(request, <span style="color: #a45bad;">MediaType</span>.ALL));
        <span style="color: #ce537a; font-weight: bold;">HttpStatus</span> <span style="color: #7590db;">status</span> = getStatus(request);
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ResponseEntity</span>&lt;<span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt;&gt;(body, status);
    }
</pre>
</div>

<p>
​ 3、ErrorPageCustomizer：
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Value</span>(<span style="color: #2d9574;">"${error.path:/error}"</span>)
<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">path</span> = <span style="color: #2d9574;">"/error"</span>;  &#31995;&#32479;&#20986;&#29616;&#38169;&#35823;&#20197;&#21518;&#26469;&#21040;error&#35831;&#27714;&#36827;&#34892;&#22788;&#29702;&#65307;&#65288;web.xml&#27880;&#20876;&#30340;&#38169;&#35823;&#39029;&#38754;&#35268;&#21017;&#65289;
</pre>
</div>

<p>
​ 4、DefaultErrorViewResolver：
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #bc6ec5; font-weight: bold;">resolveErrorView</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>, <span style="color: #ce537a; font-weight: bold;">HttpStatus</span> <span style="color: #7590db;">status</span>,
            <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">model</span>) {
        <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #7590db;">modelAndView</span> = resolve(String.valueOf(status), model);
        <span style="color: #4f97d7; font-weight: bold;">if</span> (modelAndView == <span style="color: #a45bad;">null</span> &amp;&amp; SERIES_VIEWS.containsKey(status.series())) {
            modelAndView = resolve(SERIES_VIEWS.get(status.series()), model);
        }
        <span style="color: #4f97d7; font-weight: bold;">return</span> modelAndView;
    }

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #bc6ec5; font-weight: bold;">resolve</span>(<span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">viewName</span>, <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">model</span>) {
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#40664;&#35748;SpringBoot&#21487;&#20197;&#21435;&#25214;&#21040;&#19968;&#20010;&#39029;&#38754;&#65311;  error/404</span>
        <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">errorViewName</span> = <span style="color: #2d9574;">"error/"</span> + viewName;

        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27169;&#26495;&#24341;&#25806;&#21487;&#20197;&#35299;&#26512;&#36825;&#20010;&#39029;&#38754;&#22320;&#22336;&#23601;&#29992;&#27169;&#26495;&#24341;&#25806;&#35299;&#26512;</span>
        <span style="color: #ce537a; font-weight: bold;">TemplateAvailabilityProvider</span> <span style="color: #7590db;">provider</span> = <span style="color: #4f97d7; font-weight: bold;">this</span>.templateAvailabilityProviders
                .getProvider(errorViewName, <span style="color: #4f97d7; font-weight: bold;">this</span>.applicationContext);
        <span style="color: #4f97d7; font-weight: bold;">if</span> (provider != <span style="color: #a45bad;">null</span>) {
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27169;&#26495;&#24341;&#25806;&#21487;&#29992;&#30340;&#24773;&#20917;&#19979;&#36820;&#22238;&#21040;errorViewName&#25351;&#23450;&#30340;&#35270;&#22270;&#22320;&#22336;</span>
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ModelAndView</span>(errorViewName, model);
        }
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27169;&#26495;&#24341;&#25806;&#19981;&#21487;&#29992;&#65292;&#23601;&#22312;&#38745;&#24577;&#36164;&#28304;&#25991;&#20214;&#22841;&#19979;&#25214;errorViewName&#23545;&#24212;&#30340;&#39029;&#38754;   error/404.html</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> resolveResource(errorViewName, model);
    }
</pre>
</div>

<p>
​ 步骤：
</p>

<p>
​
一但系统出现4xx或者5xx之类的错误；ErrorPageCustomizer就会生效（定制错误的响应规则）；就会来到/error请求；就会被*BasicErrorController*处理；
</p>

<p>
​ 1）响应页面；去哪个页面是由*DefaultErrorViewResolver*解析得到的；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">protected</span> <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #bc6ec5; font-weight: bold;">resolveErrorView</span>(<span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>,
      <span style="color: #ce537a; font-weight: bold;">HttpServletResponse</span> <span style="color: #7590db;">response</span>, <span style="color: #ce537a; font-weight: bold;">HttpStatus</span> <span style="color: #7590db;">status</span>, <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">model</span>) {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25152;&#26377;&#30340;ErrorViewResolver&#24471;&#21040;ModelAndView</span>
   <span style="color: #4f97d7; font-weight: bold;">for</span> (<span style="color: #ce537a; font-weight: bold;">ErrorViewResolver</span> <span style="color: #7590db;">resolver</span> : <span style="color: #4f97d7; font-weight: bold;">this</span>.errorViewResolvers) {
      <span style="color: #ce537a; font-weight: bold;">ModelAndView</span> <span style="color: #7590db;">modelAndView</span> = resolver.resolveErrorView(request, status, model);
      <span style="color: #4f97d7; font-weight: bold;">if</span> (modelAndView != <span style="color: #a45bad;">null</span>) {
         <span style="color: #4f97d7; font-weight: bold;">return</span> modelAndView;
      }
   }
   <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">null</span>;
}
</pre>
</div>
</div>
</li>

<li><a id="如果定制错误响应"></a>2）、如果定制错误响应：<br />
<div class="outline-text-6" id="text-如果定制错误响应">
</div>

<ul class="org-ul">
<li><a id="如何定制错误的页面"></a><b>1）、如何定制错误的页面；</b><br />
<div class="outline-text-7" id="text-如何定制错误的页面">
<p>
​ <b>1）、有模板引擎的情况下；error/状态码;</b> 【将错误页面命名为
错误状态码.html 放在模板引擎文件夹里面的
error文件夹下】，发生此状态码的错误就会来到 对应的页面；
</p>

<p>
​
我们可以使用4xx和5xx作为错误页面的文件名来匹配这种类型的所有错误，精确优先（优先寻找精确的状态码.html）；
</p>

<p>
​ 页面能获取的信息；
</p>

<p>
​ timestamp：时间戳
</p>

<p>
​ status：状态码
</p>

<p>
​ error：错误提示
</p>

<p>
​ exception：异常对象
</p>

<p>
​ message：异常消息
</p>

<p>
​ errors：JSR303数据校验的错误都在这里
</p>

<p>
​ 2）、没有模板引擎（模板引擎找不到这个错误页面），静态资源文件夹下找；
</p>

<p>
​ 3）、以上都没有错误页面，就是默认来到SpringBoot默认的错误提示页面；
</p>
</div>
</li>

<li><a id="如何定制错误的json数据"></a>2）、如何定制错误的json数据；<br />
<div class="outline-text-7" id="text-如何定制错误的json数据">
<p>
​ 1）、自定义异常处理&amp;返回定制json数据；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ControllerAdvice</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyExceptionHandler</span> {

    <span style="color: #a45bad;">@ResponseBody</span>
    <span style="color: #a45bad;">@ExceptionHandler</span>(UserNotExistException.<span style="color: #4f97d7; font-weight: bold;">class</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">handleException</span>(<span style="color: #ce537a; font-weight: bold;">Exception</span> <span style="color: #7590db;">e</span>){
        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">map</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HashMap</span>&lt;&gt;();
        map.put(<span style="color: #2d9574;">"code"</span>,<span style="color: #2d9574;">"user.notexist"</span>);
        map.put(<span style="color: #2d9574;">"message"</span>,e.getMessage());
        <span style="color: #4f97d7; font-weight: bold;">return</span> map;
    }
}
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27809;&#26377;&#33258;&#36866;&#24212;&#25928;&#26524;...</span>
</pre>
</div>

<p>
​ 2）、转发到/error进行自适应响应效果处理
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@ExceptionHandler</span>(UserNotExistException.<span style="color: #4f97d7; font-weight: bold;">class</span>)
   <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #bc6ec5; font-weight: bold;">handleException</span>(<span style="color: #ce537a; font-weight: bold;">Exception</span> <span style="color: #7590db;">e</span>, <span style="color: #ce537a; font-weight: bold;">HttpServletRequest</span> <span style="color: #7590db;">request</span>){
       <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">map</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HashMap</span>&lt;&gt;();
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20256;&#20837;&#25105;&#20204;&#33258;&#24049;&#30340;&#38169;&#35823;&#29366;&#24577;&#30721;  4xx 5xx&#65292;&#21542;&#21017;&#23601;&#19981;&#20250;&#36827;&#20837;&#23450;&#21046;&#38169;&#35823;&#39029;&#38754;&#30340;&#35299;&#26512;&#27969;&#31243;</span>
       <span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;">        * Integer statusCode = (Integer) request</span>
<span style="color: #9f8766;">        .getAttribute("javax.servlet.error.status_code");</span>
<span style="color: #9f8766;">        */</span>
       request.setAttribute(<span style="color: #2d9574;">"javax.servlet.error.status_code"</span>,500);
       map.put(<span style="color: #2d9574;">"code"</span>,<span style="color: #2d9574;">"user.notexist"</span>);
       map.put(<span style="color: #2d9574;">"message"</span>,e.getMessage());
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#36716;&#21457;&#21040;/error</span>
       <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">"forward:/error"</span>;
   }
</pre>
</div>
</div>
</li>

<li><a id="将我们的定制数据携带出去"></a>3）、将我们的定制数据携带出去；<br />
<div class="outline-text-7" id="text-将我们的定制数据携带出去">
<p>
出现错误以后，会来到/error请求，会被BasicErrorController处理，响应出去可以获取的数据是由getErrorAttributes得到的（是AbstractErrorController（ErrorController）规定的方法）；
</p>

<p>
​
1、完全来编写一个ErrorController的实现类【或者是编写AbstractErrorController的子类】，放在容器中；
</p>

<p>
​
2、页面上能用的数据，或者是json返回能用的数据都是通过errorAttributes.getErrorAttributes得到；
</p>

<p>
​
容器中DefaultErrorAttributes.getErrorAttributes()；默认进行数据处理的；
</p>

<p>
自定义ErrorAttributes
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#32473;&#23481;&#22120;&#20013;&#21152;&#20837;&#25105;&#20204;&#33258;&#24049;&#23450;&#20041;&#30340;ErrorAttributes</span>
<span style="color: #a45bad;">@Component</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyErrorAttributes</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">DefaultErrorAttributes</span> {

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">getErrorAttributes</span>(<span style="color: #ce537a; font-weight: bold;">RequestAttributes</span> <span style="color: #7590db;">requestAttributes</span>, <span style="color: #ce537a; font-weight: bold;">boolean</span> <span style="color: #7590db;">includeStackTrace</span>) {
        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>, <span style="color: #ce537a; font-weight: bold;">Object</span>&gt; <span style="color: #7590db;">map</span> = <span style="color: #4f97d7; font-weight: bold;">super</span>.getErrorAttributes(requestAttributes, includeStackTrace);
        map.put(<span style="color: #2d9574;">"company"</span>,<span style="color: #2d9574;">"atguigu"</span>);
        <span style="color: #4f97d7; font-weight: bold;">return</span> map;
    }
}
</pre>
</div>

<p>
最终的效果：响应是自适应的，可以通过定制ErrorAttributes改变需要返回的内容，
</p>


<div class="figure">
<p><img src="images/搜狗截图20180228135513.png" alt="搜狗截图20180228135513.png" />
</p>
</div>
</div>
</li>
</ul>
</li>
</ul>
</li>

<li><a id="配置嵌入式servlet容器"></a>8、配置嵌入式Servlet容器<br />
<div class="outline-text-5" id="text-配置嵌入式servlet容器">
<p>
SpringBoot默认使用Tomcat作为嵌入式的Servlet容器；
</p>


<div class="figure">
<p><img src="images/搜狗截图20180301142915.png" alt="搜狗截图20180301142915.png" />
</p>
</div>

<p>
问题？
</p>
</div>

<ul class="org-ul">
<li><a id="如何定制和修改servlet容器的相关配置"></a>1）、如何定制和修改Servlet容器的相关配置；<br />
<div class="outline-text-6" id="text-如何定制和修改servlet容器的相关配置">
<p>
1、修改和server有关的配置（ServerProperties【也是EmbeddedServletContainerCustomizer】）；
</p>

<pre class="example">
server.port=8081
server.context-path=/crud

server.tomcat.uri-encoding=UTF-8

//通用的Servlet容器设置
server.xxx
//Tomcat的设置
server.tomcat.xxx
</pre>

<p>
2、编写一个*EmbeddedServletContainerCustomizer*：嵌入式的Servlet容器的定制器；来修改Servlet容器的配置
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Bean</span>  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#23450;&#35201;&#23558;&#36825;&#20010;&#23450;&#21046;&#22120;&#21152;&#20837;&#21040;&#23481;&#22120;&#20013;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerCustomizer</span> <span style="color: #bc6ec5; font-weight: bold;">embeddedServletContainerCustomizer</span>(){
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerCustomizer</span>() {

        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#21046;&#23884;&#20837;&#24335;&#30340;Servlet&#23481;&#22120;&#30456;&#20851;&#30340;&#35268;&#21017;</span>
        <span style="color: #a45bad;">@Override</span>
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">customize</span>(<span style="color: #ce537a; font-weight: bold;">ConfigurableEmbeddedServletContainer</span> <span style="color: #7590db;">container</span>) {
            container.setPort(8083);
        }
    };
}
</pre>
</div>
</div>
</li>

<li><a id="注册servlet三大组件servletfilterlistener"></a>2）、注册Servlet三大组件【Servlet、Filter、Listener】<br />
<div class="outline-text-6" id="text-注册servlet三大组件servletfilterlistener">
<p>
由于SpringBoot默认是以jar包的方式启动嵌入式的Servlet容器来启动SpringBoot的web应用，没有web.xml文件。
</p>

<p>
注册三大组件用以下方式
</p>

<p>
ServletRegistrationBean
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#20876;&#19977;&#22823;&#32452;&#20214;</span>
<span style="color: #a45bad;">@Bean</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span> <span style="color: #bc6ec5; font-weight: bold;">myServlet</span>(){
    <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span> <span style="color: #7590db;">registrationBean</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MyServlet</span>(),<span style="color: #2d9574;">"/myServlet"</span>);
    <span style="color: #4f97d7; font-weight: bold;">return</span> registrationBean;
}
</pre>
</div>

<p>
FilterRegistrationBean
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Bean</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">FilterRegistrationBean</span> <span style="color: #bc6ec5; font-weight: bold;">myFilter</span>(){
    <span style="color: #ce537a; font-weight: bold;">FilterRegistrationBean</span> <span style="color: #7590db;">registrationBean</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">FilterRegistrationBean</span>();
    registrationBean.setFilter(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MyFilter</span>());
    registrationBean.setUrlPatterns(Arrays.asList(<span style="color: #2d9574;">"/hello"</span>,<span style="color: #2d9574;">"/myServlet"</span>));
    <span style="color: #4f97d7; font-weight: bold;">return</span> registrationBean;
}
</pre>
</div>

<p>
ServletListenerRegistrationBean
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Bean</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ServletListenerRegistrationBean</span> <span style="color: #bc6ec5; font-weight: bold;">myListener</span>(){
    <span style="color: #ce537a; font-weight: bold;">ServletListenerRegistrationBean</span>&lt;<span style="color: #ce537a; font-weight: bold;">MyListener</span>&gt; <span style="color: #7590db;">registrationBean</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ServletListenerRegistrationBean</span>&lt;&gt;(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MyListener</span>());
    <span style="color: #4f97d7; font-weight: bold;">return</span> registrationBean;
}
</pre>
</div>

<p>
SpringBoot帮我们自动SpringMVC的时候，自动的注册SpringMVC的前端控制器；DIspatcherServlet；
</p>

<p>
DispatcherServletAutoConfiguration中：
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Bean</span>(name = DEFAULT_DISPATCHER_SERVLET_REGISTRATION_BEAN_NAME)
<span style="color: #a45bad;">@ConditionalOnBean</span>(value = DispatcherServlet.<span style="color: #4f97d7; font-weight: bold;">class</span>, name = DEFAULT_DISPATCHER_SERVLET_BEAN_NAME)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span> <span style="color: #bc6ec5; font-weight: bold;">dispatcherServletRegistration</span>(
      <span style="color: #ce537a; font-weight: bold;">DispatcherServlet</span> <span style="color: #7590db;">dispatcherServlet</span>) {
   <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span> <span style="color: #7590db;">registration</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span>(
         dispatcherServlet, <span style="color: #4f97d7; font-weight: bold;">this</span>.serverProperties.getServletMapping());
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#40664;&#35748;&#25318;&#25130;&#65306; /  &#25152;&#26377;&#35831;&#27714;&#65307;&#21253;&#38745;&#24577;&#36164;&#28304;&#65292;&#20294;&#26159;&#19981;&#25318;&#25130;jsp&#35831;&#27714;&#65307;   /*&#20250;&#25318;&#25130;jsp</span>
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#20197;&#36890;&#36807;server.servletPath&#26469;&#20462;&#25913;SpringMVC&#21069;&#31471;&#25511;&#21046;&#22120;&#40664;&#35748;&#25318;&#25130;&#30340;&#35831;&#27714;&#36335;&#24452;</span>

   registration.setName(DEFAULT_DISPATCHER_SERVLET_BEAN_NAME);
   registration.setLoadOnStartup(
         <span style="color: #4f97d7; font-weight: bold;">this</span>.webMvcProperties.getServlet().getLoadOnStartup());
   <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.multipartConfig != <span style="color: #a45bad;">null</span>) {
      registration.setMultipartConfig(<span style="color: #4f97d7; font-weight: bold;">this</span>.multipartConfig);
   }
   <span style="color: #4f97d7; font-weight: bold;">return</span> registration;
}
</pre>
</div>

<p>
2）、SpringBoot能不能支持其他的Servlet容器；
</p>
</div>
</li>

<li><a id="替换为其他嵌入式servlet容器"></a>3）、替换为其他嵌入式Servlet容器<br />
<div class="outline-text-6" id="text-替换为其他嵌入式servlet容器">

<div class="figure">
<p><img src="images/搜狗截图20180302114401.png" alt="搜狗截图20180302114401.png" />
</p>
</div>

<p>
默认支持：
</p>

<p>
Tomcat（默认使用）
</p>

<pre class="example">
&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
   引入web模块默认就是使用嵌入式的Tomcat作为Servlet容器；
&lt;/dependency&gt;
</pre>

<p>
Jetty
</p>

<pre class="example">
&lt;!-- 引入web模块 --&gt;
&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
   &lt;exclusions&gt;
      &lt;exclusion&gt;
         &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;/exclusion&gt;
   &lt;/exclusions&gt;
&lt;/dependency&gt;

&lt;!--引入其他的Servlet容器--&gt;
&lt;dependency&gt;
   &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
&lt;/dependency&gt;
</pre>

<p>
Undertow
</p>

<pre class="example">
&lt;!-- 引入web模块 --&gt;
&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
   &lt;exclusions&gt;
      &lt;exclusion&gt;
         &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;/exclusion&gt;
   &lt;/exclusions&gt;
&lt;/dependency&gt;

&lt;!--引入其他的Servlet容器--&gt;
&lt;dependency&gt;
   &lt;artifactId&gt;spring-boot-starter-undertow&lt;/artifactId&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
&lt;/dependency&gt;
</pre>
</div>
</li>

<li><a id="嵌入式servlet容器自动配置原理"></a>4）、嵌入式Servlet容器自动配置原理；<br />
<div class="outline-text-6" id="text-嵌入式servlet容器自动配置原理">
<p>
EmbeddedServletContainerAutoConfiguration：嵌入式的Servlet容器自动配置？
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@AutoConfigureOrder</span>(<span style="color: #a45bad;">Ordered</span>.<span style="color: #ce537a; font-weight: bold;">HIGHEST_PRECEDENCE</span>)
<span style="color: #a45bad;">@Configuration</span>
<span style="color: #a45bad;">@ConditionalOnWebApplication</span>
<span style="color: #a45bad;">@Import</span>(BeanPostProcessorsRegistrar.<span style="color: #4f97d7; font-weight: bold;">class</span>)
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23548;&#20837;BeanPostProcessorsRegistrar&#65306;Spring&#27880;&#35299;&#29256;&#65307;&#32473;&#23481;&#22120;&#20013;&#23548;&#20837;&#19968;&#20123;&#32452;&#20214;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23548;&#20837;&#20102;EmbeddedServletContainerCustomizerBeanPostProcessor&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21518;&#32622;&#22788;&#29702;&#22120;&#65306;bean&#21021;&#22987;&#21270;&#21069;&#21518;&#65288;&#21019;&#24314;&#23436;&#23545;&#35937;&#65292;&#36824;&#27809;&#36171;&#20540;&#36171;&#20540;&#65289;&#25191;&#34892;&#21021;&#22987;&#21270;&#24037;&#20316;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerAutoConfiguration</span> {

    <span style="color: #a45bad;">@Configuration</span>
    <span style="color: #a45bad;">@ConditionalOnClass</span>({ Servlet.<span style="color: #4f97d7; font-weight: bold;">class</span>, Tomcat.<span style="color: #4f97d7; font-weight: bold;">class</span> })<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21028;&#26029;&#24403;&#21069;&#26159;&#21542;&#24341;&#20837;&#20102;Tomcat&#20381;&#36182;&#65307;</span>
    <span style="color: #a45bad;">@ConditionalOnMissingBean</span>(value = EmbeddedServletContainerFactory.<span style="color: #4f97d7; font-weight: bold;">class</span>, search = <span style="color: #a45bad;">SearchStrategy</span>.CURRENT)<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21028;&#26029;&#24403;&#21069;&#23481;&#22120;&#27809;&#26377;&#29992;&#25143;&#33258;&#24049;&#23450;&#20041;EmbeddedServletContainerFactory&#65306;&#23884;&#20837;&#24335;&#30340;Servlet&#23481;&#22120;&#24037;&#21378;&#65307;&#20316;&#29992;&#65306;&#21019;&#24314;&#23884;&#20837;&#24335;&#30340;Servlet&#23481;&#22120;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedTomcat</span> {

        <span style="color: #a45bad;">@Bean</span>
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">TomcatEmbeddedServletContainerFactory</span> <span style="color: #bc6ec5; font-weight: bold;">tomcatEmbeddedServletContainerFactory</span>() {
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">TomcatEmbeddedServletContainerFactory</span>();
        }

    }

    <span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;">     * Nested configuration if Jetty is being used.</span>
<span style="color: #9f8766;">     */</span>
    <span style="color: #a45bad;">@Configuration</span>
    <span style="color: #a45bad;">@ConditionalOnClass</span>({ Servlet.<span style="color: #4f97d7; font-weight: bold;">class</span>, Server.<span style="color: #4f97d7; font-weight: bold;">class</span>, Loader.<span style="color: #4f97d7; font-weight: bold;">class</span>,
            WebAppContext.<span style="color: #4f97d7; font-weight: bold;">class</span> })
    <span style="color: #a45bad;">@ConditionalOnMissingBean</span>(value = EmbeddedServletContainerFactory.<span style="color: #4f97d7; font-weight: bold;">class</span>, search = <span style="color: #a45bad;">SearchStrategy</span>.CURRENT)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedJetty</span> {

        <span style="color: #a45bad;">@Bean</span>
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">JettyEmbeddedServletContainerFactory</span> <span style="color: #bc6ec5; font-weight: bold;">jettyEmbeddedServletContainerFactory</span>() {
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JettyEmbeddedServletContainerFactory</span>();
        }

    }

    <span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;">     * Nested configuration if Undertow is being used.</span>
<span style="color: #9f8766;">     */</span>
    <span style="color: #a45bad;">@Configuration</span>
    <span style="color: #a45bad;">@ConditionalOnClass</span>({ Servlet.<span style="color: #4f97d7; font-weight: bold;">class</span>, Undertow.<span style="color: #4f97d7; font-weight: bold;">class</span>, SslClientAuthMode.<span style="color: #4f97d7; font-weight: bold;">class</span> })
    <span style="color: #a45bad;">@ConditionalOnMissingBean</span>(value = EmbeddedServletContainerFactory.<span style="color: #4f97d7; font-weight: bold;">class</span>, search = <span style="color: #a45bad;">SearchStrategy</span>.CURRENT)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedUndertow</span> {

        <span style="color: #a45bad;">@Bean</span>
        <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">UndertowEmbeddedServletContainerFactory</span> <span style="color: #bc6ec5; font-weight: bold;">undertowEmbeddedServletContainerFactory</span>() {
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">UndertowEmbeddedServletContainerFactory</span>();
        }

    }
</pre>
</div>

<p>
1）、EmbeddedServletContainerFactory（嵌入式Servlet容器工厂）
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerFactory</span> {

   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#23884;&#20837;&#24335;&#30340;Servlet&#23481;&#22120;</span>
   <span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainer</span> <span style="color: #bc6ec5; font-weight: bold;">getEmbeddedServletContainer</span>(
         <span style="color: #ce537a; font-weight: bold;">ServletContextInitializer</span>... <span style="color: #7590db;">initializers</span>);

}
</pre>
</div>


<div class="figure">
<p><img src="images/搜狗截图20180302144835.png" alt="搜狗截图20180302144835.png" />
</p>
</div>

<p>
2）、EmbeddedServletContainer：（嵌入式的Servlet容器）
</p>


<div class="figure">
<p><img src="images/搜狗截图20180302144910.png" alt="搜狗截图20180302144910.png" />
</p>
</div>

<p>
3）、以*TomcatEmbeddedServletContainerFactory*为例
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Override</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainer</span> <span style="color: #bc6ec5; font-weight: bold;">getEmbeddedServletContainer</span>(
      <span style="color: #ce537a; font-weight: bold;">ServletContextInitializer</span>... <span style="color: #7590db;">initializers</span>) {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21019;&#24314;&#19968;&#20010;Tomcat</span>
   <span style="color: #ce537a; font-weight: bold;">Tomcat</span> <span style="color: #7590db;">tomcat</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Tomcat</span>();

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#37197;&#32622;Tomcat&#30340;&#22522;&#26412;&#29615;&#33410;</span>
   <span style="color: #ce537a; font-weight: bold;">File</span> <span style="color: #7590db;">baseDir</span> = (<span style="color: #4f97d7; font-weight: bold;">this</span>.baseDirectory != <span style="color: #a45bad;">null</span> ? <span style="color: #4f97d7; font-weight: bold;">this</span>.baseDirectory
         : createTempDir(<span style="color: #2d9574;">"tomcat"</span>));
   tomcat.setBaseDir(baseDir.getAbsolutePath());
   <span style="color: #ce537a; font-weight: bold;">Connector</span> <span style="color: #7590db;">connector</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Connector</span>(<span style="color: #4f97d7; font-weight: bold;">this</span>.protocol);
   tomcat.getService().addConnector(connector);
   customizeConnector(connector);
   tomcat.setConnector(connector);
   tomcat.getHost().setAutoDeploy(<span style="color: #a45bad;">false</span>);
   configureEngine(tomcat.getEngine());
   <span style="color: #4f97d7; font-weight: bold;">for</span> (<span style="color: #ce537a; font-weight: bold;">Connector</span> <span style="color: #7590db;">additionalConnector</span> : <span style="color: #4f97d7; font-weight: bold;">this</span>.additionalTomcatConnectors) {
      tomcat.getService().addConnector(additionalConnector);
   }
   prepareContext(tomcat.getHost(), initializers);

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#37197;&#32622;&#22909;&#30340;Tomcat&#20256;&#20837;&#36827;&#21435;&#65292;&#36820;&#22238;&#19968;&#20010;EmbeddedServletContainer&#65307;&#24182;&#19988;&#21551;&#21160;Tomcat&#26381;&#21153;&#22120;</span>
   <span style="color: #4f97d7; font-weight: bold;">return</span> getTomcatEmbeddedServletContainer(tomcat);
}
</pre>
</div>

<p>
4）、我们对嵌入式容器的配置修改是怎么生效？
</p>

<pre class="example">
ServerProperties、EmbeddedServletContainerCustomizer
</pre>

<p>
*EmbeddedServletContainerCustomizer*：定制器帮我们修改了Servlet容器的配置？
</p>

<p>
怎么修改的原理？
</p>

<p>
5）、容器中导入了*EmbeddedServletContainerCustomizerBeanPostProcessor*
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21021;&#22987;&#21270;&#20043;&#21069;</span>
<span style="color: #a45bad;">@Override</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #bc6ec5; font-weight: bold;">postProcessBeforeInitialization</span>(<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">bean</span>, <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">beanName</span>)
      <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">BeansException</span> {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524;&#24403;&#21069;&#21021;&#22987;&#21270;&#30340;&#26159;&#19968;&#20010;ConfigurableEmbeddedServletContainer&#31867;&#22411;&#30340;&#32452;&#20214;</span>
   <span style="color: #4f97d7; font-weight: bold;">if</span> (bean <span style="color: #4f97d7; font-weight: bold;">instanceof</span> ConfigurableEmbeddedServletContainer) {
       <span style="color: #2aa1ae; background-color: #292e34;">//</span>
      postProcessBeforeInitialization((<span style="color: #ce537a; font-weight: bold;">ConfigurableEmbeddedServletContainer</span>) bean);
   }
   <span style="color: #4f97d7; font-weight: bold;">return</span> bean;
}

<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">postProcessBeforeInitialization</span>(
            <span style="color: #ce537a; font-weight: bold;">ConfigurableEmbeddedServletContainer</span> <span style="color: #7590db;">bean</span>) {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#25152;&#26377;&#30340;&#23450;&#21046;&#22120;&#65292;&#35843;&#29992;&#27599;&#19968;&#20010;&#23450;&#21046;&#22120;&#30340;customize&#26041;&#27861;&#26469;&#32473;Servlet&#23481;&#22120;&#36827;&#34892;&#23646;&#24615;&#36171;&#20540;&#65307;</span>
    <span style="color: #4f97d7; font-weight: bold;">for</span> (<span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerCustomizer</span> <span style="color: #7590db;">customizer</span> : getCustomizers()) {
        customizer.customize(bean);
    }
}

<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Collection</span>&lt;<span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerCustomizer</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">getCustomizers</span>() {
    <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.customizers == <span style="color: #a45bad;">null</span>) {
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Look up does not include the parent context</span>
        <span style="color: #4f97d7; font-weight: bold;">this</span>.customizers = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ArrayList</span>&lt;<span style="color: #ce537a; font-weight: bold;">EmbeddedServletContainerCustomizer</span>&gt;(
            <span style="color: #4f97d7; font-weight: bold;">this</span>.beanFactory
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#23481;&#22120;&#20013;&#33719;&#21462;&#25152;&#26377;&#36825;&#33883;&#31867;&#22411;&#30340;&#32452;&#20214;&#65306;EmbeddedServletContainerCustomizer</span>
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#21046;Servlet&#23481;&#22120;&#65292;&#32473;&#23481;&#22120;&#20013;&#21487;&#20197;&#28155;&#21152;&#19968;&#20010;EmbeddedServletContainerCustomizer&#31867;&#22411;&#30340;&#32452;&#20214;</span>
            .getBeansOfType(EmbeddedServletContainerCustomizer.<span style="color: #4f97d7; font-weight: bold;">class</span>,
                            <span style="color: #a45bad;">false</span>, <span style="color: #a45bad;">false</span>)
            .values());
        Collections.sort(<span style="color: #4f97d7; font-weight: bold;">this</span>.customizers, <span style="color: #a45bad;">AnnotationAwareOrderComparator</span>.INSTANCE);
        <span style="color: #4f97d7; font-weight: bold;">this</span>.customizers = Collections.unmodifiableList(<span style="color: #4f97d7; font-weight: bold;">this</span>.customizers);
    }
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">this</span>.customizers;
}

ServerProperties&#20063;&#26159;&#23450;&#21046;&#22120;
</pre>
</div>

<p>
步骤：
</p>

<p>
1）、SpringBoot根据导入的依赖情况，给容器中添加相应的EmbeddedServletContainerFactory【TomcatEmbeddedServletContainerFactory】
</p>

<p>
2）、容器中某个组件要创建对象就会惊动后置处理器；EmbeddedServletContainerCustomizerBeanPostProcessor；
</p>

<p>
只要是嵌入式的Servlet容器工厂，后置处理器就工作；
</p>

<p>
3）、后置处理器，从容器中获取所有的*EmbeddedServletContainerCustomizer*，调用定制器的定制方法
</p>
</div>
</li>

<li><a id="嵌入式servlet容器启动原理"></a>5）、嵌入式Servlet容器启动原理；<br />
<div class="outline-text-6" id="text-嵌入式servlet容器启动原理">
<p>
什么时候创建嵌入式的Servlet容器工厂？什么时候获取嵌入式的Servlet容器并启动Tomcat；
</p>

<p>
获取嵌入式的Servlet容器工厂：
</p>

<p>
1）、SpringBoot应用启动运行run方法
</p>

<p>
2）、refreshContext(context);SpringBoot刷新IOC容器【创建IOC容器对象，并初始化容器，创建容器中的每一个组件】；如果是web应用创建*AnnotationConfigEmbeddedWebApplicationContext*，否则：*AnnotationConfigApplicationContext*
</p>

<p>
3）、refresh(context);*刷新刚才创建好的ioc容器；*
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">refresh</span>() <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">BeansException</span>, <span style="color: #ce537a; font-weight: bold;">IllegalStateException</span> {
   <span style="color: #4f97d7; font-weight: bold;">synchronized</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.startupShutdownMonitor) {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Prepare this context for refreshing.</span>
      prepareRefresh();

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Tell the subclass to refresh the internal bean factory.</span>
      <span style="color: #ce537a; font-weight: bold;">ConfigurableListableBeanFactory</span> <span style="color: #7590db;">beanFactory</span> = obtainFreshBeanFactory();

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Prepare the bean factory for use in this context.</span>
      prepareBeanFactory(beanFactory);

      <span style="color: #4f97d7; font-weight: bold;">try</span> {
         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Allows post-processing of the bean factory in context subclasses.</span>
         postProcessBeanFactory(beanFactory);

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Invoke factory processors registered as beans in the context.</span>
         invokeBeanFactoryPostProcessors(beanFactory);

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Register bean processors that intercept bean creation.</span>
         registerBeanPostProcessors(beanFactory);

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Initialize message source for this context.</span>
         initMessageSource();

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Initialize event multicaster for this context.</span>
         initApplicationEventMulticaster();

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Initialize other special beans in specific context subclasses.</span>
         onRefresh();

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Check for listener beans and register them.</span>
         registerListeners();

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Instantiate all remaining (non-lazy-init) singletons.</span>
         finishBeanFactoryInitialization(beanFactory);

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Last step: publish corresponding event.</span>
         finishRefresh();
      }

      <span style="color: #4f97d7; font-weight: bold;">catch</span> (<span style="color: #ce537a; font-weight: bold;">BeansException</span> <span style="color: #7590db;">ex</span>) {
         <span style="color: #4f97d7; font-weight: bold;">if</span> (logger.isWarnEnabled()) {
            logger.warn(<span style="color: #2d9574;">"Exception encountered during context initialization - "</span> +
                  <span style="color: #2d9574;">"cancelling refresh attempt: "</span> + ex);
         }

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Destroy already created singletons to avoid dangling resources.</span>
         destroyBeans();

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Reset 'active' flag.</span>
         cancelRefresh(ex);

         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Propagate exception to caller.</span>
         <span style="color: #4f97d7; font-weight: bold;">throw</span> ex;
      }

      <span style="color: #4f97d7; font-weight: bold;">finally</span> {
         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Reset common introspection caches in Spring's core, since we</span>
         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">might not ever need metadata for singleton beans anymore...</span>
         resetCommonCaches();
      }
   }
}
</pre>
</div>

<p>
4）、 onRefresh(); web的ioc容器重写了onRefresh方法
</p>

<p>
5）、webioc容器会创建嵌入式的Servlet容器；*createEmbeddedServletContainer*();
</p>

<p>
<b>6）、获取嵌入式的Servlet容器工厂：</b>
</p>

<p>
EmbeddedServletContainerFactory containerFactory =
getEmbeddedServletContainerFactory();
</p>

<p>
​ 从ioc容器中获取EmbeddedServletContainerFactory
组件；*TomcatEmbeddedServletContainerFactory*创建对象，后置处理器一看是这个对象，就获取所有的定制器来先定制Servlet容器的相关配置；
</p>

<p>
7）、*使用容器工厂获取嵌入式的Servlet容器*：this.embeddedServletContainer
= containerFactory .getEmbeddedServletContainer(getSelfInitializer());
</p>

<p>
8）、嵌入式的Servlet容器创建对象并启动Servlet容器；
</p>

<p>
<b>先启动嵌入式的Servlet容器，再将ioc容器中剩下没有创建出的对象获取出来；</b>
</p>

<p>
<b><code>=IOC容器启动创建嵌入式的Servlet容器=</code></b>
</p>
</div>
</li>
</ul>
</li>

<li><a id="使用外置的servlet容器"></a>9、使用外置的Servlet容器<br />
<div class="outline-text-5" id="text-使用外置的servlet容器">
<p>
嵌入式Servlet容器：应用打成可执行的jar
</p>

<p>
​ 优点：简单、便携；
</p>

<p>
​
缺点：默认不支持JSP、优化定制比较复杂（使用定制器【ServerProperties、自定义EmbeddedServletContainerCustomizer】，自己编写嵌入式Servlet容器的创建工厂【EmbeddedServletContainerFactory】）；
</p>

<p>
外置的Servlet容器：外面安装Tomcat&#x2014;应用war包的方式打包；
</p>
</div>

<ul class="org-ul">
<li><a id="步骤"></a>步骤<br />
<div class="outline-text-6" id="text-步骤">
<p>
1）、必须创建一个war项目；（利用idea创建好目录结构）
</p>

<p>
2）、将嵌入式的Tomcat指定为provided；
</p>

<pre class="example">
&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
   &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</pre>

<p>
3）、必须编写一个*SpringBootServletInitializer*的子类，并调用configure方法
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ServletInitializer</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">SpringBootServletInitializer</span> {

   <span style="color: #a45bad;">@Override</span>
   <span style="color: #4f97d7; font-weight: bold;">protected</span> <span style="color: #ce537a; font-weight: bold;">SpringApplicationBuilder</span> <span style="color: #bc6ec5; font-weight: bold;">configure</span>(<span style="color: #ce537a; font-weight: bold;">SpringApplicationBuilder</span> <span style="color: #7590db;">application</span>) {
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20256;&#20837;SpringBoot&#24212;&#29992;&#30340;&#20027;&#31243;&#24207;</span>
      <span style="color: #4f97d7; font-weight: bold;">return</span> application.sources(SpringBoot04WebJspApplication.<span style="color: #4f97d7; font-weight: bold;">class</span>);
   }

}
</pre>
</div>

<p>
4）、启动服务器就可以使用；
</p>
</div>
</li>

<li><a id="原理"></a>原理<br />
<div class="outline-text-6" id="text-原理">
<p>
jar包：执行SpringBoot主类的main方法，启动ioc容器，创建嵌入式的Servlet容器；
</p>

<p>
war包：启动服务器，*服务器启动SpringBoot应用*【SpringBootServletInitializer】，启动ioc容器；
</p>

<p>
servlet3.0（Spring注解版）：
</p>

<p>
8.2.4 Shared libraries / runtimes pluggability：
</p>

<p>
规则：
</p>

<p>
​
1）、服务器启动（web应用启动）会创建当前web应用里面每一个jar包里面ServletContainerInitializer实例：
</p>

<p>
​
2）、ServletContainerInitializer的实现放在jar包的META-INF/services文件夹下，有一个名为javax.servlet.ServletContainerInitializer的文件，内容就是ServletContainerInitializer的实现类的全类名
</p>

<p>
​ 3）、还可以使用@HandlesTypes，在应用启动的时候加载我们感兴趣的类；
</p>

<p>
流程：
</p>

<p>
1）、启动Tomcat
</p>

<p>
2）、org\springframework\spring-web\4.3.14.RELEASE\spring-web-4.3.14.RELEASE.jar!\META-INF\services\javax.servlet.ServletContainerInitializer：
</p>

<p>
Spring的web模块里面有这个文件：*org.springframework.web.SpringServletContainerInitializer*
</p>

<p>
3）、SpringServletContainerInitializer将@HandlesTypes(WebApplicationInitializer.class)标注的所有这个类型的类都传入到onStartup方法的Set<Class<?>&gt;；为这些WebApplicationInitializer类型的类创建实例；
</p>

<p>
4）、每一个WebApplicationInitializer都调用自己的onStartup；
</p>


<div class="figure">
<p><img src="images/搜狗截图20180302221835.png" alt="搜狗截图20180302221835.png" />
</p>
</div>

<p>
5）、相当于我们的SpringBootServletInitializer的类会被创建对象，并执行onStartup方法
</p>

<p>
6）、SpringBootServletInitializer实例执行onStartup的时候会createRootApplicationContext；创建容器
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">protected</span> <span style="color: #ce537a; font-weight: bold;">WebApplicationContext</span> <span style="color: #bc6ec5; font-weight: bold;">createRootApplicationContext</span>(
      <span style="color: #ce537a; font-weight: bold;">ServletContext</span> <span style="color: #7590db;">servletContext</span>) {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">1&#12289;&#21019;&#24314;SpringApplicationBuilder</span>
   <span style="color: #ce537a; font-weight: bold;">SpringApplicationBuilder</span> <span style="color: #7590db;">builder</span> = createSpringApplicationBuilder();
   <span style="color: #ce537a; font-weight: bold;">StandardServletEnvironment</span> <span style="color: #7590db;">environment</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StandardServletEnvironment</span>();
   environment.initPropertySources(servletContext, <span style="color: #a45bad;">null</span>);
   builder.environment(environment);
   builder.main(getClass());
   <span style="color: #ce537a; font-weight: bold;">ApplicationContext</span> <span style="color: #7590db;">parent</span> = getExistingRootWebApplicationContext(servletContext);
   <span style="color: #4f97d7; font-weight: bold;">if</span> (parent != <span style="color: #a45bad;">null</span>) {
      <span style="color: #4f97d7; font-weight: bold;">this</span>.logger.info(<span style="color: #2d9574;">"Root context already created (using as parent)."</span>);
      servletContext.setAttribute(
            <span style="color: #a45bad;">WebApplicationContext</span>.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, <span style="color: #a45bad;">null</span>);
      builder.initializers(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ParentContextApplicationContextInitializer</span>(parent));
   }
   builder.initializers(
         <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ServletContextApplicationContextInitializer</span>(servletContext));
   builder.contextClass(AnnotationConfigEmbeddedWebApplicationContext.<span style="color: #4f97d7; font-weight: bold;">class</span>);

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#35843;&#29992;configure&#26041;&#27861;&#65292;&#23376;&#31867;&#37325;&#20889;&#20102;&#36825;&#20010;&#26041;&#27861;&#65292;&#23558;SpringBoot&#30340;&#20027;&#31243;&#24207;&#31867;&#20256;&#20837;&#20102;&#36827;&#26469;</span>
   builder = configure(builder);

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;builder&#21019;&#24314;&#19968;&#20010;Spring&#24212;&#29992;</span>
   <span style="color: #ce537a; font-weight: bold;">SpringApplication</span> <span style="color: #7590db;">application</span> = builder.build();
   <span style="color: #4f97d7; font-weight: bold;">if</span> (application.getSources().isEmpty() &amp;&amp; AnnotationUtils
         .findAnnotation(getClass(), Configuration.<span style="color: #4f97d7; font-weight: bold;">class</span>) != <span style="color: #a45bad;">null</span>) {
      application.getSources().add(getClass());
   }
   Assert.state(<span style="color: #a45bad;">!</span>application.getSources().isEmpty(),
         <span style="color: #2d9574;">"No SpringApplication sources have been defined. Either override the "</span>
               + <span style="color: #2d9574;">"configure method or add an @Configuration annotation"</span>);
   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Ensure error pages are registered</span>
   <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.registerErrorPageFilter) {
      application.getSources().add(ErrorPageFilterConfiguration.<span style="color: #4f97d7; font-weight: bold;">class</span>);
   }
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21551;&#21160;Spring&#24212;&#29992;</span>
   <span style="color: #4f97d7; font-weight: bold;">return</span> run(application);
}
</pre>
</div>

<p>
7）、Spring的应用就启动并且创建IOC容器
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #bc6ec5; font-weight: bold;">run</span>(<span style="color: #ce537a; font-weight: bold;">String</span>... <span style="color: #7590db;">args</span>) {
   <span style="color: #ce537a; font-weight: bold;">StopWatch</span> <span style="color: #7590db;">stopWatch</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StopWatch</span>();
   stopWatch.start();
   <span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #7590db;">context</span> = <span style="color: #a45bad;">null</span>;
   <span style="color: #ce537a; font-weight: bold;">FailureAnalyzers</span> <span style="color: #7590db;">analyzers</span> = <span style="color: #a45bad;">null</span>;
   configureHeadlessProperty();
   <span style="color: #ce537a; font-weight: bold;">SpringApplicationRunListeners</span> <span style="color: #7590db;">listeners</span> = getRunListeners(args);
   listeners.starting();
   <span style="color: #4f97d7; font-weight: bold;">try</span> {
      <span style="color: #ce537a; font-weight: bold;">ApplicationArguments</span> <span style="color: #7590db;">applicationArguments</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">DefaultApplicationArguments</span>(
            args);
      <span style="color: #ce537a; font-weight: bold;">ConfigurableEnvironment</span> <span style="color: #7590db;">environment</span> = prepareEnvironment(listeners,
            applicationArguments);
      <span style="color: #ce537a; font-weight: bold;">Banner</span> <span style="color: #7590db;">printedBanner</span> = printBanner(environment);
      context = createApplicationContext();
      analyzers = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">FailureAnalyzers</span>(context);
      prepareContext(context, environment, listeners, applicationArguments,
            printedBanner);

       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21047;&#26032;IOC&#23481;&#22120;</span>
      refreshContext(context);
      afterRefresh(context, applicationArguments);
      listeners.finished(context, <span style="color: #a45bad;">null</span>);
      stopWatch.stop();
      <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.logStartupInfo) {
         <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StartupInfoLogger</span>(<span style="color: #4f97d7; font-weight: bold;">this</span>.mainApplicationClass)
               .logStarted(getApplicationLog(), stopWatch);
      }
      <span style="color: #4f97d7; font-weight: bold;">return</span> context;
   }
   <span style="color: #4f97d7; font-weight: bold;">catch</span> (<span style="color: #ce537a; font-weight: bold;">Throwable</span> <span style="color: #7590db;">ex</span>) {
      handleRunFailure(context, listeners, analyzers, ex);
      <span style="color: #4f97d7; font-weight: bold;">throw</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">IllegalStateException</span>(ex);
   }
}
</pre>
</div>

<p>
<b><code>=启动Servlet容器，再启动SpringBoot应用=</code></b>
</p>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgacd8748" class="outline-4">
<h4 id="五docker">五、Docker</h4>
<div class="outline-text-4" id="text-五docker">
</div>

<ul class="org-ul">
<li><a id="简介-1"></a>1、简介<br />
<div class="outline-text-5" id="text-简介-1">
<p>
*Docker*是一个开源的应用容器引擎；是一个轻量级容器技术；
</p>

<p>
Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像；
</p>

<p>
运行中的这个镜像称为容器，容器启动是非常快速的。
</p>


<div class="figure">
<p><img src="images/搜狗截图20180303145450.png" alt="搜狗截图20180303145450.png" />
</p>
</div>


<div class="figure">
<p><img src="images/搜狗截图20180303145531.png" alt="搜狗截图20180303145531.png" />
</p>
</div>
</div>
</li>

<li><a id="核心概念"></a>2、核心概念<br />
<div class="outline-text-5" id="text-核心概念">
<p>
docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）；
</p>

<p>
docker客户端(Client)：连接docker主机进行操作；
</p>

<p>
docker仓库(Registry)：用来保存各种打包好的软件镜像；
</p>

<p>
docker镜像(Images)：软件打包好的镜像；放在docker仓库中；
</p>

<p>
docker容器(Container)：镜像启动后的实例称为一个容器；容器是独立运行的一个或一组应用
</p>


<div class="figure">
<p><img src="images/搜狗截图20180303165113.png" alt="搜狗截图20180303165113.png" />
</p>
</div>

<p>
使用Docker的步骤：
</p>

<p>
1）、安装Docker
</p>

<p>
2）、去Docker仓库找到这个软件对应的镜像；
</p>

<p>
3）、使用Docker运行这个镜像，这个镜像就会生成一个Docker容器；
</p>

<p>
4）、对容器的启动停止就是对软件的启动停止；
</p>
</div>
</li>

<li><a id="安装docker"></a>3、安装Docker<br />
<div class="outline-text-5" id="text-安装docker">
</div>

<ul class="org-ul">
<li><a id="安装linux虚拟机"></a>1）、安装linux虚拟机<br />
<div class="outline-text-7" id="text-安装linux虚拟机">
<p>
​ 1）、VMWare、VirtualBox（安装）；
</p>

<p>
​ 2）、导入虚拟机文件centos7-atguigu.ova；
</p>

<p>
​ 3）、双击启动linux虚拟机;使用 root/ 123456登陆
</p>

<p>
​ 4）、使用客户端连接linux服务器进行命令操作；
</p>

<p>
​ 5）、设置虚拟机网络；
</p>

<p>
​ 桥接网络===选好网卡====接入网线；
</p>

<p>
​ 6）、设置好网络以后使用命令重启虚拟机的网络
</p>

<pre class="example">
service network restart
</pre>

<p>
​ 7）、查看linux的ip地址
</p>

<pre class="example">
ip addr
</pre>

<p>
​ 8）、使用客户端连接linux；
</p>
</div>
</li>

<li><a id="在linux虚拟机上安装docker"></a>2）、在linux虚拟机上安装docker<br />
<div class="outline-text-7" id="text-在linux虚拟机上安装docker">
<p>
步骤：
</p>

<pre class="example">
1、检查内核版本，必须是3.10及以上
uname -r
2、安装docker
yum install docker
3、输入y确认安装
4、启动docker
[root@localhost ~]# systemctl start docker
[root@localhost ~]# docker -v
Docker version 1.12.6, build 3e8e77d/1.12.6
5、开机启动docker
[root@localhost ~]# systemctl enable docker
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
6、停止docker
systemctl stop docker
</pre>
</div>
</li>
</ul>
</li>

<li><a id="docker常用命令操作"></a>4、Docker常用命令&amp;操作<br />
<div class="outline-text-5" id="text-docker常用命令操作">
</div>

<ul class="org-ul">
<li><a id="镜像操作"></a>1）、镜像操作<br />
<div class="outline-text-6" id="text-镜像操作">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">操作</th>
<th scope="col" class="org-left">命令</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">检索</td>
<td class="org-left">docker search 关键字 eg：docker search redis</td>
<td class="org-left">我们经常去docker hub上检索镜像的详细信息，如镜像的TAG。</td>
</tr>

<tr>
<td class="org-left">拉取</td>
<td class="org-left">docker pull 镜像名:tag</td>
<td class="org-left">:tag是可选的，tag表示标签，多为软件的版本，默认是latest</td>
</tr>

<tr>
<td class="org-left">列表</td>
<td class="org-left">docker images</td>
<td class="org-left">查看所有本地镜像</td>
</tr>

<tr>
<td class="org-left">删除</td>
<td class="org-left">docker rmi image-id</td>
<td class="org-left">删除指定的本地镜像</td>
</tr>
</tbody>
</table>

<p>
<a href="https://hub.docker.com/">https://hub.docker.com/</a>
</p>
</div>
</li>

<li><a id="容器操作"></a>2）、容器操作<br />
<div class="outline-text-6" id="text-容器操作">
<p>
软件镜像（QQ安装程序）-&#x2014;运行镜像-&#x2014;产生一个容器（正在运行的软件，运行的QQ）；
</p>

<p>
步骤：
</p>

<pre class="example">
1、搜索镜像
[root@localhost ~]# docker search tomcat
2、拉取镜像
[root@localhost ~]# docker pull tomcat
3、根据镜像启动容器
docker run --name mytomcat -d tomcat:latest
4、docker ps  
查看运行中的容器
5、 停止运行中的容器
docker stop  容器的id
6、查看所有的容器
docker ps -a
7、启动容器
docker start 容器id
8、删除一个容器
 docker rm 容器id
9、启动一个做了端口映射的tomcat
[root@localhost ~]# docker run -d -p 8888:8080 tomcat
-d：后台运行
-p: 将主机的端口映射到容器的一个端口    主机端口:容器内部的端口

10、为了演示简单关闭了linux的防火墙
service firewalld status ；查看防火墙状态
service firewalld stop：关闭防火墙
11、查看容器的日志
docker logs container-name/container-id

更多命令参看
https://docs.docker.com/engine/reference/commandline/docker/
可以参考每一个镜像的文档
</pre>
</div>
</li>

<li><a id="安装mysql示例"></a>3）、安装MySQL示例<br />
<div class="outline-text-6" id="text-安装mysql示例">
<pre class="example">
docker pull mysql
</pre>

<p>
错误的启动
</p>

<pre class="example">
[root@localhost ~]# docker run --name mysql01 -d mysql
42f09819908bb72dd99ae19e792e0a5d03c48638421fa64cce5f8ba0f40f5846

mysql退出了
[root@localhost ~]# docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                           PORTS               NAMES
42f09819908b        mysql               "docker-entrypoint.sh"   34 seconds ago      Exited (1) 33 seconds ago                            mysql01
538bde63e500        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       compassionate_
goldstine
c4f1ac60b3fc        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       lonely_fermi
81ec743a5271        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       sick_ramanujan


//错误日志
[root@localhost ~]# docker logs 42f09819908b
error: database is uninitialized and password option is not specified 
  You need to specify one of MYSQL_ROOT_PASSWORD, MYSQL_ALLOW_EMPTY_PASSWORD and MYSQL_RANDOM_ROOT_PASSWORD；这个三个参数必须指定一个
</pre>

<p>
正确的启动
</p>

<pre class="example">
[root@localhost ~]# docker run --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysql
b874c56bec49fb43024b3805ab51e9097da779f2f572c22c695305dedd684c5f
[root@localhost ~]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
b874c56bec49        mysql               "docker-entrypoint.sh"   4 seconds ago       Up 3 seconds        3306/tcp            mysql01
</pre>

<p>
做了端口映射
</p>

<pre class="example">
[root@localhost ~]# docker run -p 3306:3306 --name mysql02 -e MYSQL_ROOT_PASSWORD=123456 -d mysql
ad10e4bc5c6a0f61cbad43898de71d366117d120e39db651844c0e73863b9434
[root@localhost ~]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
ad10e4bc5c6a        mysql               "docker-entrypoint.sh"   4 seconds ago       Up 2 seconds        0.0.0.0:3306-&gt;3306/tcp   mysql02
</pre>

<p>
几个其他的高级操作
</p>

<pre class="example">
docker run --name mysql03 -v /conf/mysql:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag
把主机的/conf/mysql文件夹挂载到 mysqldocker容器的/etc/mysql/conf.d文件夹里面
改mysql的配置文件就只需要把mysql配置文件放在自定义的文件夹下（/conf/mysql）

docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci
指定mysql的一些配置参数
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org83b3863" class="outline-4">
<h4 id="六springboot与数据访问">六、SpringBoot与数据访问</h4>
<div class="outline-text-4" id="text-六springboot与数据访问">
</div>

<ul class="org-ul">
<li><a id="jdbc"></a>1、JDBC<br />
<div class="outline-text-5" id="text-jdbc">
<pre class="example">
&lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
</pre>

<pre class="example">
spring:
  datasource:
    username: root
    password: 123456
    url: jdbc:mysql://192.168.15.22:3306/jdbc
    driver-class-name: com.mysql.jdbc.Driver
</pre>

<p>
效果：
</p>

<p>
​ 默认是用org.apache.tomcat.jdbc.pool.DataSource作为数据源；
</p>

<p>
​ 数据源的相关配置都在DataSourceProperties里面；
</p>

<p>
自动配置原理：
</p>

<p>
org.springframework.boot.autoconfigure.jdbc：
</p>

<p>
1、参考DataSourceConfiguration，根据配置创建数据源，默认使用Tomcat连接池；可以使用spring.datasource.type指定自定义的数据源类型；
</p>

<p>
2、SpringBoot默认可以支持；
</p>

<pre class="example">
org.apache.tomcat.jdbc.pool.DataSource、HikariDataSource、BasicDataSource、
</pre>

<p>
3、自定义数据源类型
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #9f8766;">/**</span>
<span style="color: #9f8766;"> * Generic DataSource configuration.</span>
<span style="color: #9f8766;"> */</span>
<span style="color: #a45bad;">@ConditionalOnMissingBean</span>(DataSource.<span style="color: #4f97d7; font-weight: bold;">class</span>)
<span style="color: #a45bad;">@ConditionalOnProperty</span>(name = <span style="color: #2d9574;">"spring.datasource.type"</span>)
<span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Generic</span> {

   <span style="color: #a45bad;">@Bean</span>
   <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">DataSource</span> <span style="color: #bc6ec5; font-weight: bold;">dataSource</span>(<span style="color: #ce537a; font-weight: bold;">DataSourceProperties</span> <span style="color: #7590db;">properties</span>) {
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;DataSourceBuilder&#21019;&#24314;&#25968;&#25454;&#28304;&#65292;&#21033;&#29992;&#21453;&#23556;&#21019;&#24314;&#21709;&#24212;type&#30340;&#25968;&#25454;&#28304;&#65292;&#24182;&#19988;&#32465;&#23450;&#30456;&#20851;&#23646;&#24615;</span>
      <span style="color: #4f97d7; font-weight: bold;">return</span> properties.initializeDataSourceBuilder().build();
   }

}
</pre>
</div>

<p>
4、*DataSourceInitializer：ApplicationListener*；
</p>

<p>
​ 作用：
</p>

<p>
​ 1）、runSchemaScripts();运行建表语句；
</p>

<p>
​ 2）、runDataScripts();运行插入数据的sql语句；
</p>

<p>
默认只需要将文件命名为：
</p>

<pre class="example">
schema-*.sql、data-*.sql
默认规则：schema.sql，schema-all.sql；
可以使用   
    schema:
      - classpath:department.sql
      指定位置
</pre>

<p>
5、操作数据库：自动配置了JdbcTemplate操作数据库
</p>
</div>
</li>

<li><a id="整合druid数据源"></a>2、整合Druid数据源<br />
<div class="outline-text-5" id="text-整合druid数据源">
<div class="org-src-container">
<pre class="src src-java">&#23548;&#20837;druid&#25968;&#25454;&#28304;
<span style="color: #ce537a; font-weight: bold;">@Configuration</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> DruidConfig {

    <span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"spring.datasource"</span>)
    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">DataSource</span> <span style="color: #bc6ec5; font-weight: bold;">druid</span>(){
       <span style="color: #4f97d7; font-weight: bold;">return</span>  <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">DruidDataSource</span>();
    }

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#37197;&#32622;Druid&#30340;&#30417;&#25511;</span>
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">1&#12289;&#37197;&#32622;&#19968;&#20010;&#31649;&#29702;&#21518;&#21488;&#30340;Servlet</span>
    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span> <span style="color: #bc6ec5; font-weight: bold;">statViewServlet</span>(){
        <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span> <span style="color: #7590db;">bean</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ServletRegistrationBean</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StatViewServlet</span>(), <span style="color: #2d9574;">"/druid/*"</span>);
        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">String</span>&gt; <span style="color: #7590db;">initParams</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HashMap</span>&lt;&gt;();

        initParams.put(<span style="color: #2d9574;">"loginUsername"</span>,<span style="color: #2d9574;">"admin"</span>);
        initParams.put(<span style="color: #2d9574;">"loginPassword"</span>,<span style="color: #2d9574;">"123456"</span>);
        initParams.put(<span style="color: #2d9574;">"allow"</span>,<span style="color: #2d9574;">""</span>);<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#40664;&#35748;&#23601;&#26159;&#20801;&#35768;&#25152;&#26377;&#35775;&#38382;</span>
        initParams.put(<span style="color: #2d9574;">"deny"</span>,<span style="color: #2d9574;">"192.168.15.21"</span>);

        bean.setInitParameters(initParams);
        <span style="color: #4f97d7; font-weight: bold;">return</span> bean;
    }


    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">2&#12289;&#37197;&#32622;&#19968;&#20010;web&#30417;&#25511;&#30340;filter</span>
    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">FilterRegistrationBean</span> <span style="color: #bc6ec5; font-weight: bold;">webStatFilter</span>(){
        <span style="color: #ce537a; font-weight: bold;">FilterRegistrationBean</span> <span style="color: #7590db;">bean</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">FilterRegistrationBean</span>();
        bean.setFilter(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">WebStatFilter</span>());

        <span style="color: #ce537a; font-weight: bold;">Map</span>&lt;<span style="color: #ce537a; font-weight: bold;">String</span>,<span style="color: #ce537a; font-weight: bold;">String</span>&gt; <span style="color: #7590db;">initParams</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HashMap</span>&lt;&gt;();
        initParams.put(<span style="color: #2d9574;">"exclusions"</span>,<span style="color: #2d9574;">"*.js,*.css,/druid/*"</span>);

        bean.setInitParameters(initParams);

        bean.setUrlPatterns(Arrays.asList(<span style="color: #2d9574;">"/*"</span>));

        <span style="color: #4f97d7; font-weight: bold;">return</span>  bean;
    }
}
</pre>
</div>
</div>
</li>

<li><a id="整合mybatis"></a>3、整合MyBatis<br />
<div class="outline-text-5" id="text-整合mybatis">
<pre class="example">
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.3.1&lt;/version&gt;
&lt;/dependency&gt;
</pre>


<div class="figure">
<p><img src="images/搜狗截图20180305194443.png" alt="搜狗截图20180305194443.png" />
</p>
</div>

<p>
步骤：
</p>

<p>
​ 1）、配置数据源相关属性（见上一节Druid）
</p>

<p>
​ 2）、给数据库建表
</p>

<p>
​ 3）、创建JavaBean
</p>
</div>

<ul class="org-ul">
<li><a id="注解版"></a>4）、注解版<br />
<div class="outline-text-6" id="text-注解版">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25351;&#23450;&#36825;&#26159;&#19968;&#20010;&#25805;&#20316;&#25968;&#25454;&#24211;&#30340;mapper</span>
<span style="color: #a45bad;">@Mapper</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">DepartmentMapper</span> {

    <span style="color: #a45bad;">@Select</span>(<span style="color: #2d9574;">"select * from department where id=#{id}"</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Department</span> <span style="color: #bc6ec5; font-weight: bold;">getDeptById</span>(<span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">id</span>);

    <span style="color: #a45bad;">@Delete</span>(<span style="color: #2d9574;">"delete from department where id=#{id}"</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">deleteDeptById</span>(<span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">id</span>);

    <span style="color: #a45bad;">@Options</span>(useGeneratedKeys = <span style="color: #a45bad;">true</span>,keyProperty = <span style="color: #2d9574;">"id"</span>)
    <span style="color: #a45bad;">@Insert</span>(<span style="color: #2d9574;">"insert into department(departmentName) values(#{departmentName})"</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">insertDept</span>(<span style="color: #ce537a; font-weight: bold;">Department</span> <span style="color: #7590db;">department</span>);

    <span style="color: #a45bad;">@Update</span>(<span style="color: #2d9574;">"update department set departmentName=#{departmentName} where id=#{id}"</span>)
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">updateDept</span>(<span style="color: #ce537a; font-weight: bold;">Department</span> <span style="color: #7590db;">department</span>);
}
</pre>
</div>

<p>
问题：
</p>

<p>
自定义MyBatis的配置规则；给容器中添加一个ConfigurationCustomizer；
</p>

<div class="org-src-container">
<pre class="src src-java">@<span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">context</span>.<span style="color: #a45bad;">annotation</span>.Configuration
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> MyBatisConfig {

    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ConfigurationCustomizer</span> <span style="color: #bc6ec5; font-weight: bold;">configurationCustomizer</span>(){
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ConfigurationCustomizer</span>(){

            <span style="color: #a45bad;">@Override</span>
            <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">customize</span>(<span style="color: #ce537a; font-weight: bold;">Configuration</span> <span style="color: #7590db;">configuration</span>) {
                configuration.setMapUnderscoreToCamelCase(<span style="color: #a45bad;">true</span>);
            }
        };
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-java">&#20351;&#29992;MapperScan&#25209;&#37327;&#25195;&#25551;&#25152;&#26377;&#30340;Mapper&#25509;&#21475;&#65307;
<span style="color: #a45bad;">@MapperScan</span>(value = <span style="color: #2d9574;">"com.atguigu.springboot.mapper"</span>)
<span style="color: #a45bad;">@SpringBootApplication</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> SpringBoot06DataMybatisApplication {

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>(<span style="color: #ce537a; font-weight: bold;">String</span>[] <span style="color: #7590db;">args</span>) {
        SpringApplication.run(SpringBoot06DataMybatisApplication.<span style="color: #4f97d7; font-weight: bold;">class</span>, args);
    }
}
</pre>
</div>
</div>
</li>

<li><a id="配置文件版"></a>5）、配置文件版<br />
<div class="outline-text-6" id="text-配置文件版">
<pre class="example">
mybatis:
  config-location: classpath:mybatis/mybatis-config.xml 指定全局配置文件的位置
  mapper-locations: classpath:mybatis/mapper/*.xml  指定sql映射文件的位置
</pre>

<p>
更多使用参照
</p>

<p>
<a href="http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/">http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/</a>
</p>
</div>
</li>
</ul>
</li>

<li><a id="整合springdata-jpa"></a>4、整合SpringData JPA<br />
<div class="outline-text-5" id="text-整合springdata-jpa">
</div>

<ul class="org-ul">
<li><a id="springdata简介"></a>1）、SpringData简介<br />
<div class="outline-text-6" id="text-springdata简介">

<div class="figure">
<p><img src="images/搜狗截图20180306105412.png" alt="搜狗截图20180306105412.png" />
</p>
</div>
</div>
</li>

<li><a id="整合springdata-jpa-1"></a>2）、整合SpringData JPA<br />
<div class="outline-text-6" id="text-整合springdata-jpa-1">
<p>
JPA:ORM（Object Relational Mapping）；
</p>

<p>
1）、编写一个实体类（bean）和数据表进行映射，并且配置好映射关系；
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;JPA&#27880;&#35299;&#37197;&#32622;&#26144;&#23556;&#20851;&#31995;</span>
<span style="color: #a45bad;">@Entity</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21578;&#35785;JPA&#36825;&#26159;&#19968;&#20010;&#23454;&#20307;&#31867;&#65288;&#21644;&#25968;&#25454;&#34920;&#26144;&#23556;&#30340;&#31867;&#65289;</span>
<span style="color: #a45bad;">@Table</span>(name = <span style="color: #2d9574;">"tbl_user"</span>) <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">@Table&#26469;&#25351;&#23450;&#21644;&#21738;&#20010;&#25968;&#25454;&#34920;&#23545;&#24212;;&#22914;&#26524;&#30465;&#30053;&#40664;&#35748;&#34920;&#21517;&#23601;&#26159;user&#65307;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">User</span> {

    <span style="color: #a45bad;">@Id</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#36825;&#26159;&#19968;&#20010;&#20027;&#38190;</span>
    <span style="color: #a45bad;">@GeneratedValue</span>(strategy = <span style="color: #a45bad;">GenerationType</span>.IDENTITY)<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#33258;&#22686;&#20027;&#38190;</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Integer</span> <span style="color: #7590db;">id</span>;

    <span style="color: #a45bad;">@Column</span>(name = <span style="color: #2d9574;">"last_name"</span>,length = 50) <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#36825;&#26159;&#21644;&#25968;&#25454;&#34920;&#23545;&#24212;&#30340;&#19968;&#20010;&#21015;</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">lastName</span>;
    <span style="color: #a45bad;">@Column</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#30465;&#30053;&#40664;&#35748;&#21015;&#21517;&#23601;&#26159;&#23646;&#24615;&#21517;</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">email</span>;
</pre>
</div>

<p>
2）、编写一个Dao接口来操作实体类对应的数据表（Repository）
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#32487;&#25215;JpaRepository&#26469;&#23436;&#25104;&#23545;&#25968;&#25454;&#24211;&#30340;&#25805;&#20316;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">UserRepository</span> <span style="color: #4f97d7; font-weight: bold;">extends</span> <span style="color: #ce537a; font-weight: bold;">JpaRepository</span>&lt;<span style="color: #ce537a; font-weight: bold;">User</span>,<span style="color: #ce537a; font-weight: bold;">Integer</span>&gt; {
}
</pre>
</div>

<p>
3）、基本的配置JpaProperties
</p>

<pre class="example">
spring:  
 jpa:
    hibernate:
#     更新或者创建数据表结构
      ddl-auto: update
#    控制台显示SQL
    show-sql: true
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-org5a69a6f" class="outline-4">
<h4 id="七启动配置原理">七、启动配置原理</h4>
<div class="outline-text-4" id="text-七启动配置原理">
<p>
几个重要的事件回调机制
</p>

<p>
配置在META-INF/spring.factories
</p>

<p>
<b>ApplicationContextInitializer</b>
</p>

<p>
<b>SpringApplicationRunListener</b>
</p>

<p>
只需要放在ioc容器中
</p>

<p>
<b>ApplicationRunner</b>
</p>

<p>
<b>CommandLineRunner</b>
</p>

<p>
启动流程：
</p>
</div>

<ul class="org-ul">
<li><a id="创建springapplication对象"></a><b>1、创建SpringApplication对象</b><br />
<div class="outline-text-5" id="text-创建springapplication对象">
<div class="org-src-container">
<pre class="src src-java">initialize(<span style="color: #ce537a; font-weight: bold;">sources</span>);
<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">initialize</span>(<span style="color: #ce537a; font-weight: bold;">Object</span>[] <span style="color: #7590db;">sources</span>) {
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20445;&#23384;&#20027;&#37197;&#32622;&#31867;</span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> (sources != <span style="color: #a45bad;">null</span> &amp;&amp; sources.length &gt; 0) {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.sources.addAll(Arrays.asList(sources));
    }
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21028;&#26029;&#24403;&#21069;&#26159;&#21542;&#19968;&#20010;web&#24212;&#29992;</span>
    <span style="color: #4f97d7; font-weight: bold;">this</span>.webEnvironment = deduceWebEnvironment();
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#31867;&#36335;&#24452;&#19979;&#25214;&#21040;META-INF/spring.factories&#37197;&#32622;&#30340;&#25152;&#26377;ApplicationContextInitializer&#65307;&#28982;&#21518;&#20445;&#23384;&#36215;&#26469;</span>
    setInitializers((<span style="color: #ce537a; font-weight: bold;">Collection</span>) getSpringFactoriesInstances(
        ApplicationContextInitializer.<span style="color: #4f97d7; font-weight: bold;">class</span>));
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#31867;&#36335;&#24452;&#19979;&#25214;&#21040;ETA-INF/spring.factories&#37197;&#32622;&#30340;&#25152;&#26377;ApplicationListener</span>
    setListeners((<span style="color: #ce537a; font-weight: bold;">Collection</span>) getSpringFactoriesInstances(ApplicationListener.<span style="color: #4f97d7; font-weight: bold;">class</span>));
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#22810;&#20010;&#37197;&#32622;&#31867;&#20013;&#25214;&#21040;&#26377;main&#26041;&#27861;&#30340;&#20027;&#37197;&#32622;&#31867;</span>
    <span style="color: #4f97d7; font-weight: bold;">this</span>.mainApplicationClass = deduceMainApplicationClass();
}
</pre>
</div>


<div class="figure">
<p><img src="images/搜狗截图20180306145727.png" alt="搜狗截图20180306145727.png" />
</p>
</div>


<div class="figure">
<p><img src="images/搜狗截图20180306145855.png" alt="搜狗截图20180306145855.png" />
</p>
</div>
</div>
</li>

<li><a id="运行run方法"></a>2、运行run方法<br />
<div class="outline-text-5" id="text-运行run方法">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #bc6ec5; font-weight: bold;">run</span>(<span style="color: #ce537a; font-weight: bold;">String</span>... <span style="color: #7590db;">args</span>) {
   <span style="color: #ce537a; font-weight: bold;">StopWatch</span> <span style="color: #7590db;">stopWatch</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StopWatch</span>();
   stopWatch.start();
   <span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #7590db;">context</span> = <span style="color: #a45bad;">null</span>;
   <span style="color: #ce537a; font-weight: bold;">FailureAnalyzers</span> <span style="color: #7590db;">analyzers</span> = <span style="color: #a45bad;">null</span>;
   configureHeadlessProperty();

   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;SpringApplicationRunListeners&#65307;&#20174;&#31867;&#36335;&#24452;&#19979;META-INF/spring.factories</span>
   <span style="color: #ce537a; font-weight: bold;">SpringApplicationRunListeners</span> <span style="color: #7590db;">listeners</span> = getRunListeners(args);
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22238;&#35843;&#25152;&#26377;&#30340;&#33719;&#21462;SpringApplicationRunListener.starting()&#26041;&#27861;</span>
   listeners.starting();
   <span style="color: #4f97d7; font-weight: bold;">try</span> {
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#23553;&#35013;&#21629;&#20196;&#34892;&#21442;&#25968;</span>
      <span style="color: #ce537a; font-weight: bold;">ApplicationArguments</span> <span style="color: #7590db;">applicationArguments</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">DefaultApplicationArguments</span>(
            args);
      <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20934;&#22791;&#29615;&#22659;</span>
      <span style="color: #ce537a; font-weight: bold;">ConfigurableEnvironment</span> <span style="color: #7590db;">environment</span> = prepareEnvironment(listeners,
            applicationArguments);
            <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21019;&#24314;&#29615;&#22659;&#23436;&#25104;&#21518;&#22238;&#35843;SpringApplicationRunListener.environmentPrepared()&#65307;&#34920;&#31034;&#29615;&#22659;&#20934;&#22791;&#23436;&#25104;</span>

      <span style="color: #ce537a; font-weight: bold;">Banner</span> <span style="color: #7590db;">printedBanner</span> = printBanner(environment);

       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#21019;&#24314;ApplicationContext&#65307;&#20915;&#23450;&#21019;&#24314;web&#30340;ioc&#36824;&#26159;&#26222;&#36890;&#30340;ioc</span>
      context = createApplicationContext();

      analyzers = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">FailureAnalyzers</span>(context);
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20934;&#22791;&#19978;&#19979;&#25991;&#29615;&#22659;;&#23558;environment&#20445;&#23384;&#21040;ioc&#20013;&#65307;&#32780;&#19988;applyInitializers()&#65307;</span>
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">applyInitializers()&#65306;&#22238;&#35843;&#20043;&#21069;&#20445;&#23384;&#30340;&#25152;&#26377;&#30340;ApplicationContextInitializer&#30340;initialize&#26041;&#27861;</span>
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22238;&#35843;&#25152;&#26377;&#30340;SpringApplicationRunListener&#30340;contextPrepared()&#65307;</span>
       <span style="color: #2aa1ae; background-color: #292e34;">//</span>
      prepareContext(context, environment, listeners, applicationArguments,
            printedBanner);
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">prepareContext&#36816;&#34892;&#23436;&#25104;&#20197;&#21518;&#22238;&#35843;&#25152;&#26377;&#30340;SpringApplicationRunListener&#30340;contextLoaded&#65288;&#65289;&#65307;</span>

       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">s&#21047;&#26032;&#23481;&#22120;&#65307;ioc&#23481;&#22120;&#21021;&#22987;&#21270;&#65288;&#22914;&#26524;&#26159;web&#24212;&#29992;&#36824;&#20250;&#21019;&#24314;&#23884;&#20837;&#24335;&#30340;Tomcat&#65289;&#65307;Spring&#27880;&#35299;&#29256;</span>
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25195;&#25551;&#65292;&#21019;&#24314;&#65292;&#21152;&#36733;&#25152;&#26377;&#32452;&#20214;&#30340;&#22320;&#26041;&#65307;&#65288;&#37197;&#32622;&#31867;&#65292;&#32452;&#20214;&#65292;&#33258;&#21160;&#37197;&#32622;&#65289;</span>
      refreshContext(context);
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;ioc&#23481;&#22120;&#20013;&#33719;&#21462;&#25152;&#26377;&#30340;ApplicationRunner&#21644;CommandLineRunner&#36827;&#34892;&#22238;&#35843;</span>
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">ApplicationRunner&#20808;&#22238;&#35843;&#65292;CommandLineRunner&#20877;&#22238;&#35843;</span>
      afterRefresh(context, applicationArguments);
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25152;&#26377;&#30340;SpringApplicationRunListener&#22238;&#35843;finished&#26041;&#27861;</span>
      listeners.finished(context, <span style="color: #a45bad;">null</span>);
      stopWatch.stop();
      <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.logStartupInfo) {
         <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StartupInfoLogger</span>(<span style="color: #4f97d7; font-weight: bold;">this</span>.mainApplicationClass)
               .logStarted(getApplicationLog(), stopWatch);
      }
       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25972;&#20010;SpringBoot&#24212;&#29992;&#21551;&#21160;&#23436;&#25104;&#20197;&#21518;&#36820;&#22238;&#21551;&#21160;&#30340;ioc&#23481;&#22120;&#65307;</span>
      <span style="color: #4f97d7; font-weight: bold;">return</span> context;
   }
   <span style="color: #4f97d7; font-weight: bold;">catch</span> (<span style="color: #ce537a; font-weight: bold;">Throwable</span> <span style="color: #7590db;">ex</span>) {
      handleRunFailure(context, listeners, analyzers, ex);
      <span style="color: #4f97d7; font-weight: bold;">throw</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">IllegalStateException</span>(ex);
   }
}
</pre>
</div>
</div>
</li>

<li><a id="事件监听机制"></a>3、事件监听机制<br />
<div class="outline-text-5" id="text-事件监听机制">
<p>
配置在META-INF/spring.factories
</p>

<p>
<b>ApplicationContextInitializer</b>
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloApplicationContextInitializer</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">ApplicationContextInitializer</span>&lt;<span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span>&gt; {
    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">initialize</span>(<span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #7590db;">applicationContext</span>) {
        System.out.println(<span style="color: #2d9574;">"ApplicationContextInitializer...initialize..."</span>+applicationContext);
    }
}
</pre>
</div>

<p>
<b>SpringApplicationRunListener</b>
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloSpringApplicationRunListener</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">SpringApplicationRunListener</span> {

    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#24517;&#39035;&#26377;&#30340;&#26500;&#36896;&#22120;</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> HelloSpringApplicationRunListener(<span style="color: #ce537a; font-weight: bold;">SpringApplication</span> <span style="color: #7590db;">application</span>, <span style="color: #ce537a; font-weight: bold;">String</span>[] <span style="color: #7590db;">args</span>){

    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">starting</span>() {
        System.out.println(<span style="color: #2d9574;">"SpringApplicationRunListener...starting..."</span>);
    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">environmentPrepared</span>(<span style="color: #ce537a; font-weight: bold;">ConfigurableEnvironment</span> <span style="color: #7590db;">environment</span>) {
        <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">o</span> = environment.getSystemProperties().get(<span style="color: #2d9574;">"os.name"</span>);
        System.out.println(<span style="color: #2d9574;">"SpringApplicationRunListener...environmentPrepared.."</span>+o);
    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">contextPrepared</span>(<span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #7590db;">context</span>) {
        System.out.println(<span style="color: #2d9574;">"SpringApplicationRunListener...contextPrepared..."</span>);
    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">contextLoaded</span>(<span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #7590db;">context</span>) {
        System.out.println(<span style="color: #2d9574;">"SpringApplicationRunListener...contextLoaded..."</span>);
    }

    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">finished</span>(<span style="color: #ce537a; font-weight: bold;">ConfigurableApplicationContext</span> <span style="color: #7590db;">context</span>, <span style="color: #ce537a; font-weight: bold;">Throwable</span> <span style="color: #7590db;">exception</span>) {
        System.out.println(<span style="color: #2d9574;">"SpringApplicationRunListener...finished..."</span>);
    }
}
</pre>
</div>

<p>
配置（META-INF/spring.factories）
</p>

<pre class="example">
org.springframework.context.ApplicationContextInitializer=\
com.atguigu.springboot.listener.HelloApplicationContextInitializer

org.springframework.boot.SpringApplicationRunListener=\
com.atguigu.springboot.listener.HelloSpringApplicationRunListener
</pre>

<p>
只需要放在ioc容器中
</p>

<p>
<b>ApplicationRunner</b>
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Component</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloApplicationRunner</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">ApplicationRunner</span> {
    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">run</span>(<span style="color: #ce537a; font-weight: bold;">ApplicationArguments</span> <span style="color: #7590db;">args</span>) <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> {
        System.out.println(<span style="color: #2d9574;">"ApplicationRunner...run...."</span>);
    }
}
</pre>
</div>

<p>
<b>CommandLineRunner</b>
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Component</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloCommandLineRunner</span> <span style="color: #4f97d7; font-weight: bold;">implements</span> <span style="color: #ce537a; font-weight: bold;">CommandLineRunner</span> {
    <span style="color: #a45bad;">@Override</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">run</span>(<span style="color: #ce537a; font-weight: bold;">String</span>... <span style="color: #7590db;">args</span>) <span style="color: #4f97d7; font-weight: bold;">throws</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> {
        System.out.println(<span style="color: #2d9574;">"CommandLineRunner...run..."</span>+ Arrays.asList(args));
    }
}
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-orga59934a" class="outline-4">
<h4 id="八自定义starter">八、自定义starter</h4>
<div class="outline-text-4" id="text-八自定义starter">
<p>
starter：
</p>

<p>
​ 1、这个场景需要使用到的依赖是什么？
</p>

<p>
​ 2、如何编写自动配置
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a45bad;">@Configuration</span>  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25351;&#23450;&#36825;&#20010;&#31867;&#26159;&#19968;&#20010;&#37197;&#32622;&#31867;</span>
<span style="color: #a45bad;">@ConditionalOnXXX</span>  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;&#25351;&#23450;&#26465;&#20214;&#25104;&#31435;&#30340;&#24773;&#20917;&#19979;&#33258;&#21160;&#37197;&#32622;&#31867;&#29983;&#25928;</span>
<span style="color: #a45bad;">@AutoConfigureAfter</span>  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#25351;&#23450;&#33258;&#21160;&#37197;&#32622;&#31867;&#30340;&#39034;&#24207;</span>
<span style="color: #a45bad;">@Bean</span>  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#32473;&#23481;&#22120;&#20013;&#28155;&#21152;&#32452;&#20214;</span>

<span style="color: #a45bad;">@ConfigurationPropertie</span>&#32467;&#21512;&#30456;&#20851;xxxProperties&#31867;&#26469;&#32465;&#23450;&#30456;&#20851;&#30340;&#37197;&#32622;
<span style="color: #a45bad;">@EnableConfigurationProperties</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#35753;xxxProperties&#29983;&#25928;&#21152;&#20837;&#21040;&#23481;&#22120;&#20013;</span>

<span style="color: #ce537a; font-weight: bold;">&#33258;&#21160;&#37197;&#32622;&#31867;&#35201;&#33021;&#21152;&#36733;</span>
<span style="color: #7590db;">&#23558;&#38656;&#35201;&#21551;&#21160;&#23601;&#21152;&#36733;&#30340;&#33258;&#21160;&#37197;&#32622;&#31867;</span>&#65292;&#37197;&#32622;&#22312;META-INF/spring.factories
<span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">boot</span>.<span style="color: #a45bad;">autoconfigure</span>.EnableAutoConfiguration=\
<span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">boot</span>.<span style="color: #a45bad;">autoconfigure</span>.<span style="color: #a45bad;">admin</span>.SpringApplicationAdminJmxAutoConfiguration,\
<span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">boot</span>.<span style="color: #a45bad;">autoconfigure</span>.<span style="color: #a45bad;">aop</span>.<span style="color: #7590db;">AopAutoConfiguration</span>,\
</pre>
</div>

<p>
​ 3、模式：
</p>

<p>
启动器只用来做依赖导入；
</p>

<p>
专门来写一个自动配置模块；
</p>

<p>
启动器依赖自动配置；别人只需要引入启动器（starter）
</p>

<p>
mybatis-spring-boot-starter；自定义启动器名-spring-boot-starter
</p>

<p>
步骤：
</p>

<p>
1）、启动器模块
</p>

<pre class="example">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.atguigu.starter&lt;/groupId&gt;
    &lt;artifactId&gt;atguigu-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;!--启动器--&gt;
    &lt;dependencies&gt;

        &lt;!--引入自动配置模块--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.starter&lt;/groupId&gt;
            &lt;artifactId&gt;atguigu-spring-boot-starter-autoconfigurer&lt;/artifactId&gt;
            &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;
</pre>

<p>
2）、自动配置模块
</p>

<pre class="example">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
   &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

   &lt;groupId&gt;com.atguigu.starter&lt;/groupId&gt;
   &lt;artifactId&gt;atguigu-spring-boot-starter-autoconfigurer&lt;/artifactId&gt;
   &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
   &lt;packaging&gt;jar&lt;/packaging&gt;

   &lt;name&gt;atguigu-spring-boot-starter-autoconfigurer&lt;/name&gt;
   &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;

   &lt;parent&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
      &lt;version&gt;1.5.10.RELEASE&lt;/version&gt;
      &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
   &lt;/parent&gt;

   &lt;properties&gt;
      &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
      &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
      &lt;java.version&gt;1.8&lt;/java.version&gt;
   &lt;/properties&gt;

   &lt;dependencies&gt;

      &lt;!--引入spring-boot-starter；所有starter的基本配置--&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
         &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
      &lt;/dependency&gt;

   &lt;/dependencies&gt;



&lt;/project&gt;
</pre>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">package</span> com.atguigu.<span style="color: #a45bad;">starter</span>;

<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">boot</span>.<span style="color: #a45bad;">context</span>.<span style="color: #a45bad;">properties</span>.<span style="color: #ce537a; font-weight: bold;">ConfigurationProperties</span>;

<span style="color: #a45bad;">@ConfigurationProperties</span>(prefix = <span style="color: #2d9574;">"atguigu.hello"</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloProperties</span> {

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">prefix</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">suffix</span>;

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #bc6ec5; font-weight: bold;">getPrefix</span>() {
        <span style="color: #4f97d7; font-weight: bold;">return</span> prefix;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">setPrefix</span>(<span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">prefix</span>) {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.prefix = prefix;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #bc6ec5; font-weight: bold;">getSuffix</span>() {
        <span style="color: #4f97d7; font-weight: bold;">return</span> suffix;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">setSuffix</span>(<span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">suffix</span>) {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.suffix = suffix;
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">package</span> com.atguigu.<span style="color: #a45bad;">starter</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloService</span> {

    <span style="color: #ce537a; font-weight: bold;">HelloProperties</span> <span style="color: #7590db;">helloProperties</span>;

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">HelloProperties</span> <span style="color: #bc6ec5; font-weight: bold;">getHelloProperties</span>() {
        <span style="color: #4f97d7; font-weight: bold;">return</span> helloProperties;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">setHelloProperties</span>(<span style="color: #ce537a; font-weight: bold;">HelloProperties</span> <span style="color: #7590db;">helloProperties</span>) {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.helloProperties = helloProperties;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #bc6ec5; font-weight: bold;">sayHellAtguigu</span>(<span style="color: #ce537a; font-weight: bold;">String</span> <span style="color: #7590db;">name</span>){
        <span style="color: #4f97d7; font-weight: bold;">return</span> helloProperties.getPrefix()+<span style="color: #2d9574;">"-"</span> +name + helloProperties.getSuffix();
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #4f97d7; font-weight: bold;">package</span> com.atguigu.<span style="color: #a45bad;">starter</span>;

<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">beans</span>.<span style="color: #a45bad;">factory</span>.<span style="color: #a45bad;">annotation</span>.<span style="color: #ce537a; font-weight: bold;">Autowired</span>;
<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">boot</span>.<span style="color: #a45bad;">autoconfigure</span>.<span style="color: #a45bad;">condition</span>.<span style="color: #ce537a; font-weight: bold;">ConditionalOnWebApplication</span>;
<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">boot</span>.<span style="color: #a45bad;">context</span>.<span style="color: #a45bad;">properties</span>.<span style="color: #ce537a; font-weight: bold;">EnableConfigurationProperties</span>;
<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">context</span>.<span style="color: #a45bad;">annotation</span>.<span style="color: #ce537a; font-weight: bold;">Bean</span>;
<span style="color: #4f97d7; font-weight: bold;">import</span> <span style="color: #a45bad;">org</span>.<span style="color: #a45bad;">springframework</span>.<span style="color: #a45bad;">context</span>.<span style="color: #a45bad;">annotation</span>.<span style="color: #ce537a; font-weight: bold;">Configuration</span>;

<span style="color: #a45bad;">@Configuration</span>
<span style="color: #a45bad;">@ConditionalOnWebApplication</span> <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">web&#24212;&#29992;&#25165;&#29983;&#25928;</span>
<span style="color: #a45bad;">@EnableConfigurationProperties</span>(HelloProperties.<span style="color: #4f97d7; font-weight: bold;">class</span>)
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">HelloServiceAutoConfiguration</span> {

    <span style="color: #a45bad;">@Autowired</span>
    <span style="color: #ce537a; font-weight: bold;">HelloProperties</span> <span style="color: #7590db;">helloProperties</span>;
    <span style="color: #a45bad;">@Bean</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">HelloService</span> <span style="color: #bc6ec5; font-weight: bold;">helloService</span>(){
        <span style="color: #ce537a; font-weight: bold;">HelloService</span> <span style="color: #7590db;">service</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HelloService</span>();
        service.setHelloProperties(helloProperties);
        <span style="color: #4f97d7; font-weight: bold;">return</span> service;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org181dc5f" class="outline-4">
<h4 id="更多springboot整合示例">更多SpringBoot整合示例</h4>
<div class="outline-text-4" id="text-更多springboot整合示例">
<p>
<a href="https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples">https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org9218e7c" class="outline-3">
<h3 id="org9218e7c">JDBC</h3>
<div class="outline-text-3" id="text-org9218e7c">
<ul class="org-ul">
<li>Driver</li>
<li>connection</li>
<li>mysql</li>
<li>execute</li>
<li>statement</li>
<li>preperedstatement</li>
<li>close</li>
</ul>
</div>
</div>

<div id="outline-container-org8680c66" class="outline-3">
<h3 id="org8680c66">mybatis</h3>
<div class="outline-text-3" id="text-org8680c66">
</div>
<div id="outline-container-org65c30eb" class="outline-4">
<h4 id="org65c30eb">framework</h4>
<div class="outline-text-4" id="text-org65c30eb">
</div>
<ul class="org-ul">
<li><a id="orgbcebede"></a>springboot<br />
<ul class="org-ul">
<li><a id="org654ee4a"></a>pom.xml<br />
<div class="outline-text-6" id="text-org654ee4a">
<p>
&lt;dependency&gt;
 &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
 &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
 &lt;version&gt;3.3.0&lt;/version&gt;
&lt;/dependency&gt;
</p>
</div>
</li>

<li><a id="org81ec720"></a>application.yml<br />
<div class="outline-text-6" id="text-org81ec720">
<p>
配置mybatis, 指示Mapper.xml的位置
mapper-locations: classpath:mapper/*/*Mapper.xml
</p>
</div>

<ul class="org-ul">
<li><a id="org80941e2"></a>Mybatias configuration(appeared.yml)<br />
<div class="outline-text-7" id="text-org80941e2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">prppreties</td>
</tr>

<tr>
<td class="org-left">settings</td>
</tr>

<tr>
<td class="org-left">typeAliases</td>
</tr>

<tr>
<td class="org-left">typeHanders</td>
</tr>

<tr>
<td class="org-left">plugins</td>
</tr>

<tr>
<td class="org-left">envirements</td>
</tr>

<tr>
<td class="org-left">mapper(url, resource, class, Annotation)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="orga9e7c88"></a>*Mapper.xml<br />
<div class="outline-text-7" id="text-orga9e7c88">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">query:</td>
<td class="org-left">resultMap/resultType</td>
</tr>

<tr>
<td class="org-left">insert, update, delete:</td>
<td class="org-left">parameterType</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</li>

<li><a id="org1e914d2"></a>Applicaton.java<br />
<div class="outline-text-6" id="text-org1e914d2">
<p>
启动类, 指示bean扫描的位置
@MapperScan(basePackages = {"com.sxt.system.mapper"})
</p>
</div>
</li>

<li><a id="orgadabbcf"></a>Route<br />
<div class="outline-text-6" id="text-orgadabbcf">
<p>
web requirement -&gt; controller -&gt; server -&gt; serverIpm  -&gt;
*Mapper.xml(self def)
自定义的在*Mapper.xml内找到数据库的入口，
默认的可以直接调用。
</p>
</div>
</li>
</ul>
</li>

<li><a id="org7fcd446"></a>spring<br /></li>
</ul>
</div>
<div id="outline-container-org4620e0b" class="outline-4">
<h4 id="org4620e0b">流程</h4>
<div class="outline-text-4" id="text-org4620e0b">
<ul class="org-ul">
<li>获取字节输入流</li>
<li>构建SqlSessioFactory</li>
<li>生产SqlSession</li>
<li>执行Dao</li>
<li>释放资源</li>
</ul>
</div>
</div>

<div id="outline-container-org569f6ce" class="outline-4">
<h4 id="org569f6ce">延迟加载</h4>
</div>
<div id="outline-container-orgbc204dc" class="outline-4">
<h4 id="orgbc204dc">缓存</h4>
</div>
<div id="outline-container-orgc828e69" class="outline-4">
<h4 id="orgc828e69">一级缓存</h4>
<div class="outline-text-4" id="text-orgc828e69">
<p>
SqlSession
</p>
</div>
</div>

<div id="outline-container-orge1e6972" class="outline-4">
<h4 id="orge1e6972">二级缓存</h4>
<div class="outline-text-4" id="text-orge1e6972">
<p>
SqlSessionFactory
</p>
</div>
</div>

<div id="outline-container-orgeff2912" class="outline-4">
<h4 id="orgeff2912">注解开发</h4>
</div>
</div>
<div id="outline-container-org72da14f" class="outline-3">
<h3 id="org72da14f">Shiro</h3>
</div>
<div id="outline-container-org66f9e68" class="outline-3">
<h3 id="org66f9e68">c3p0</h3>
</div>
<div id="outline-container-orgcc9004d" class="outline-3">
<h3 id="orgcc9004d">Rruid</h3>
</div>
</div>
<div id="outline-container-org2f361bc" class="outline-2">
<h2 id="org2f361bc">deployment</h2>
<div class="outline-text-2" id="text-org2f361bc">
</div>
<div id="outline-container-org516fa99" class="outline-3">
<h3 id="org516fa99">nginx</h3>
<div class="outline-text-3" id="text-org516fa99">
</div>
<div id="outline-container-orge460237" class="outline-4">
<h4 id="orge460237">local Nginx deployment</h4>
<div class="outline-text-4" id="text-orge460237">
</div>
<ul class="org-ul">
<li><a id="org53401bf"></a>install<br />
<div class="outline-text-5" id="text-org53401bf">
<pre class="example">
yum install -y pcre pcre-devel
yum install -y zlib zlib-devel
yum install -y openssl openssl-devel


tar
mv xxx nginx
mv nginx /usr/local/src/
cd /usr/local/src/nginx
mkdir /usr/nginx
./configure --prefix=/usr/nginx
make
make install

</pre>

<p>
sudo apt install nginx
</p>

<p>
<i>etc/nginx</i> 是其配置文件夹，里面有很多include文件，
nginx 的默认设置在其中一个 default 文件里。
本机html仓库 /var/www/html
将项目放在此文件夹下，运行对于的端口即可
本机开机后,该文件的会被自动部署,端口可见
</p>
</div>
</li>

<li><a id="org99e559b"></a>fire wall 80 port if necessary<br />
<div class="outline-text-5" id="text-org99e559b">
<pre class="example">
add port :
sudo apt install firewalld
sudo firewall-cmd --add-port=80/tcp --permanent
sudo firewall-cmd --remove-port=80/tcp --permanent
restart firewall:
sudo  firewall-cmd --reload
check port:
sudo  firewall-cmd --list-all
</pre>
</div>
</li>

<li><a id="org053db52"></a>nginx control<br />
<div class="outline-text-5" id="text-org053db52">
<pre class="example">
sudo apt systemctl stop nginx
nginx -s stop
sudo apt systemctl start nginx
nginx -s reload
</pre>
</div>
</li>

<li><a id="org08ee937"></a>uninstall<br />
<div class="outline-text-5" id="text-org08ee937">
<p>
sudo apt-get purge nginx nginx-common
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org6b85efa" class="outline-4">
<h4 id="org6b85efa">Nginx with php</h4>
<div class="outline-text-4" id="text-org6b85efa">
<p>
sudo apt install nginx
sudo systemctl restart nginx
sudo apt install php
sudo apt install php-fpm
check if exit: /var/run/php/php7.2-fpm.sock
</p>

<p>
emacs /etc/php/7.2/fpm/pool.d/www.conf  -&gt; listen = /run/php/php7.2-fpm.sock
</p>

<p>
cd /etc/nginx/sites-available
  emacs default 
</p>

<pre class="example">
list  post
root  folder
location ~ \.php${
	 include snippets/fastcgi-php.conf;
	 fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;
	 include fastcgi_params;
}


</pre>

<p>
vollstandig
</p>
<pre class="example">
################### 9020 FOR php ##################################################################################
server {
	listen 9020;
	listen [::]:9020;

	# SSL configuration
	#
	# listen 443 ssl default_server;
	# listen [::]:443 ssl default_server;
	#
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;

	root /home/sx/Documents/nginx9020;

	# Add index.php to the list if you are using PHP
	index index.html index.htm index.nginx-debian.html index.php;

	server_name _;

	location / {
		# First attempt to serve request as file, then
		# as directory, then fall back to displaying a 404.
		try_files $uri $uri/ =404;
	}

	# pass PHP scripts to FastCGI server
	#
	location ~ \.php$ {
		include snippets/fastcgi-php.conf;

		# With php-fpm (or other unix sockets):
		fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;
		# With php-cgi (or other tcp sockets):
		include fastcgi_params;
		#fastcgi_pass 127.0.0.1:9000;
	}

	# deny access to .htaccess files, if Apache's document root
	# concurs with nginx's one
	#
	#location ~ /\.ht {
	#	deny all;
	#}
}



</pre>
</div>
</div>
</div>

<div id="outline-container-orga2a588f" class="outline-3">
<h3 id="orga2a588f">Docker envirement deployment</h3>
<div class="outline-text-3" id="text-orga2a588f">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">comands</th>
<th scope="col" class="org-left">expains</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">docker images</td>
<td class="org-left">查看容器</td>
</tr>

<tr>
<td class="org-left">docker pull nginx  <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup></td>
<td class="org-left">新增</td>
</tr>

<tr>
<td class="org-left">docker run -d -p 80:80 nginx <sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup></td>
<td class="org-left">开始，id， 后台</td>
</tr>

<tr>
<td class="org-left">docker exec -it xxxxxx bash</td>
<td class="org-left">前台进入，</td>
</tr>

<tr>
<td class="org-left">docker commit xxxxxx newname</td>
<td class="org-left">生成新容器</td>
</tr>

<tr>
<td class="org-left">docker kill -s KILL xxxxxx</td>
<td class="org-left">关闭</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org78421a0" class="outline-3">
<h3 id="org78421a0">apache2</h3>
<div class="outline-text-3" id="text-org78421a0">
<p>
sudo apt install apache2
sudo systemctl restart apache2
cd <i>etc/apache2</i> 
</p>
<ol class="org-ol">
<li>ports.conf -&gt; add new post</li>
<li>appache.conf -&gt;  add new folder</li>
<li>cd sites-available emacs 000-default.conf -&gt; add server of post and folder</li>
</ol>
</div>
</div>

<div id="outline-container-orgd52bea0" class="outline-3">
<h3 id="orgd52bea0">Maven</h3>
<div class="outline-text-3" id="text-orgd52bea0">
</div>
<div id="outline-container-orgcf85361" class="outline-4">
<h4 id="orgcf85361">package all the dependencies together as a jar</h4>
<div class="outline-text-4" id="text-orgcf85361">
<p>
if I want to package them to a package to a jar
<a href="https://stackoverflow.com/questions/574594/how-can-i-create-an-executable-jar-with-dependencies-using-maven">starkoverflow hitting</a>
and this plugin to pom.xml
</p>
<pre class="example">
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
	&lt;archive&gt;
	  &lt;manifest&gt;
	    &lt;mainClass&gt;fully.qualified.MainClass&lt;/mainClass&gt;
	  &lt;/manifest&gt;
	&lt;/archive&gt;
	&lt;descriptorRefs&gt;
	  &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;
	&lt;/descriptorRefs&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
</pre>

<p>
package and Execute 
</p>
<ul class="org-ul">
<li>run with : mvn clean compile assembly:single</li>
<li>mvn package</li>
</ul>
<p>
and now this jar file can be called
</p>
<ul class="org-ul">
<li>java -cp target/xxxx&#x2026;.xx.jar com.mycompany.app.App</li>
</ul>
</div>
</div>

<div id="outline-container-orgcd20b0d" class="outline-4">
<h4 id="orgcd20b0d">customize locally archetype</h4>
<div class="outline-text-4" id="text-orgcd20b0d">
<p>
to the local repository
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #4f97d7;">cd</span> ~/.m2/repository/org/apache/maven/archetypes/maven-archetype-quickstart/1.4/
</pre>
</div>
<p>
open the jar file, and change the pom.xml
</p>
</div>
</div>
</div>

<div id="outline-container-orgff4da32" class="outline-3">
<h3 id="orgff4da32">Session und Cookie</h3>
<div class="outline-text-3" id="text-orgff4da32">
<ol class="org-ol">
<li>Browser send request to server with name, password&#x2026;</li>
<li>if the authentication is passed, server generate a SessionID,</li>
</ol>
<p>
and search the results, giving back browser response(name, password,
results Sessionid..) Sessionid will be saved in SERVER.
</p>
<ol class="org-ol">
<li>get the response, browser save the name, password and Sessionid as</li>
</ol>
<p>
Cookie.
</p>
<ol class="org-ol">
<li>send request again, browser get the name, password, and Sessionid
from Cookie, and send the requests</li>
<li>server check the Sessionid only if possible, and send the results
and name, password again as response back to browser.</li>
</ol>

<p>
Only the first time response, Sessionid will be send back to browser.
</p>
</div>
</div>

<div id="outline-container-org65aeb52" class="outline-3">
<h3 id="org65aeb52">HTTP Proposal</h3>
<div class="outline-text-3" id="text-org65aeb52">
</div>
<div id="outline-container-orge9910fe" class="outline-4">
<h4 id="orge9910fe">http Request</h4>
<div class="outline-text-4" id="text-orge9910fe">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Request Line</td>
<td class="org-left">request type + url path(many kinds of paramenters)+ http version</td>
</tr>

<tr>
<td class="org-left">Header:</td>
<td class="org-left">Host; Cookie; Content-type; User-Agent&#x2026;</td>
</tr>

<tr>
<td class="org-left">Request Body:</td>
<td class="org-left">username="admin"&amp;password="admin"</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org0277da8" class="outline-4">
<h4 id="org0277da8">Http Response</h4>
<div class="outline-text-4" id="text-org0277da8">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">esponse Line:</td>
<td class="org-left">http version + state code + state string</td>
</tr>

<tr>
<td class="org-left">Header:</td>
<td class="org-left">Content-type (describe information)</td>
</tr>

<tr>
<td class="org-left">Response Body:</td>
<td class="org-left">&lt;html&gt; &#x2026;.&lt;/tml&gt;</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org696ff49" class="outline-3">
<h3 id="org696ff49">appeared Problem</h3>
<div class="outline-text-3" id="text-org696ff49">
</div>
<div id="outline-container-org4596522" class="outline-4">
<h4 id="org4596522">server is not startup</h4>
<div class="outline-text-4" id="text-org4596522">
<p>
1, workspace 有重叠和包含，
2, 需要重启 lsp mode
</p>
</div>
</div>

<div id="outline-container-orga0897da" class="outline-4">
<h4 id="orga0897da">can't find the main class to start project</h4>
<div class="outline-text-4" id="text-orga0897da">
<p>
mvn compile 出现问题，大多数时候是依赖的问题
</p>
</div>
</div>

<div id="outline-container-org35fb6d7" class="outline-4">
<h4 id="org35fb6d7">没有对应的补全</h4>
<div class="outline-text-4" id="text-org35fb6d7">
<p>
mvn 依赖的version 不同会有不同的包，补全也不同
</p>
</div>
</div>
</div>

<div id="outline-container-orgf3600f3" class="outline-3">
<h3 id="orgf3600f3">local jdk configuration</h3>
<div class="outline-text-3" id="text-orgf3600f3">
<pre class="example">
mkdir /usr/local/java
tar -zxvf jdkxxxxx.tar.gz -C /usr/localjava
sudo emacs -nw -q /etc/profile
-&gt;
JAVA_HOME=/usr/local/java/jdkxxxxx
PATH=$JAVA_HOME/bin:$PATH
CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export JAVA_HOME
export PATH
export CLASSPATH

source /etc/profile
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdac195b" class="outline-2">
<h2 id="orgdac195b">RuoYi-Vue project</h2>
<div class="outline-text-2" id="text-orgdac195b">
</div>
<div id="outline-container-org5e0a2a2" class="outline-3">
<h3 id="org5e0a2a2">backup deployment</h3>
<div class="outline-text-3" id="text-org5e0a2a2">
</div>
<div id="outline-container-orgcdd491c" class="outline-4">
<h4 id="orgcdd491c">redis</h4>
<div class="outline-text-4" id="text-orgcdd491c">
<pre class="example">

sudo apt install redis-server
sudo snap install redis-desktop-manager

sem /etc/redis/redis.conf
bind 127.0.0.1
requirepass 123456

sudo systemctl restart redis-server
or
sudo service redis-server restart

</pre>
</div>
</div>

<div id="outline-container-org06db92d" class="outline-4">
<h4 id="org06db92d">mysql</h4>
</div>
<div id="outline-container-org0a73b47" class="outline-4">
<h4 id="org0a73b47">tomcat</h4>
<div class="outline-text-4" id="text-org0a73b47">
<p>
configuration for IDEA as local Tomcat
</p>
</div>
</div>

<div id="outline-container-orgf7d994d" class="outline-4">
<h4 id="orgf7d994d">schnitt</h4>
<div class="outline-text-4" id="text-orgf7d994d">
<p>
redis
mysql 
uploadPath
system log.path
check localhost:8080
</p>
</div>
</div>

<div id="outline-container-org0efc363" class="outline-4">
<h4 id="org0efc363">ssh</h4>
<div class="outline-text-4" id="text-org0efc363">
<p>
set to be false
</p>
</div>
</div>

<div id="outline-container-orgc801db7" class="outline-4">
<h4 id="orgc801db7">dependence from jdk8</h4>
<div class="outline-text-4" id="text-orgc801db7">
<pre class="example">
    &lt;dependency&gt;
    &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
    &lt;version&gt;2.3.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;
    &lt;version&gt;2.3.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt;
    &lt;version&gt;2.3.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;javax.activation&lt;/groupId&gt;
    &lt;artifactId&gt;activation&lt;/artifactId&gt;
    &lt;version&gt;1.1.1&lt;/version&gt;
&lt;/dependency&gt;

</pre>
</div>
</div>
</div>

<div id="outline-container-org5306003" class="outline-3">
<h3 id="org5306003">frontend deployment</h3>
<div class="outline-text-3" id="text-org5306003">
</div>
<div id="outline-container-orgbd76db3" class="outline-4">
<h4 id="orgbd76db3">build</h4>
<div class="outline-text-4" id="text-orgbd76db3">
<pre class="example">
cd ruoyi-ui
npm run build:prod
npm run build:stage
cp -r dist/* ~/Documens/nginx9010/
</pre>
</div>
</div>

<div id="outline-container-org604019c" class="outline-4">
<h4 id="org604019c">验证码 for nginx</h4>
<div class="outline-text-4" id="text-org604019c">
<pre class="example">
#####################9010 NOT for php ############################################################################


server {
	listen 9010;
	listen [::]:9010;

	# SSL configuration
	#
	# listen 443 ssl default_server;
	# listen [::]:443 ssl default_server;
	#
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;



	# Add index.php to the list if you are using PHP


	server_name _;

	location / {
		# First attempt to serve request as file, then
		# as directory, then fall back to displaying a 404.
		root /home/sx/Documents/nginx9010;
		index index.html index.htm index.nginx-debian.html index.php;
		try_files $uri $uri/ =404;
	}

	# deny access to .htaccess files, if Apache's document root
	# concurs with nginx's one
	#
	#location ~ /\.ht {
	#	deny all;
	#}

	location /prod-api/{
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header REMOTE-HOST $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_pass http://localhost:8080/;
		}

	error_page   500 502 503 504  /50x.html;

	location = /50x.html {
	    root   html;
	}

}

</pre>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
对于新到手的项目可以直接放到容器的nginx根目录（快速部署 /usr/share/nginx/html），可以在映射的
本机端口进入
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
to my case:
</p>
<pre class="example">
sudo docker run -d -p 80:80 -v /home/sx/Documents/Java/ANANProject/layuimini/:/usr/share/nginx/html/ nginx
</pre>

<p class="footpara">
Beispile
</p>
<pre class="example">

sudo docker images
sudo docker pull nginx
sudo docker run -d -p 80:80 nginx -&gt; id:xxxxxxx
sudo docker exec -it -v /....../project:/usr/share/nginx/html xxxxxxx
build in - &gt; local host :80  
</pre></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: silin</p>
<p class="date">Created: 2021-02-12 Fr 22:52</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
